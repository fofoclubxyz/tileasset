window.__require=function e(t,a,i){function n(c,r){if(!a[c]){if(!t[c]){var s=c.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!r&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var d=a[c]={exports:{}};t[c][0].call(d.exports,function(e){return n(t[c][1][e]||e)},d,d.exports,e,t,a,i)}return a[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({BundleMager:[function(e,t,a){"use strict";var i,n,o,c,r,s,l;cc._RF.push(t,"22d58/roU9NFZicmF0l3UQC","BundleMager"),i=__extends,l=__awaiter,r=__generator,Object.defineProperty(a,"__esModule",{value:!0}),s=e("Res"),n=e("SingleBase"),c=e("Sound"),o=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).autoReleaseNames=[],t.sound_id_arr=[],t.play_audio_id=0,t},e),t.prototype.preLoadBundle=function(e){for(var t in s.bundlesName)this.loadBundle(s.bundlesName[t],e)},t.prototype.find_bundle=function(e){return cc.assetManager.getBundle(e)},t.prototype.loadBundle=function(e,t,a){var i,n;i=this,void 0===a&&(a=!1),cc.assetManager.loadBundle(e,function(e,t,a,n){return l(i,void 0,void 0,function(){return r(this,function(){return console.log("---------------text:",e),console.log("---------------value:",t),console.log("---------------defaultSelected:",a),console.log("---------------selected:",n),[2]})})},function(a,i){a?console.error("load bundle failed:",e,a):t&&t(i)}),a&&(this.autoReleaseNames.push(e),this.autoReleaseNames.length>2)&&(n=this.autoReleaseNames.shift(),this.removeBundle(n))},t.prototype.get_bundle_sound=function(e,t,a,i){var n;return n=this,void 0===a&&(a=!1),new Promise(function(o){var r;(r=cc.assetManager.getBundle(e))?r.load("sound/"+t,cc.AudioClip,function(e,r){if(r){if(o(r),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(r,a),n.sound_id_arr.push({id:n.play_audio_id,ac:r}),0==a&&setTimeout(function(){n.stop_sound(r)},1e3*r.duration)}else cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(e,t){if(e)i&&i();else{if(o(t),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(t,a),n.sound_id_arr.push({id:n.play_audio_id,ac:t}),0==a&&setTimeout(function(){n.stop_sound(t)},1e3*t.duration)}})}):cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(r,s){if(r)console.error("load bundle failed",e,",",t),i&&i();else{if(o(s),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(s,a),n.sound_id_arr.push({id:n.play_audio_id,ac:s}),0==a&&setTimeout(function(){n.stop_sound(s)},1e3*s.duration)}})})},t.prototype.stop_sound=function(e){for(var t=0;t<this.sound_id_arr.length;t++)this.sound_id_arr[t].ac==e&&(cc.audioEngine.stop(this.sound_id_arr[t].id),this.sound_id_arr.splice(t,1),t--)},t.prototype.get_bundle_bgm=function(e,t,a){var i;return i=this,void 0===a&&(a=!0),new Promise(function(n){var o;(o=cc.assetManager.getBundle(e))?o.load("sound/"+t,cc.AudioClip,function(o,r){if(r){if(n(r),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(r,a)}else cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(o,r){if(o)console.error("load bundle failed",e,",",t);else{if(n(r),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(r,a)}})}):cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(o,r){if(o)console.error("load bundle failed",e,",",t);else{if(n(r),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(r,a)}})})},t.prototype.get_bundle_texture=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("texture/"+t,cc.SpriteFrame,function(i,n){n?a(n):cc.assetManager.getBundle("common").load("texture/"+t,cc.SpriteFrame,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})}):cc.assetManager.getBundle("common").load("texture/"+t,cc.SpriteFrame,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})})},t.prototype.get_bundle_SkeletonData=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("texture/"+t,sp.SkeletonData,function(i,n){n?a(n):cc.assetManager.getBundle("common").load("texture/"+t,sp.SkeletonData,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})}):cc.assetManager.getBundle("common").load("texture/"+t,sp.SkeletonData,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})})},t.prototype.get_bundle_prefab=function(e,t){return l(this,void 0,Promise,function(){return r(this,function(){return[2,new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load(t,cc.Prefab,function(e,i){i?a(i):cc.assetManager.getBundle("common").load("prefab/"+t,cc.Prefab,function(e,t){a(e?null:t)})}):cc.assetManager.getBundle("common").load("prefab/"+t,cc.Prefab,function(e,t){a(e?null:t)})})]})})},t.prototype.getDataJson=function(e,t){return new Promise(function(a){cc.assetManager.getBundle(e).load(t,cc.JsonAsset,function(i,n){n?a(n):console.error("load bundle failed",e,",",t)})})},t.prototype.getCsvData=function(e){return new Promise(function(t){var a;(a=cc.assetManager.getBundle("jsonData"))?a.load(e,cc.TextAsset,function(a,i){var n;i?(n=i.text,t(n)):console.error("load bundle failed","jsonData",",",e)}):console.log("csv load failed",e)})},t.prototype.getSkeleton=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("spine/"+t,sp.SkeletonData,function(e,i){e?console.error(t+" not exist"):a(i)}):console.log("not found bundle:",t)})},t.prototype.removeBundleAsset=function(e,t,a){var i;(i=cc.assetManager.getBundle(e))?i.release(t,a):console.warn("removeBundleAsset bundle:"+e+",not exist")},t.prototype.removeBundle=function(e){var t;(t=cc.assetManager.getBundle(e))?(t.releaseAll(),cc.assetManager.removeBundle(t)):console.warn("removeBundleAsset bundle:"+e+",not exist")},t}(n.default),a.default=o,cc._RF.pop()},{Res:"Res",SingleBase:"SingleBase",Sound:"Sound"}],ClientEvent:[function(e,t,a){"use strict";var i,n,o,c;cc._RF.push(t,"947aesipJ9J0LZ1JbGOTdpk","ClientEvent"),i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),a.Event_Key=a._EventTargetMager=void 0,o=cc._decorator,n=o.ccclass,o.property,c=function(){var e;return e=function(){},Object.defineProperty(e,"Instace",{get:function(){return this._instace||(this._instace=new cc.EventTarget),this._instace},enumerable:!1,configurable:!0}),i([n],e)}(),a._EventTargetMager=c.Instace,(a.Event_Key||(a.Event_Key={})).StartGame="start_game",cc._RF.pop()},{}],Config:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_;cc._RF.push(t,"a32bcSEGOlCjr0F3XpzdyJJ","Config"),Object.defineProperty(a,"__esModule",{value:!0}),a.cRes=a.cPublicMager=a.cBunbleMager=a.pfApi=a.cNodePool=a.cEvent=a.cUI=a.cStorage=a.cSound=void 0,c=e("LocalStorage"),n=e("PlatformApi"),l=e("Pool"),_=e("UI"),o=e("Sound"),s=e("Res"),d=e("BundleMager"),r=e("ClientEvent"),i=e("PublicMager"),a.cSound=o.default.get(),a.cStorage=c.default.get(),a.cUI=_.default.get(),a.cEvent=r._EventTargetMager,a.cNodePool=l.default.get(),a.pfApi=n.default.get(),a.cBunbleMager=d.default.get(),a.cPublicMager=i.default.get(),a.cRes={Sound:s.Sound,Prefab:s.Prefab,Texture:s.Texture,Atlas:s.Atlas,bundlesName:s.bundlesName},cc._RF.pop()},{BundleMager:"BundleMager",ClientEvent:"ClientEvent",LocalStorage:"LocalStorage",PlatformApi:"PlatformApi",Pool:"Pool",PublicMager:"PublicMager",Res:"Res",Sound:"Sound",UI:"UI"}],GameScene:[function(e,t,a){"use strict";cc._RF.push(t,"3e019bOEe5B4p/EsNVnuqpO","GameScene");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0}),a.gameScene=void 0;var o=e("Config"),c=e("PlayerDataConfig"),r=e("PlayerDataMager"),s=e("ViewSet"),l=e("block_item"),d=e("line"),_=e("star"),u=e("bing_bao"),p=e("level"),h=e("item_icon"),f=e("combo_item"),g=cc._decorator,v=g.ccclass,m=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameUI=void 0,t.is_pause=!1,t.bg=void 0,t.bg_skeleton=void 0,t.block_parent=void 0,t.block_prefab=void 0,t.hp_parent=null,t.line_parent=null,t.line_prefab=void 0,t.item_parent=null,t.level_label=null,t.hard_node=null,t.refresh_label=null,t.tip_btn=null,t.delect_prefab=void 0,t.lianji_node=null,t.lianji_label=null,t.lianji_progress=null,t.lianji_effect=null,t.lianji_word=null,t.new_player_prefab=null,t.progress_node=null,t.progress_bar=null,t.tip_ui=null,t.tip_img=void 0,t.tip_btn_fly=void 0,t.tip_word=void 0,t.tip_bg=null,t.tip_skeleton=void 0,t.refresh_btn=null,t.star_pre=null,t.gift_box=null,t.bubble_label=null,t.zui_niu_json=void 0,t.level_json=null,t.map_json=null,t.bing_bao=void 0,t.move_json=null,t.guidao=null,t.setting_btn=null,t.feidan_prefab=null,t.baozha=null,t.item_icon_prefab=null,t.tip_number=0,t.move_time=.51,t.data=[],t.select_block=null,t.hp=3,t.is_over=!1,t.ad_num=0,t.relive_num=3,t.lianji_num=0,t.lianji_time=11,t.zidong_tip_num=3,t.new_player_data=[],t.new_player_node=null,t.new_player_type=-1,t.jishi_time=0,t.level_data=null,t.map_data=[],t.out_id=[],t.xiao_window=!1,t.shipei_scale=1,t.xun_huan_block_arr=[],t.xunhuan_move=!1,t.zhiwan=!1,t.win_bool=!1,t.move_data=[],t.moving=!1,t.ad_star=0,t.level_script=null,t.delect_effect=null,t.delect_music=null,t.bgm=null,t.fly_item=null,t.touch_effect=null,t.move_end_effect=null,t.new_block_effect=null,t.new_block_end_effect=null,t.touch_effectt=null,t.fanpai_effect=null,t.jianting_=null,t.zhiwan_daojishi=20149,t.zhiwan_in=!1,t.xunhuan_=[11,70],t.xunhuan_zuiniu=[0,34],t.last_dian=null,t.onen_touch_fun_=null,t.dian=!1,t.xiaochu_cishu=0,t.un_move_arr=[],t.move_block_data=[],t.zhiwan_bool=!1,t.moving_block=[],t.now_finish_level=0,t.tip_block=[],t.tip_bool=!0,t.zidong_tip_block=[],t.item_y=0,t.zidong=!1,t}return i(t,e),t.prototype.onLoad=function(){a.gameScene=this},t.prototype.initScene=function(){},t.prototype.update=function(){},t.prototype.onDestroy=function(){o.cUI.removeAllLayer()},t.prototype.pauseGame=function(){this.is_pause=!0,o.cSound.stopMusic(),this.node.pauseAllActions()},t.prototype.resumeGame=function(){this.is_pause=!1,o.cSound.resumeMusic(),this.node.resumeAllActions()},t.prototype.gameResult=function(){this.is_pause=!0,this.unscheduleAllCallbacks()},t.prototype.onBtnSetting=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cUI.addLayer(o.cRes.Prefab.setting)},t.prototype.onBtnTheme=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cUI.addLayer(o.cRes.Prefab.skin_ui)},t.prototype.returnMainScene=function(){o.cUI.addScene(o.cRes.Prefab.main_scene).then(function(){o.cUI.removeAllLayer()})},t.prototype.start=function(){this.init(),this.setting_btn.zIndex=2,this.tip_ui.zIndex=2},t.prototype.init=function(){var e=this;if(this.new_player_node&&(this.new_player_node.destroy(),this.new_player_node=null),o.cSound.stopMusic(),this.select_block=null,this.level_data=null,this.map_data=null,this.win_bool=!1,this.xun_huan_block_arr=[],this.hp=3,this.show_hp(),this.show_item_fun(),this.is_over=!1,this.ad_num=-1,this.relive_num=3,this.xiaochu_cishu=0,this.un_move_arr=[],this.move_data=[],this.tip_number=0,this.level_label.string="Level"+(r._p_data._data.level+1),1==o.cPublicMager.is_zui_niu){var t=new Date;this.level_label.string=t.getMonth()+1+"-"+t.getDate()}if(this.show_shuaxin_num(),cc.Tween.stopAllByTarget(this.lianji_node),this.lianji_node.x=448.5,this.lianji_num=0,this.lianji_node.active=!1,o.cPublicMager.first_unlock_zuiniu=!1,this.line_parent.destroyAllChildren(),this.moving=!1,this.level_script=null,o.cPublicMager.config.ad_star&&(this.ad_star=o.cPublicMager.config.ad_star),this.init_level_script(),this.new_data(),this.new_block(),this.show_bg(),this.unschedule(this.jishi_fun),this.jishi_start(),this.zidong_tip_num=3,0==r._p_data._data.level&&(this.zidong_tip_num=25),this.zidong_tip(),this.hide_qipao(),cc.sys.isBrowser){var a=this.item_parent.getComponent(cc.Widget);a.bottom=20,a.updateAlignment()}1==o.cPublicMager.zidong&&(t=4,this.level_data.moveType>0&&(t=6),this.scheduleOnce(function(){e.zidong_game()},t)),this.move_block_data=[];for(var i=0;i<this.data.length;i++)for(var n=0;n<this.data[i].length;n++)this.move_block_data[this.data[i][n].tag]=[];if(this.tip_btn.active=!1,0!=this.level_data.moveType&&-1!=this.level_data.moveType){var c=this.tip_btn.getChildByName("icon").getComponent(cc.Sprite);o.cUI.getTexture("texture/dir/"+this.level_data.moveType).then(function(e){c.spriteFrame=e})}this.show_jindu(),this.jixing()},t.prototype.init_level_script=function(){this.delect_effect=this.delect_prefab,this.delect_music="effect/cleanup",this.bgm="effect/gamebgm",this.fly_item=this.star_pre,this.touch_effect="effect/click_block",this.move_end_effect="effect/move_end",this.new_block_effect="effect/block_create",this.new_block_end_effect="effect/block_create_end",this.fanpai_effect="effect/flip",this.touch_effectt=this.lianji_effect,this.load_level_script()},t.prototype.load_level_script=function(){for(var e=this.node.getComponents(p.default),t=0;t<e.length;t++)e[t].destroy()},t.prototype.jianting=function(){this.jixing();var e=cc.view.getCanvasSize();e.width>e.height?this.level_label.node.parent.scale=.4:this.level_label.node.parent.scale=1},t.prototype.jixing=function(){var e=cc.view.getCanvasSize(),t=e.height/e.width;t<1.9333333333333333?(this.block_parent.y=30,this.shipei_scale=t/1.9933333333333334,this.xiao_window=!0,this.item_parent.getComponent(cc.Widget).bottom=20,this.item_parent.getComponent(cc.Widget).updateAlignment()):this.shipei_scale=1,this.block_parent.scale=this.shipei_scale,this.item_parent.scale=this.shipei_scale},t.prototype.show_jindu=function(){var e=this.return_jindu(),t=e.number,a=e.max,i=(t/a*100).toFixed();this.progress_node.string=i+"%",this.progress_bar.progress=t/a},t.prototype.return_jindu=function(){for(var e=0,t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)(this.data[t][a].id>=0||-3==this.data[t][a].id)&&e++;var i=0;for(t=0;t<this.map_data.length;t++)for(a=0;a<this.map_data[t].length;a++)(this.map_data[t][a]>=0||-3==this.map_data[t][a])&&i++;return{number:e=i-e,max:i}},t.prototype.jishi_start=function(){this.jishi_time=0,this.schedule(this.jishi_fun,1)},t.prototype.jishi_fun=function(){this.jishi_time++},t.prototype.show_bg=function(){var e=this;o.cBunbleMager.get_bundle_texture("level_"+r._p_data._data.theme,"bg"+r._p_data._data.theme).then(function(t){e.bg.spriteFrame=t}),o.cBunbleMager.get_bundle_SkeletonData("level_"+r._p_data._data.theme,"bg"+r._p_data._data.theme+"/bg"+r._p_data._data.theme).then(function(t){e.bg_skeleton.skeletonData=t,e.bg_skeleton.setAnimation(0,"idle",!0)});var t=cc.winSize.height/1700;this.bg.node.scale=t},t.prototype.switchSkin=function(){this.show_bg();for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)this.data[e][t].id>=0&&this.data[e][t].block_node.getComponent(l.default).switchSkin()},t.prototype.onDisable=function(){r._p_data.close()},t.prototype.show_hp=function(){for(var e=this.hp_parent.children,t=0;t<e.length;t++)e[t].active=t<this.hp;this.hp<=0&&this.gameOver()},t.prototype.show_qipao=function(){var e=this,t=Math.floor(3*Math.random()),a=this.bubble_label.node.parent;switch(this.find_can_line()||(t=1),t){case 0:this.bubble_label.string="Check the Hint";break;case 1:this.bubble_label.string="Try Refreshing";break;case 2:this.bubble_label.string="Random Clear"}a.scale=0,a.active=!0;var i=this.item_parent.children[t].convertToWorldSpaceAR(cc.v2(0,0)),n=a.parent.convertToNodeSpaceAR(i);a.setPosition(n),a.y+=55;var o=1;a.x>0?(o=-1,this.bubble_label.node.scaleX=-1):this.bubble_label.node.scaleX=1,cc.Tween.stopAllByTarget(a),cc.tween(a).to(.3,{scaleX:o,scaleY:1},{easing:"backOut"}).call(function(){cc.tween(a).to(1,{scaleX:1.1*o,scaleY:1.1}).to(1,{scaleX:o,scaleY:1}).union().repeatForever().start()}).start(),1==this.xiao_window&&this.scheduleOnce(function(){e.hide_qipao()},3)},t.prototype.hide_qipao=function(){this.unschedule(this.show_qipao);var e=this.bubble_label.node.parent;cc.Tween.stopAllByTarget(e),e.active=!1},t.prototype.new_data=function(){var e;if(e=o.cPublicMager.level_data?JSON.parse(JSON.stringify(o.cPublicMager.level_data)):JSON.parse(JSON.stringify(this.level_json.json)),this.level_data=e["level_"+(r._p_data._data.level+1)],1==o.cPublicMager.is_zui_niu){if(this.level_data=this.zui_niu_json.json["level_"+(r._p_data._data.zui_niu_level+1)],!this.level_data){var t=(r._p_data._data.zui_niu_level-Object.keys(this.zui_niu_json.json).length)%(this.xunhuan_zuiniu[1]-this.xunhuan_zuiniu[0])+this.xunhuan_zuiniu[0]+1;this.level_data=this.zui_niu_json.json["level_"+t]}}else{if(!this.level_data){for(var a={},i=0,n=this.xunhuan_[0];n<=Object.keys(e).length;n++)a["level_"+n]=e["level_"+n],i++;var s=r._p_data._data.level+1-Object.keys(e).length;console.log("max level",s,",",i,r._p_data._data.level),t=s%i+this.xunhuan_[0],console.log("cur level",t),this.level_data=a["level_"+t]}if(!this.level_data){var l=JSON.parse(JSON.stringify(this.level_json.json)),d=Math.floor(Math.random()*(Object.keys(l).length-this.xunhuan_[0])+this.xunhuan_[0]);this.level_data=l["level_"+d]}}if(o.cPublicMager.map_data?o.cPublicMager.map_data["id"+this.level_data.mapId]&&(this.map_data=JSON.parse(JSON.stringify(o.cPublicMager.map_data["id"+this.level_data.mapId]))):this.map_json.json["id"+this.level_data.mapId]&&(this.map_data=JSON.parse(JSON.stringify(this.map_json.json["id"+this.level_data.mapId]))),!this.map_data)for(this.map_data=[],n=0;n<14;n++){for(var _=[],u=0;u<8;u++)_.push(0);this.map_data.push(_)}for(n=0;n<this.level_data.obstacle.length;n++)for(u=0;u<this.level_data.obstacle[n][1];u++){var p=Math.floor(14*Math.random()),h=Math.floor(8*Math.random());0==this.map_data[p][h]?this.map_data[p][h]=this.level_data.obstacle[n][0]:u--}this.data=[];var f=[];for(n=0;n<this.level_data.num;n++)f.push(n);var g=[];for(n=0;n<this.level_data.num;n++){var v=Math.floor(Math.random()*f.length);g.push(f[v]),f.splice(v,1)}var m=[],y=0;for(n=0;n<16;n++){var b=[];for(u=0;u<10;u++){var w=new c.block_data;w.pos.x=n,w.pos.y=u,w.tag=y,b.push(w),y++}m.push(b)}for(n=0;n<this.map_data.length;n++)for(u=0;u<this.map_data[n].length;u++)-8==this.map_data[n][u]&&(this.map_data[n][u]=0,m[n+1][u+1].is_tengman=!0),-11==this.map_data[n][u]&&(this.map_data[n][u]=0,m[n+1][u+1].is_yun=!0);var k=[],S=0;for(n=0;n<this.map_data.length;n++)for(u=0;u<this.map_data[n].length;u++)this.map_data[n][u]>0&&(k[this.map_data[n][u]]||(k[this.map_data[n][u]]=[]),k[this.map_data[n][u]].push(-1)),0!=this.map_data[n][u]&&-3!=this.map_data[n][u]||S++;for(n=0;n<k.length;n++)if(k[n])for(i=g[v=Math.floor(Math.random()*g.length)],g.splice(v,1),u=0;u<k[n].length;u++)k[n][u]=i;var M=[],x=S/2,P=0;for(n=0;n<x;n++)g[n]?M.push(g[n]):P++;var C=[],R=Math.floor(g.length*this.level_data.rate);for(R<1&&(R=1),n=0;n<R;n++)i=g[v=Math.floor(Math.random()*g.length)],g.splice(v,1),C.push(i);for(n=0;n<P;n++)t=(n+1)%C.length,M.push(C[t]);var T=M.length;for(n=0;n<T;n++)M.push(M[n]);for(n=0;n<M.length;n++)for(u=n+1;u<M.length;u++){var O=M[v=Math.floor(Math.random()*M.length)];M[v]=M[u],M[u]=O}for(n=1;n<m.length-1;n++)for(u=1;u<m[n].length-1;u++)(i=this.map_data[n-1][u-1])<0&&-3!=i?m[n][u].id=i:0==i||-3==i?(m[n][u].id=M[0],M.splice(0,1)):(m[n][u].id=k[i][0],k[i].splice(0,1));var F=[],I=[];for(n=1;n<m.length-1;n++)for(u=1;u<m[n].length-1;u++)0==this.map_data[n-1][u-1]&&(F[m[n][u].id]||(F[m[n][u].id]={block_arr:[],num:0}),F[m[n][u].id].num++,I.push(m[n][u]));for(n=1;n<m.length-1;n++)for(u=1;u<m[n].length-1;u++)if(0==this.map_data[n-1][u-1])for(var N=0;N<F.length;N++)F[N]&&F[N].block_arr.push(m[n][u]);if(this.level_data.distr>0)for(n=0;n<F.length;n++)if(F[n])for(u=0;u<F[n].num;u++){var A=F[n].block_arr;if(D=A[v=Math.floor(Math.random()*A.length)]){A.splice(v,1);var B=I.indexOf(D);-1!=v&&I.splice(B,1)}else D=I[v=Math.floor(Math.random()*I.length)],I.splice(v,1);for(D.id=n,N=0;N<A.length;N++)Math.abs(D.pos.x-A[N].pos.x)+Math.abs(D.pos.y-A[N].pos.y)<this.level_data.distr&&(A.splice(N,1),N--);for(N=0;N<F.length;N++)if(F[N])for(var j=0;j<F[N].block_arr.length;j++){var E=F[N].block_arr.indexOf(D);-1!=E&&F[N].block_arr.splice(E,1)}}for(n=1;n<m.length-1;n++)for(u=1;u<m[n].length-1;u++)-3==this.map_data[n-1][u-1]&&(this.out_id.push(m[n][u].id),m[n][u].id=-3);if(this.data=m,this.move_json.json["id"+this.level_data.moveType])this.move_data=JSON.parse(JSON.stringify(this.move_json.json["id"+this.level_data.moveType]));else if(-6==this.level_data.moveType)for(n=1;n<this.data.length-1;n++)for(u=1;u<this.data[n].length-1;u++){var D=this.data[n][u];this.data[D.pos.x][D.pos.y-1].pos.y>0&&(D.next_block=this.data[D.pos.x][D.pos.y-1],this.data[D.pos.x][D.pos.y-1].last_block=D)}for(n=0;n<m.length;n++)for(u=0;u<m[n].length;u++)if(-10==m[n][u].id)for(N=0;N<3;N++)for(j=0;j<3;j++)this.move_data[n-N]&&this.move_data[n-N][u-j]&&(this.move_data[n-N][u-j]=0);this.difficulty_control(!0),this.move_link()},t.prototype.move_link=function(){for(var e=0;e<this.move_data.length;e++)for(var t=0;t<this.move_data[e].length;t++){var a=this.data[e+1][t+1];switch(this.move_data[e][t]){case 1:this.data[a.pos.x][a.pos.y-1].pos.y>0&&(a.next_block=this.data[a.pos.x][a.pos.y-1],this.data[a.pos.x][a.pos.y-1].last_block=a);break;case 2:this.data[a.pos.x][a.pos.y+1].pos.y<this.data[e].length-1&&(a.next_block=this.data[a.pos.x][a.pos.y+1],this.data[a.pos.x][a.pos.y+1].last_block=a);break;case 3:this.data[a.pos.x-1][a.pos.y].pos.x>0&&(a.next_block=this.data[a.pos.x-1][a.pos.y],this.data[a.pos.x-1][a.pos.y].last_block=a);break;case 4:this.data[a.pos.x+1][a.pos.y].pos.x<this.data.length-1&&(a.next_block=this.data[a.pos.x+1][a.pos.y],this.data[a.pos.x+1][a.pos.y].last_block=a)}}var i=[];for(e=0;e<this.data.length;e++)for(t=0;t<this.data[e].length;t++)if(-1==i.indexOf(this.data[e][t])){i.push(this.data[e][t]);var n=[this.data[e][t]];a=this.data[e][t];for(var o=!1;a.next_block;)if(n.push(a.next_block),i.push(a.next_block),a=a.next_block,-1!=n.indexOf(a.next_block)){o=!0;break}1==o&&this.xun_huan_block_arr.push(n)}},t.prototype.sisuo=function(){var e=Math.floor(Math.random()*(this.data.length-3)+1),t=Math.floor(Math.random()*(this.data[0].length-3)+1),a=this.data[e][t],i=this.data[e][t+1];if(a.id!=i.id&&-1!=a.id&&-1!=i.id){var n=this.data[e+1][t],o=this.data[e+1][t+1],c=[a.id,i.id],r=[n.id,o.id];n.id=i.id,o.id=a.id;for(var s=0;s<c.length;s++)for(var l=!1,d=1;d<this.data.length-1;d++){for(var _=1;_<this.data[d].length-1;_++)if(this.data[d][_].id==c[s]&&this.data[d][_].tag!=a.tag&&this.data[d][_].tag!=i.tag&&this.data[d][_].tag!=n.tag&&this.data[d][_].tag!=o.tag){this.data[d][_].id=r[s],l=!0;break}if(1==l)break}var u=[];for(s=0;s<27;s++)s!=c[0]&&s!=c[1]&&u.push(s);var p=Math.floor(Math.random()*u.length),h=Math.floor(Math.random()*u.length);for(s=0;s<this.data.length;s++)for(d=0;d<this.data[s].length;d++)this.data[s][d].tag!=a.tag&&this.data[s][d].tag!=i.tag&&this.data[s][d].tag!=n.tag&&this.data[s][d].tag!=o.tag&&(this.data[s][d].id==c[0]&&(this.data[s][d].id=u[p]),this.data[s][d].id==c[1]&&(this.data[s][d].id=u[h]));var f=[];for(s=0;s<this.data.length;s++)for(d=0;d<this.data[s].length;d++){var g=this.data[s][d],v=-1;for(_=0;_<f.length;_++)if(f[_].id==g.id){v=_;break}-1==v?f.push({id:g.id,num:1}):f[v].num+=1}}else this.sisuo()},t.prototype.new_block=function(){var e=this;this.block_parent.destroyAllChildren();for(var t=this.data.length*this.block_prefab.data.height/2-50,a=-this.data[0].length*this.block_prefab.data.width/2+this.block_prefab.data.width/2,i=[],n=0;n<this.data.length;n++)for(var c=0;c<this.data[n].length;c++){i.push(this.data[n][c]);var s=cc.instantiate(this.block_prefab);s.parent=this.block_parent,s.y=t-n*s.height,s.x=a+c*s.width,s.getComponent(l.default).init(this.data[n][c],this.on_block.bind(this)),this.data[n][c].block_node=s,s.scale=0}this.is_pause=!0;var d=o.cPublicMager.card_play_order["id"+this.level_data.moveType],_=.04;1==o.cPublicMager.is_zui_niu&&(d=o.cPublicMager.card_play_order.id5,_=.04),d||(d=o.cPublicMager.card_play_order.id5);var u=0,p=function(t){u+=_;for(var a=function(a){h.scheduleOnce(function(){i[d[t][a]].fun_show_chuchang(),t==d.length-1&&a==d[t].length-1&&e.scheduleOnce(function(){o.cSound.playEffect(e.new_block_end_effect),e.is_pause=!1;for(var t=0;t<d.length;t++)for(var a=0;a<d[t].length;a++)i[d[t][a]].fun_show_chuchang(.2);if(e.scheduleOnce(function(){o.cSound.playMusic(e.bgm),e.show_tip_ui(e.player_can_play.bind(e))},.5),1==r._p_data._data.new_player){e.new_player_type=0,e.new_player_node=cc.instantiate(e.new_player_prefab),e.new_player_node.parent=e.node;var n=e.find_can_line();e.new_player_data.push(n.data1),e.new_player_data.push(n.data2),e.show_new_player(n.data1.block_node)}},.2)},u)},n=0;n<d[t].length;n++)a(n);_*=.98},h=this;for(n=0;n<d.length;n++)p(n);o.cSound.playEffect(this.new_block_effect),this.gra_duigdao()},t.prototype.compute_dir=function(e,t){var a=0,i=1;return e.y==t.y&&e.x!=t.x&&(a=1,e.x<t.x&&(i=-1)),e.x==t.x&&e.y!=t.y&&(a=2,e.y>t.y&&(i=-1)),{dir:a,dir2:i}},t.prototype.gra_duigdao=function(){this.guidao.clear();for(var e=-1,t=-1,a=0,i=0;i<this.xun_huan_block_arr.length;i++){var n=this.xun_huan_block_arr[i][0].block_node.convertToWorldSpaceAR(cc.v2(0,0)),o=this.guidao.node.convertToNodeSpaceAR(n);this.guidao.moveTo(o.x,o.y);for(var c=this.xun_huan_block_arr[i][0].pos,r=o,s=1;s<this.xun_huan_block_arr[i].length;s++){var l=this.xun_huan_block_arr[i][s];-1!=e&&(t=e);var d=this.compute_dir(c,l.pos);e=d.dir,a=d.dir2,1==s&&(1==e&&(a>0?this.guidao.moveTo(r.x,r.y+4.5):this.guidao.moveTo(r.x,r.y-4.5)),2==e&&(a>0?this.guidao.moveTo(r.x+4.5,r.y):this.guidao.moveTo(r.x-4.5,r.y)));var _=l.block_node.convertToWorldSpaceAR(cc.v2(0,0)),u=this.guidao.node.convertToNodeSpaceAR(_);-1!=t&&t!=e&&(2==e&&(u.x>r.x?this.guidao.moveTo(r.x+4.5,r.y):this.guidao.moveTo(r.x-4.5,r.y)),1==e&&(u.y>r.y?this.guidao.moveTo(r.x,r.y+4.5):this.guidao.moveTo(r.x,r.y-4.5))),this.guidao.lineTo(u.x,u.y),this.guidao.moveTo(u.x,u.y),s+1<this.xun_huan_block_arr[i].length&&(1==e&&this.xun_huan_block_arr[i][s+1].pos.y!=l.pos.y&&this.guidao.lineTo(u.x,u.y+4.5*a),2==e&&this.xun_huan_block_arr[i][s+1].pos.x!=l.pos.x&&this.guidao.lineTo(u.x+4.5*a,u.y)),this.guidao.moveTo(u.x,u.y),c=l.pos,r=u}1==e?this.guidao.lineTo(o.x,o.y+4.5*a):this.guidao.lineTo(o.x+4.5*a,o.y)}this.guidao.stroke(),this.guidao.fill()},t.prototype.player_can_play=function(){for(var e=this,t=function(t){for(var i=function(i){a.scheduleOnce(function(){cc.tween(e.xun_huan_block_arr[t][i].block_node).to(.07,{scale:1.2}).to(.07,{scale:1}).start()},.02*i)},n=0;n<a.xun_huan_block_arr[t].length;n++)i(n)},a=this,i=0;i<this.xun_huan_block_arr.length;i++)t(i)},t.prototype.open_touch_fun=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)this.data[e][t].on_bool=!0},t.prototype.on_block=function(e){var t=this;if(1!=this.is_over&&1!=this.is_pause&&0!=e.on_bool&&1!=this.xunhuan_move&&-1==[-1,-2,-3,-4,-5,-6,-7,-10,-11].indexOf(e.id)&&1!=e.is_tengman&&1!=e.is_yun)if(this.unschedule(this.onen_touch_fun_),this.onen_touch_fun_=this.open_touch_fun.bind(this),this.scheduleOnce(this.onen_touch_fun_,5),o.cSound.playEffect(this.touch_effect),this.unschedule(this.dian_jishi),this.scheduleOnce(this.dian_jishi,.5),e==this.last_dian&&(this.doudong_same(e),this.scheduleOnce(function(){t.last_dian=null})),this.last_dian=e,this.dian=!0,this.select_block){if(this.select_block==e)return this.select_block.fun_hide_select(),void(this.select_block=null);e.fun_show_select();var a=this.check_delect(this.select_block,e);a?this.delect([a.data1,a.data2],a.lian):this.select_block.id==e.id?(this.error_select(this.select_block,e),this.select_block=null):(this.select_block.fun_hide_select(),this.select_block=e,this.select_block.fun_show_select()),1==this.new_player_type&&this.new_player_node&&cc.isValid(this.new_player_node)&&(this.new_player_node.destroy(),this.new_player_node=null,this.new_player_type=-1,r._p_data._data.new_player=!1,r._p_data.saveData())}else this.select_block=e,e.fun_show_select(),this.new_player_node&&this.finish_new_player(0,this.new_player_data[1].block_node)},t.prototype.doudong_same=function(e){if(1==this.dian){o.pfApi.vibrateShort();for(var t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)this.data[t][a].id==e.id&&this.data[t][a].fun_show_doudong();this.dian=!1}},t.prototype.dian_jishi=function(){this.dian=!1,this.last_dian=null},t.prototype.check_delect=function(e,t){if(e.id!=t.id)return null;if(-2==e.id||-2==t.id)return null;if(-4!=e.id&&-5!=e.id&&-6!=e.id&&-7!=e.id&&-10!=e.id&&-11!=e.id){var a=[],i=this.round_ray(e,t),n=this.round_ray(t,e);if(-1!=i.indexOf(t))return a.push(e,t),{data1:e,data2:t,lian:a};for(var o=null,c=0;c<i.length;c++)if(-1!=n.indexOf(i[c])){o=i[c];break}if(o)return a.push(e,o,t),{data1:e,data2:t,lian:a};var r=null,s=null,l=!1;for(c=0;c<i.length;c++){for(var d=0;d<n.length;d++){if(i[c].pos.x==n[d].pos.x){if((h=i[c].pos.y)>(f=n[d].pos.y)){var _=h;h=f,f=_}for(var u=!0,p=h+1;p<f;p++)if(-1!=this.data[i[c].pos.x][p].id){u=!1;break}if(1==u){l=!0,r=i[c],s=n[d];break}}if(i[c].pos.y==n[d].pos.y){var h,f;for((h=i[c].pos.x)>(f=n[d].pos.x)&&(_=h,h=f,f=_),u=!0,p=h+1;p<f;p++)if(-1!=this.data[p][i[c].pos.y].id){u=!1;break}if(1==u){l=!0,r=i[c],s=n[d];break}}}if(1==l)break}return 1==l?(a.push(e,r,s,t),{data1:e,data2:t,lian:a}):null}},t.prototype.check_line=function(e,t){var a=[],i=this.round_ray(e,t),n=this.round_ray(t,e);if(-1!=i.indexOf(t))return a.push(e,t),{data1:e,data2:t,lian:a};for(var o=null,c=0;c<i.length;c++)if(-1!=n.indexOf(i[c])){o=i[c];break}if(o)return a.push(e,o,t),{data1:e,data2:t,lian:a};var r=null,s=null,l=!1;for(c=0;c<i.length;c++){for(var d=0;d<n.length;d++){if(i[c].pos.x==n[d].pos.x){if((h=i[c].pos.y)>(f=n[d].pos.y)){var _=h;h=f,f=_}for(var u=!0,p=h+1;p<f;p++)if(-1!=this.data[i[c].pos.x][p].id){u=!1;break}if(1==u){l=!0,r=i[c],s=n[d];break}}if(i[c].pos.y==n[d].pos.y){var h,f;for((h=i[c].pos.x)>(f=n[d].pos.x)&&(_=h,h=f,f=_),u=!0,p=h+1;p<f;p++)if(-1!=this.data[p][i[c].pos.y].id){u=!1;break}if(1==u){l=!0,r=i[c],s=n[d];break}}}if(1==l)break}return 1==l?(a.push(e,r,s,t),{data1:e,data2:t,lian:a}):null},t.prototype.delect=function(e,t,a){var i=this;this.last_dian=null,this.xiaochu_cishu++;for(var n=[],c=e[0].id,s=0;s<e.length;s++){-9==e[s].id&&n.push(e[s]),e[s].id=-1,e[s].fun_show_delete();var l=e[s].block_node.convertToWorldSpaceAR(cc.v2(0,0)),_=this.node.convertToNodeSpaceAR(l),u=cc.instantiate(this.delect_effect);u.parent=this.node,u.setPosition(_),this.level_script&&this.level_script.delect_block(e[s],c)}n.length>0&&this.feidan(n);var p=this.get_week(e),h=this.active_block(p),f=h.delect_arr;for(s=0;s<e.length;s++)f.push(e[s]);var g=[],v=[],m=[];for(s=0;s<f.length;s++){for(var y=f[s],b=0;b<1&&-1==m.indexOf(y)&&(m.push(y),y.next_block);)y=y.next_block;-1==v.indexOf(y)&&v.push(y)}var w=[];if(a)for(s=0;s<a.length;s++)w.push(a[s]);for(s=0;s<f.length;s++)w.push(f[s]);for(s=0;s<h.can_move.length;s++)w.push(h.can_move[s]);var k=[];for(s=0;s<v.length;s++){var S=v[s];for(b=0;b<1&&-1==k.indexOf(S)&&(k.push(S),g.push(S),S.on_bool=!1,S.last_block);)S=S.last_block}if(this.un_move_arr.push({xiaochu_cishu:this.xiaochu_cishu,arr:g}),this.select_block&&(this.select_block=null),o.pfApi.vibrateShort(),t){var M=cc.instantiate(this.line_prefab);M.parent=this.line_parent,M.getComponent(d.default).init(t),this.scheduleOnce(function(){i.level_script?i.level_script.show_fly_item(t,c):i.show_fly_item(t,c)},.3)}if(1==this.check_win())this.is_over=!0,this.scheduleOnce(function(){i.win_fun()},.5);else{if(1==this.is_over)return;this.check_move(w,this.xiaochu_cishu)}for(s=0;s<this.tip_block.length;s++)this.tip_block[s].fun_hide_tip();for(this.tip_block=[],s=0;s<this.zidong_tip_block.length;s++)this.zidong_tip_block[s].fun_hide_tip();this.zidong_tip_block=[],this.lianji_num++,this.init_lianji(c,e[e.length-1]);var x=this.lianji_num;if(x>8&&(x=8),this.scheduleOnce(function(){o.cSound.playEffect(i.delect_music)},.2),this.zidong_tip(),1==r._p_data._data.level){var P=this.xiaochu_cishu.toString();this.xiaochu_cishu<10&&(P="0"+P)}this.hide_qipao(),0==this.is_over&&this.scheduleOnce(this.show_qipao,7)},t.prototype.get_week=function(e){for(var t=[],a=0;a<e.length;a++){var i=[];this.data[e[a].pos.x-1]&&this.data[e[a].pos.x-1][e[a].pos.y]&&i.push(this.data[e[a].pos.x-1][e[a].pos.y]),this.data[e[a].pos.x+1]&&this.data[e[a].pos.x+1][e[a].pos.y]&&i.push(this.data[e[a].pos.x+1][e[a].pos.y]),this.data[e[a].pos.x][e[a].pos.y-1]&&i.push(this.data[e[a].pos.x][e[a].pos.y-1]),this.data[e[a].pos.x][e[a].pos.y+1]&&i.push(this.data[e[a].pos.x][e[a].pos.y+1]);for(var n=0;n<i.length;n++)-1==t.indexOf(i[n])&&-1==e.indexOf(i[n])&&t.push(i[n])}return t},t.prototype.active_block=function(e){for(var t=this,a=!1,i=[],n=[],c=function(c){if(-4==e[c].id||-5==e[c].id||-6==e[c].id){var s=e[c].id;r.scheduleOnce(function(){o.cSound.playEffect("effect/snow_break");var a=e[c].block_node.convertToWorldSpaceAR(cc.v2(0,0)),i=t.node.convertToNodeSpaceAR(a),n=cc.instantiate(t.bing_bao);if(n.parent=t.node,n.setPosition(i),n.getComponent(u.default).init(s),-5==s||-6==s){var r=e[c].block_node.getComponent(l.default).block;cc.Tween.stopAllByTarget(r),cc.tween(r).to(.02,{angle:15}).to(.04,{angle:-15}).to(.02,{angle:0}).start(),e[c].init_view()}else-4==s&&e[c].fun_show_delete(!1,0,.1)},.35)}-3==e[c].id?(0==a&&(a=!0,o.cSound.playEffect(r.fanpai_effect)),e[c].id=r.out_id[0],r.out_id.shift(),e[c].fun_show_fanmian()):-6==e[c].id?e[c].id=-5:-5==e[c].id?e[c].id=-4:-4==e[c].id?(i.push(e[c]),e[c].id=-1):1==e[c].is_tengman&&(n.push(e[c]),e[c].fun_un_lock())},r=this,s=0;s<e.length;s++)c(s);return n.length>0&&this.scheduleOnce(function(){o.cSound.playEffect("effect/vine_effect")},.35),{delect_arr:i,can_move:n}},t.prototype.show_fly_item=function(e,t){if(e.length<3){var a=(e[0].block_node.x+e[1].block_node.x)/2,i=(e[0].block_node.y+e[1].block_node.y)/2,n=e[0].block_node.x-a,o=e[0].block_node.y-i;(s=cc.instantiate(this.fly_item)).parent=this.node;var c=e[0].block_node.convertToWorldSpaceAR(cc.v2(-n,-o));s.getComponent(_.default).init(c,t)}else for(var r=1;r<e.length-1;r++){var s;c=e[r].block_node.convertToWorldSpaceAR(cc.v2(0,0)),(s=cc.instantiate(this.fly_item)).parent=this.node,s.getComponent(_.default).init(c,t)}},t.prototype.init_lianji=function(e,t){var a=11;if(this.lianji_num>5&&(a=6),this.unschedule(this.lianji_jishi),this.scheduleOnce(this.lianji_jishi,a),this.level_script&&1==this.level_script.effect_label_bool){var i=t.block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.convertToNodeSpaceAR(i);(o=cc.instantiate(this.touch_effectt)).parent=this.node,o.setPosition(n),o.getComponent(f.default).init(e)}else if(t&&this.lianji_num>2){var o;i=t.block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.convertToNodeSpaceAR(i),(o=cc.instantiate(this.touch_effectt)).parent=this.node,o.setPosition(n),o.getComponent(f.default).init(this.lianji_num)}},t.prototype.lianji_jishi=function(){this.lianji_num=0},t.prototype.check_move=function(e,t){for(var a=[],i=[],n=0,o=[],c=0;c<e.length;c++){for(var r=e[c],s=0;s<1;){if(++n>1e3)return;if(i.push(r),!r.next_block)break;if(-1!=i.indexOf(r.next_block)){o.push(r);break}r=r.next_block}-1==a.indexOf(r)&&a.push(r)}var l=[],d=[-2,-4,-5,-6],_=[];for(c=0;c<a.length;c++){var u=0,p=a[c];for(s=0;s<1&&-1==_.indexOf(p);){if(_.push(p),-1!=d.indexOf(p.id)&&(u=0),-1==p.id)u++;else{var h=u;-1!=o.indexOf(a[c])&&(h=1),h>0&&l.push({data:p,num:h})}if(!p.last_block)break;p=p.last_block}}this.move_block(l,t)},t.prototype.move_block=function(e,t){for(var a=this,i=[],n=0;n<e.length;n++){for(var o=e[n].data,c=e[n].data,r=0;r<e[n].num;r++)c=c.next_block;i.push({target:o,start:c,num:e[n].num})}var s=[];for(n=0;n<i.length;n++){var d=i[n].start.id;i[n].start.id=i[n].target.id,i[n].target.id=d;var _=i[n].start.is_tengman;i[n].start.is_tengman=i[n].target.is_tengman,i[n].target.is_tengman=_,i[n].start.fun_hide_select(),i[n].target.fun_hide_select();var u=!1;n==i.length-1&&(u=!0);var p={start:i[n].start,target:i[n].target,id:i[n].start.id,bool:u,num:i[n].num};this.move_block_data[i[n].start.tag]||(this.move_block_data[i[n].start.tag]=[]),this.move_block_data[i[n].start.tag].push(p),s.push(p.start)}i.length<1?this.can_move(t):this.moving=!0;var h=function(e){var n=f.move_block_data[i[e].start.tag][0],o=-1;f.move_block_data[i[e].target.tag][0]&&(o=s.indexOf(f.move_block_data[i[e].target.tag][0].start));for(var c=-1,r=0;r<f.moving_block.length;r++)if(f.moving_block[r]==n.target){c=e;var d=n.start.block_node.getComponent(l.default);d.scheduleOnce(d.no_move_yincang,f.move_time);break}-1==o&&0!=f.move_block_data[i[e].target.tag].length||-1!=c||(n.target.block_node.getComponent(l.default).move_id=n.start.id,f.scheduleOnce(function(){a.move_fun(n,t)},f.move_time))},f=this;for(n=0;n<i.length;n++)h(n);this.test_link_ui()},t.prototype.test_link_ui=function(){var e=this;this.find_can_line()||0!=this.is_pause||this.scheduleOnce(function(){e.is_over||(o.cPublicMager.is_zui_niu,o.cUI.addLayer(o.cRes.Prefab.unline_tip_ui))},.5)},t.prototype.can_move=function(e){for(var t=0;t<this.un_move_arr.length;t++)if(this.un_move_arr[t].xiaochu_cishu==e){for(var a=0;a<this.un_move_arr[t].arr.length;a++)this.un_move_arr[t].arr[a].on_bool=!0;this.un_move_arr.splice(t,1);break}this.xunhuan_move=!1},t.prototype.move_fun=function(e,t){var a=this;this.moving_block.push(e.start),e.start.block_node.getComponent(l.default).move_fun(e,function(e){var i=a.moving_block.indexOf(e.start);-1!=i&&a.moving_block.splice(i,1);var n=a.move_block_data[e.start.tag];n.splice(0,1),0==n.length&&(a.can_move(t),a.moving=!1)})},t.prototype.feidan=function(e){var t=this;this.is_pause=!0,this.scheduleOnce(function(){for(var i=[],n=0;n<t.data.length;n++)for(var c=0;c<t.data[n].length;c++)t.data[n][c].id>=0&&i.push(t.data[n][c]);for(var r=Math.floor(4*e.length/2),s=[],l=0;l<r&&!(i.length<=0);l++){var d=i[Math.floor(Math.random()*i.length)].id,_=[];for(n=0;n<i.length;n++)i[n].id==d&&_.push(i[n]);for(n=0;n<2;n++){var u=Math.floor(Math.random()*_.length),p=_[u];s.push(p),_.splice(u,1);var h=i.indexOf(p);-1!=h&&i.splice(h,1)}}var f=[];s.length>0?o.cSound.playEffect("effect/rocket_launch"):t.is_pause=!1;var g=function(i){if(0==cc.isValid(s[i].block_node))return"continue";var n=e[Math.floor(i/4)].block_node.convertToWorldSpaceAR(cc.v2(0,0)),c=t.line_parent.convertToNodeSpaceAR(n),r=cc.instantiate(t.feidan_prefab);r.parent=t.line_parent,r.setPosition(c);var l=s[i].block_node.convertToWorldSpaceAR(cc.v2(0,0)),d=t.line_parent.convertToNodeSpaceAR(l);r.getComponent("bao_zhu").fa_she(d,function(){f.push(s[i]),f.length==s.length&&(t.delect(f),t.scheduleOnce(function(){t.is_pause=!1,t.test_link_ui()},1),t.scheduleOnce(function(){a.gameScene.show_jindu()},.1));var e=cc.instantiate(t.baozha);e.parent=t.line_parent,e.setPosition(d);var n=e.getComponent(sp.Skeleton);n.setToSetupPose(),n.clearTracks();var c=n.addAnimation(0,"huo",!1);n.setTrackCompleteListener(c,function(){cc.isValid(e)&&e.destroy()});var r=Math.floor(3*Math.random()+1);o.cSound.playEffect("effect/explosion"+r)},s[i],i)};for(n=0;n<s.length;n++)g(n)},this.move_time)},t.prototype.round_ray=function(e,t){for(var a=[],i=e.pos.x-1;i>=0&&(-1==this.data[i][e.pos.y].id||this.data[i][e.pos.y]==t);i--)a.push(this.data[i][e.pos.y]);for(i=e.pos.x+1;i<this.data.length&&(-1==this.data[i][e.pos.y].id||this.data[i][e.pos.y]==t);i++)a.push(this.data[i][e.pos.y]);for(i=e.pos.y-1;i>=0&&(-1==this.data[e.pos.x][i].id||this.data[e.pos.x][i]==t);i--)a.push(this.data[e.pos.x][i]);for(i=e.pos.y+1;i<this.data[0].length&&(-1==this.data[e.pos.x][i].id||this.data[e.pos.x][i]==t);i++)a.push(this.data[e.pos.x][i]);return a},t.prototype.error_select=function(e,t){var a=this;o.cSound.playEffect("effect/eliminate_failure"),this.scheduleOnce(function(){a.show_hp(),e.fun_hide_select(),t.fun_hide_select()},this.move_time);var i=e.block_node.getChildByName("item"),n=t.block_node.getChildByName("item");cc.Tween.stopAllByTarget(i),cc.Tween.stopAllByTarget(n),cc.tween(i).to(.02,{angle:-20}).to(.04,{angle:20}).to(.06,{angle:-10}).to(.08,{angle:5}).to(.06,{angle:0}).start(),cc.tween(n).to(.02,{angle:-20}).to(.04,{angle:20}).to(.06,{angle:-10}).to(.08,{angle:5}).to(.06,{angle:0}).start(),r._p_data._data.level<10&&o.cUI.showTips("You can only make connections with up to 2 corners.")},t.prototype.gameOver=function(){1!=this.is_over&&(this.is_over=!0,o.cUI.addScene(o.cRes.Prefab.main_scene))},t.prototype.check_win=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)if(this.data[e][t].id>=0||-3==this.data[e][t].id||-9==this.data[e][t].id)return!1;return!0},t.prototype.win_fun=function(){var e=this;if(1!=this.win_bool)if(this.win_bool=!0,this.block_parent.destroyAllChildren(),this.line_parent.destroyAllChildren(),this.guidao.clear(),0==r._p_data._data.level){o.cSound.stopMusic(),o.cSound.playEffect("effect/difficulty_surge"),r._p_data._data.level++,r._p_data.saveData(),r._p_data.settle(r._p_data._data.level,0,0),this.hard_node.active=!0,cc.Tween.stopAllByTarget(this.hard_node),this.hard_node.x=-720;var t=this.hard_node.getChildByName("label");cc.tween(this.hard_node).to(.7,{x:0},{easing:"backOut"}).delay(.2).call(function(){o.cSound.playEffect("effect/difficulty_word"),cc.tween(t).to(.15,{scale:1.1}).to(.15,{scale:1}).start()}).delay(.8).to(.7,{x:-720},{easing:"backIn"}).call(function(){e.hard_node.active=!1,e.init()}).start()}else r._p_data._data.level++,r._p_data.saveData(),r._p_data._data.level>9&&0==r._p_data._data.zui_niu_open?(r._p_data._data.zui_niu_open=!0,o.cUI.addLayer(o.cRes.Prefab.win_ui,!1),0==r._p_data._data.zui_niu_level&&(o.cPublicMager.first_unlock_zuiniu=!0)):o.cUI.addLayer(o.cRes.Prefab.win_ui,!1),0==o.cPublicMager.get_sdk_data&&(this.now_finish_level++,this.now_finish_level>=3&&(o.cPublicMager.get_sdk_data=!0))},t.prototype.show_item=function(e,t){var a=this;if(-1!=e){var i=cc.instantiate(this.item_icon_prefab);i.parent=this.node,i.y=e,i.getComponent(h.default).init(t),o.cSound.playEffect("effect/prop_shake");var n=this.item_parent.children[t].convertToWorldSpaceAR(cc.v2(0,0)),c=this.node.convertToNodeSpaceAR(n);cc.tween(i).to(.05,{angle:10}).to(.1,{angle:-20}).to(.05,{angle:10}).to(.5,{x:c.x,y:c.y,scale:.5},{easing:"backIn"}).call(function(){o.cSound.playEffect("effect/get_prop"),i.destroy(),a.show_item_fun(),cc.tween(a.item_parent.children[t]).to(.1,{scale:1.2}).to(.1,{scale:1}).start()}).start()}else this.show_item_fun()},t.prototype.show_item_fun=function(){for(var e=this.item_parent.children,t=0;t<r._p_data._data.item.length;t++){var a=e[t].getChildByName("node2").getChildByName("label");a.getComponent(cc.Label).string=r._p_data._data.item[t].toString(),r._p_data._data.item[t]<=0?(a.parent.active=!1,e[t].getChildByName("node1").active=!0):(a.parent.active=!0,e[t].getChildByName("node1").active=!1)}},t.prototype.on_btn=function(e,t){if(1!=this.is_pause){this.btn0(),cc.Tween.stopAllByTarget(e.target);var a=Number(t);if(r._p_data._data.item[a]<=0){if(o.cUI.addLayer(o.cRes.Prefab.get_item_ui).then(function(e){e.getComponent("get_item_ui").init(a)}),1==a){var i=this.find_can_line();cc.Tween.stopAllByTarget(this.refresh_btn),this.refresh_btn.scale=1,i||cc.tween(this.refresh_btn).to(.5,{scale:1.1}).to(.5,{scale:1}).union().repeatForever().start()}}else{switch(r._p_data._data.item[a]--,a){case 0:this.tip();break;case 1:this.refresh();break;case 2:this.item_delect()}r._p_data.useItem(a),this.show_item_fun(),r._p_data.saveData()}}},t.prototype.tip=function(){this.tip_block.length>0&&(this.tip_block[0].fun_hide_tip(),this.tip_block[1].fun_hide_tip(),this.tip_block=[]),this.zidong_tip_block.length>0&&(this.zidong_tip_block[0].fun_hide_tip(),this.zidong_tip_block[1].fun_hide_tip(),this.zidong_tip_block=[]);for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)(this.data[t][a].id>=0||-9==this.data[t][a].id)&&e.push(this.data[t][a]);var i=!1;for(t=0;t<e.length;t++)if(1!=e[t].is_tengman&&1!=e[t].is_yun){for(a=t+1;a<e.length;a++)if(1!=e[a].is_tengman&&1!=e[a].is_yun&&e[t].id==e[a].id){var n=this.check_delect(e[t],e[a]);if(n){this.tip_block.push(n.data1),this.tip_block.push(n.data2),n.data1.fun_show_tip(),n.data2.fun_show_tip(),i=!0,o.cSound.playEffect("effect/hint_prop"),this.tip_number++;break}}if(1==i)break}0==i&&(r._p_data._data.item[0]++,r._p_data.saveData(),this.show_item_fun()),this.hide_qipao()},t.prototype.refresh=function(){var e=this;o.cSound.playEffect("effect/refresh_item"),this.show_unline_btn(),this.tip_block.length>0&&(this.tip_block[0].fun_hide_tip(),this.tip_block[1].fun_hide_tip(),this.tip_block=[]),this.zidong_tip_block.length>0&&(this.zidong_tip_block[0].fun_hide_tip(),this.zidong_tip_block[1].fun_hide_tip(),this.zidong_tip_block=[]);for(var t=[],a=[],i=0;i<this.data.length;i++)for(var n=0;n<this.data[i].length;n++)this.data[i][n].id>=0&&(t.push(this.data[i][n].id),a.push(this.data[i][n]));for(i=0;i<t.length;i++){var c=Math.floor(Math.random()*t.length),r=t[i];t[i]=t[c],t[c]=r}for(i=0;i<a.length;i++)a[i].id=t[i];if(this.difficulty_control(),a[0]){var s=a[0].id;for(i=1;i<a.length;i++)a[i].id==s&&(r=a[1].id,a[1].id=s,a[i].id=r)}for(i=0;i<a.length;i++)a[i].fun_action_init_icon();var d=[-2,-4,-5,-6,-7,-10];this.find_can_line()||(this.is_pause=!0,this.scheduleOnce(function(){for(var t=[],a=[],i=[],n=0;n<e.data.length;n++)for(var c=0;c<e.data[n].length;c++)-3==e.data[n][c].id&&(e.data[n][c].id=e.out_id[0],e.out_id.shift(),e.data[n][c].fun_show_fanmian()),-1!=d.indexOf(e.data[n][c].id)&&t.push(e.data[n][c]),1==e.data[n][c].is_tengman&&a.push(e.data[n][c]),1==e.data[n][c].is_yun&&i.push(e.data[n][c]);e.scheduleOnce(function(){if(a.length>0)if(t.length>0){for(var n=0;n<a.length;n++)a[n].is_tengman=!1,a[n].fun_un_lock();e.delect(t,null,a),e.scheduleOnce(function(){e.is_pause=!1,e.test_link_ui()},1)}else{for(e.scheduleOnce(function(){o.cSound.playEffect("effect/vine_effect")},.35),n=0;n<a.length;n++)a[n].is_tengman=!1,a[n].fun_un_lock();e.check_move(a,1),e.is_pause=!1}else t.length>0?(e.delect(t,null,a),e.scheduleOnce(function(){e.is_pause=!1,e.test_link_ui()},1)):e.is_pause=!1;for(n=0;n<i.length;n++)i[n].block_node.getComponent(l.default).delect_yun();i.length>0&&o.cSound.playEffect("effect/cloud_shatter"),e.line_parent.destroyAllChildren()},.2)},.7)),this.show_shuaxin_num(),cc.Tween.stopAllByTarget(this.refresh_btn),this.refresh_btn.scale=1,this.hide_qipao()},t.prototype.add_hp=function(){if(this.hp>=6)return r._p_data._data.item[2]++,this.show_item_fun(),r._p_data.saveData(),void o.cUI.showTips("Health is already at maximum.");o.cSound.playEffect("effect/life_prop"),this.hp+=3,this.hp>6&&(this.hp=6),this.show_hp(),r._p_data.saveData()},t.prototype.item_delect=function(){if(1==this.moving)return r._p_data._data.item[2]++,r._p_data.saveData(),void this.show_item_fun();for(var e=[],t=0;t<this.data.length;t++)for(var i=0;i<this.data[t].length;i++)1!=this.data[t][i].is_tengman&&this.data[t][i].id>=0&&e.push(this.data[t][i]);var n=[];for(t=0;t<e.length;t++)for(i=t+1;i<e.length;i++)if(e[t].id==e[i].id){var o=[];o.push(e[t]),o.push(e[i]),n.push(o)}if(0==n.length)return r._p_data._data.item[2]++,r._p_data.saveData(),void this.show_item_fun();var c=n[Math.floor(Math.random()*n.length)];this.select_block&&this.select_block.fun_hide_select(),this.delect([c[0],c[1]]),this.scheduleOnce(function(){a.gameScene.show_jindu()},.2)},t.prototype.relive=function(){o.cSound.resumeMusic(),o.cSound.playEffect("effect/life_prop"),this.is_over=!1,this.relive_num--,this.hp+=3,this.show_hp()},t.prototype.zidong_game=function(){var e=this;if(1!=this.is_over)if(0!=o.cPublicMager.zidong)if(1!=this.is_pause){this.zidong=!0;for(var t=[],a=0;a<this.data.length;a++)for(var i=0;i<this.data[a].length;i++)1!=this.data[a][i].is_tengman&&1!=this.data[a][i].is_yun&&this.data[a][i].id>=0&&t.push(this.data[a][i]);var n=1.2,c=!1;for(a=0;a<t.length;a++){for(i=a+1;i<t.length;i++)if(t[a].id==t[i].id){var r=this.check_delect(t[a],t[i]);if(r){r.data1.fun_show_select(),r.data2.fun_show_select(),this.delect([r.data1,r.data2],r.lian),c=!0;break}}if(1==c)break}0==c&&(n=2.5),this.scheduleOnce(function(){e.zidong_game()},n)}else this.scheduleOnce(function(){e.zidong_game()},1);else this.zidong=!1;else this.zidong=!1},t.prototype.show_shuaxin_num=function(){this.refresh_label.string="Refresh Num:"+this.ad_num},t.prototype.on_tip_btn=function(){var e=this;if(0!=this.tip_bool)switch(this.tip_bool=!1,this.scheduleOnce(function(){e.tip_bool=!0},3),o.cSound.playEffect("effect/popup_prompt"),this.level_data.moveType){case-10:o.cUI.showTips("Covered tiles cannot be tapped.");break;case-9:o.cUI.showTips("Magnets attract nearby tiles, making them immovable.");break;case-8:o.cUI.showTips("Connect to launch a rocket and destroy tiles!");break;case-7:o.cUI.showTips("Clear tiles next to vines to remove them.");break;case-6:o.cUI.showTips("Wooden blocks can\u2019t be connected, but they move with others.");break;case 9:case 10:case 11:case 12:o.cUI.showTips("Tiles follow a track and loop when cleared.");break;case-4:o.cUI.showTips("Break the ice! Clear nearby tiles to melt it.");break;case-3:o.cUI.showTips(" Hidden tiles flip when adjacent ones are cleared.");break;case-2:o.cUI.showTips("Stones cannot be cleared or moved.");break;case 1:o.cUI.showTips("Tiles move LEFT after clearing.");break;case 3:o.cUI.showTips("Tiles move UP after clearing.");break;case 2:o.cUI.showTips("Tiles move RIGHT after clearing.");break;case 4:o.cUI.showTips("Tiles move DOWN after clearing.");break;case 5:o.cUI.showTips("Tiles move LEFT and RIGHT after clearing.");break;case 6:o.cUI.showTips("Tiles move UP and DOWN after clearing.");break;case 7:o.cUI.showTips("Tiles move from both sides toward the center after clearing.");break;case 8:o.cUI.showTips("Tiles move from top and bottom to the center after clearing.")}},t.prototype.show_tip_ui=function(e){var t=this;if(0!=this.level_data.moveType&&-1!=this.level_data.moveType){switch(o.cUI.getTexture("texture/dir/"+this.level_data.moveType).then(function(e){t.tip_img.spriteFrame=e}),this.level_data.moveType){case-10:this.tip_word.string="Covered tiles cannot be tapped.";break;case-9:this.tip_word.string="Magnets attract nearby tiles, making them immovable.";break;case-8:this.tip_word.string="Connect to launch a rocket and destroy tiles!";break;case-7:this.tip_word.string="Clear tiles next to vines to remove them.";break;case-6:this.tip_word.string="Wooden blocks can\u2019t be connected, but they move with others.";break;case 9:case 10:case 11:case 12:this.tip_word.string="Tiles follow a track and loop when cleared.";break;case-4:this.tip_word.string="Break the ice! Clear nearby tiles to melt it.";break;case-3:this.tip_word.string=" Hidden tiles flip when adjacent ones are cleared.";break;case-2:this.tip_word.string="Stones cannot be cleared or moved.";break;case 1:this.tip_word.string="Tiles move LEFT after clearing.";break;case 3:this.tip_word.string="Tiles move UP after clearing.";break;case 2:this.tip_word.string="Tiles move RIGHT after clearing.";break;case 4:this.tip_word.string="Tiles move DOWN after clearing.";break;case 5:this.tip_word.string="Tiles move LEFT and RIGHT after clearing.";break;case 6:this.tip_word.string="Tiles move UP and DOWN after clearing.";break;case 7:this.tip_word.string="Tiles move from both sides toward the center after clearing.";break;case 8:this.tip_word.string="Tiles move from top and bottom to the center after clearing."}var a=this.tip_btn.convertToWorldSpaceAR(cc.v2(0,0)),i=this.tip_btn_fly.parent.convertToNodeSpaceAR(a);this.tip_btn_fly.scale=1.5,this.tip_btn_fly.setPosition(cc.v2(0,90)),this.tip_bg.opacity=0,this.tip_word.node.opacity=255,cc.tween(this.tip_bg).to(.1,{opacity:200}).start(),this.tip_ui.active=!0,cc.tween(this.tip_btn_fly).by(.05,{angle:-10}).by(.1,{angle:20}).by(.1,{angle:-20}).by(.1,{angle:20}).by(.05,{angle:-10}).union().repeat(1).delay(.4).call(function(){cc.tween(t.tip_bg).to(.35,{opacity:0}).start(),cc.tween(t.tip_word.node).to(.35,{opacity:0}).start()}).to(.4,{x:i.x,y:i.y,scale:1}).call(function(){t.tip_ui.active=!1,t.tip_btn.active=!0,t.tip_bg.opacity=200,t.tip_word.node.opacity=255,e()}).start()}else e()},t.prototype.zidong_tip=function(){},t.prototype.zidong_tip_fun=function(){for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)-1!=this.data[t][a].id&&e.push(this.data[t][a]);var i=!1;for(t=0;t<e.length;t++){for(a=t+1;a<e.length;a++)if(e[t].id==e[a].id){var n=this.check_delect(e[t],e[a]);if(n){n.data1.fun_show_zidong_tip(),n.data2.fun_show_zidong_tip(),this.zidong_tip_block.push(n.data1),this.zidong_tip_block.push(n.data2),i=!0;break}}if(1==i)break}1==i&&this.zidong_tip_num--},t.prototype.find_can_line=function(){for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)1!=this.data[t][a].is_tengman&&1!=this.data[t][a].is_yun&&(this.data[t][a].id>=0||-9==this.data[t][a].id)&&e.push(this.data[t][a]);var i=null;for(t=0;t<e.length;t++){for(a=t+1;a<e.length;a++)if(e[t].id==e[a].id&&-3!=e[t].id){var n=this.check_delect(e[t],e[a]);if(n){i=n;break}}if(i)break}return i},t.prototype.show_new_player=function(e){if(this.new_player_node)if(0!=cc.isValid(e)){this.new_player_node.active=!0;var t=this.new_player_node.getChildByName("mask");this.new_player_node.getChildByName("hand");var a=e.width*e.scale,i=e.height*e.scale;t.width=a,t.height=i,t.scale=this.shipei_scale;var n=e.convertToWorldSpaceAR(cc.v2(0,0)),o=this.new_player_node.parent.convertToNodeSpaceAR(n);this.new_player_node.setPosition(o)}else this.new_player_node&&(this.new_player_node.active=!1)},t.prototype.finish_new_player=function(e,t){this.new_player_node&&this.new_player_type==e&&(this.new_player_type++,this.show_new_player(t))},t.prototype.difficulty_control=function(e){void 0===e&&(e=!1);for(var t=[],a=[],i=1;i<this.data.length-1;i++)for(var n=1;n<this.data[i].length-1;n++)this.data[i][n].id>=0&&(t.push(this.data[i][n]),a.push(this.data[i][n]));var o=[];for(i=0;i<this.map_data.length;i++)for(n=0;n<this.map_data[i].length;n++)if(this.map_data[i][n]>0){var c=this.data[i+1][n+1];o.push(c)}for(i=0;i<o.length;i++)(l=t.indexOf(o[i]))>=0&&(t.splice(l,1),a.splice(l,1));if(!(t.length<=2)){var r=this.level_data.refreshPairs;1==e&&(r=this.level_data.pairsNum),r>Math.floor(t.length/6)&&(r=Math.floor(t.length/6)),r<1&&(r=1);var s=[];for(i=0;i<r;i++){var l=Math.floor(Math.random()*a.length);s.push(a[l]),a.splice(l,1)}var d=[];for(i=0;i<s.length;i++){var _=s[i];if(!_)break;var u=[];this.data[_.pos.x-1]&&this.data[_.pos.x-1][_.pos.y]&&this.data[_.pos.x-1][_.pos.y].id>=0&&this.data[_.pos.x-1][_.pos.y].pos.x>0&&u.push(this.data[_.pos.x-1][_.pos.y]),this.data[_.pos.x+1]&&this.data[_.pos.x+1][_.pos.y]&&this.data[_.pos.x+1][_.pos.y].id>=0&&this.data[_.pos.x+1][_.pos.y].pos.x<this.data.length-1&&u.push(this.data[_.pos.x+1][_.pos.y]),this.data[_.pos.x][_.pos.y-1]&&this.data[_.pos.x][_.pos.y-1].id>=0&&this.data[_.pos.x][_.pos.y-1].pos.y>0&&u.push(this.data[_.pos.x][_.pos.y-1]),this.data[_.pos.x][_.pos.y+1]&&this.data[_.pos.x][_.pos.y+1].id>=0&&this.data[_.pos.x][_.pos.y+1].pos.y<this.data[_.pos.x].length-1&&u.push(this.data[_.pos.x][_.pos.y+1]);for(var p=0;p<o.length;p++)(l=u.indexOf(o[p]))>=0&&u.splice(l,1);if(!(u.length<1)){var h=u[Math.floor(Math.random()*u.length)],f=[];for(n=0;n<t.length;n++){var g=d.indexOf(t[n]);t[n].tag!=_.tag&&-1==g&&t[n].id==_.id&&f.push(t[n])}if(!(f.length<1)){var v=Math.floor(Math.random()*f.length),m=f[v].id;f[v].id=h.id,h.id=m,d.push(h),d.push(_)}}}}},t.prototype.hide_unline_btn=function(){var e=this.item_parent.children;cc.tween(e[0]).to(.5,{y:-300}).start(),cc.tween(e[2]).to(.5,{y:-300}).start()},t.prototype.show_unline_btn=function(){if(0!=cc.isValid(this.item_parent)){var e=this.item_parent.children;cc.isValid(e[0])&&cc.tween(e[0]).to(.5,{y:0}).start(),cc.isValid(e[2])&&cc.tween(e[2]).to(.5,{y:0}).start()}},t.prototype.lie_can_move=function(e){for(var t=[],a=[],i=[],n=0;n<e.length;n++){for(var o=e[n],c=0;c<1&&-1==i.indexOf(o)&&(i.push(o),o.next_block);)o=o.next_block;-1==a.indexOf(o)&&a.push(o)}var r=[],s=[];for(n=0;n<a.length;n++){var l=a[n];for(c=0;c<1&&-1==s.indexOf(l)&&(s.push(l),t.push(l),r.push(l),l.last_block);)l=l.last_block}return r},t.prototype.on_gift=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.get_star_tip_ui)},t.prototype.on_title=function(){this.btn0(),o.cPublicMager.zidong=!o.cPublicMager.zidong,0==this.zidong&&this.zidong_game()},n([m(cc.Node)],t.prototype,"gameUI",void 0),n([m({type:cc.Sprite})],t.prototype,"bg",void 0),n([m({type:sp.Skeleton})],t.prototype,"bg_skeleton",void 0),n([m({type:cc.Node})],t.prototype,"block_parent",void 0),n([m({type:cc.Prefab})],t.prototype,"block_prefab",void 0),n([m({type:cc.Node})],t.prototype,"hp_parent",void 0),n([m({type:cc.Node})],t.prototype,"line_parent",void 0),n([m({type:cc.Prefab})],t.prototype,"line_prefab",void 0),n([m({type:cc.Node})],t.prototype,"item_parent",void 0),n([m({type:cc.Label})],t.prototype,"level_label",void 0),n([m({type:cc.Label})],t.prototype,"refresh_label",void 0),n([m({type:cc.Node})],t.prototype,"tip_btn",void 0),n([m({type:cc.Prefab})],t.prototype,"delect_prefab",void 0),n([m({type:cc.Node})],t.prototype,"lianji_node",void 0),n([m({type:cc.Label})],t.prototype,"lianji_label",void 0),n([m({type:cc.ProgressBar})],t.prototype,"lianji_progress",void 0),n([m({type:cc.Prefab})],t.prototype,"lianji_effect",void 0),n([m({type:cc.Node})],t.prototype,"lianji_word",void 0),n([m({type:cc.Prefab})],t.prototype,"new_player_prefab",void 0),n([m({type:cc.Label})],t.prototype,"progress_node",void 0),n([m({type:cc.ProgressBar})],t.prototype,"progress_bar",void 0),n([m({type:cc.Node})],t.prototype,"tip_ui",void 0),n([m({type:cc.Sprite})],t.prototype,"tip_img",void 0),n([m({type:cc.Node})],t.prototype,"tip_btn_fly",void 0),n([m({type:cc.Label})],t.prototype,"tip_word",void 0),n([m({type:cc.Node})],t.prototype,"tip_bg",void 0),n([m({type:sp.Skeleton})],t.prototype,"tip_skeleton",void 0),n([m({type:cc.Node})],t.prototype,"refresh_btn",void 0),n([m({type:cc.Prefab})],t.prototype,"star_pre",void 0),n([m({type:cc.Node})],t.prototype,"gift_box",void 0),n([m({type:cc.Node})],t.prototype,"hard_node",void 0),n([m({type:cc.Label})],t.prototype,"bubble_label",void 0),n([m({type:cc.JsonAsset})],t.prototype,"zui_niu_json",void 0),n([m({type:cc.JsonAsset})],t.prototype,"level_json",void 0),n([m({type:cc.JsonAsset})],t.prototype,"map_json",void 0),n([m({type:cc.Prefab})],t.prototype,"bing_bao",void 0),n([m({type:cc.JsonAsset})],t.prototype,"move_json",void 0),n([m({type:cc.Graphics})],t.prototype,"guidao",void 0),n([m({type:cc.Node})],t.prototype,"setting_btn",void 0),n([m({type:cc.Prefab})],t.prototype,"feidan_prefab",void 0),n([m({type:cc.Prefab})],t.prototype,"baozha",void 0),n([m({type:cc.Prefab})],t.prototype,"item_icon_prefab",void 0),n([v],t)}(s.GameSceneView);a.default=y,cc._RF.pop()},{Config:"Config",PlayerDataConfig:"PlayerDataConfig",PlayerDataMager:"PlayerDataMager",ViewSet:"ViewSet",bing_bao:"bing_bao",block_item:"block_item",combo_item:"combo_item",item_icon:"item_icon",level:"level",line:"line",star:"star"}],HttpRequest:[function(e,t,a){"use strict";cc._RF.push(t,"9d283g4BVVDJaGm91mwvDC0","HttpRequest"),Object.defineProperty(a,"__esModule",{value:!0}),a.HttpRequest=void 0,e("PlayerDataMager"),function(e){var t;t=function(e,t,a){var i,n;i=function(){o.removeEventListener("load",i),o.removeEventListener("error",n),a&&a(null,o)},n=function(){o.removeEventListener("load",i),o.removeEventListener("error",n),a&&a(new Error(e))};var o=new Image;return"file:"!==window.location.protocol&&(o.crossOrigin="anonymous"),o.addEventListener("load",i),o.addEventListener("error",n),o.src=e,o},e.updateHttpSprite=function(t,a){if(-1!=t.indexOf("http"))try{cc.assetManager.loadRemote(t,{ext:e.headImgExt},function(e,t){var i;i=new cc.SpriteFrame(t),a&&(a.spriteFrame=i)})}catch(e){console.log("load failed!",e)}else a.spriteFrame=void 0},e.loadRemoteFile=function(e,t){cc.assetManager.loadRemote(e,function(e,a){e?t&&t():t&&t(a)})},e.savePlayerData=function(){},e.getplayerData=function(){},e.request=function(e,t,a,i,n,o){var c,r,s;void 0===o&&(o="POST"),c="/"+e,n&&(c=e),s=JSON.stringify(t),(r=new XMLHttpRequest).onreadystatechange=function(){var e;if(4==r.readyState&&200==r.status)e=null,""!=r.responseText&&(e=JSON.parse(r.responseText)),a&&a(e);else if(4==r.readyState&&200!=r.status){var t;t={url:c,readyState:r.readyState,status:r.status,data:s},e=null,i&&i(t)}},r.open(o,c,!0),"Get"!=o?(r.setRequestHeader("Content-type","application/json; charset=utf-8"),r.send(s)):r.send()},e.headImgExt=".head",e.registerHeadImgLoader=function(){cc.assetManager.downloader.register(e.headImgExt,function(e,t,a){a(null,e)}),cc.assetManager.parser.register(e.headImgExt,t),cc.assetManager.factory.register(e.headImgExt,function(e,t,a,i){var n,o;n=null,o=null;try{(n=new cc.Texture2D)._uuid=e,n._nativeUrl=e,n._nativeAsset=t}catch(e){o=e}i&&i(o,n)})}}(a.HttpRequest||(a.HttpRequest={})),cc._RF.pop()},{PlayerDataMager:"PlayerDataMager"}],LoadingResNode:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d;cc._RF.push(t,"d173asWhh1B8aHmrvNR71Vf","LoadingResNode"),l=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=e("ClientEvent");var _=e("Config"),u=e("Res");c=e("PlayerDataMager"),r=cc._decorator,s=r.ccclass,d=r.property,i=function(e){var t;return l(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).probar=void 0,t._loadedCount=0,t.un_finish_bundle=[],t.res_number=0,t},e),t.prototype.start=function(){},t.prototype.startLoades=function(){for(var e in _.cRes.bundlesName)this.un_finish_bundle.push(_.cRes.bundlesName[e]);this.un_finish_bundle.push("level"),_.cBunbleMager.preLoadBundle(this.startGame.bind(this))},t.prototype.startGame=function(e){var t,a;t=this,-1!=(a=this.un_finish_bundle.indexOf(e.name))&&this.un_finish_bundle.splice(a,1),this._loadedCount++,"sound"==e.name&&e.loadDir("effect",cc.AudioClip,function(e,a){t.start_game();for(var i=0;i<a.length;i++)_.cPublicMager.music["effect/"+a[i].name]=a[i]}),e.name,this._loadedCount==u.bundlesNameLength&&this.load_res()},t.prototype.load_res=function(){for(var e=this,t=0,a=0,i=function(i){if(i!=c._p_data._data.theme&&i!=c._p_data._data.collectting_theme)return"continue";a++,_.cPublicMager.load_level_bundle(i,function(){if(++t==a){var i=e.un_finish_bundle.indexOf("level");e.un_finish_bundle.splice(i,1),e.start_game(),e.probar.progress=1}})},n=0;n<_.cPublicMager.skin_name.length;n++)i(n);_.cBunbleMager.loadBundle("common",function(t){t.loadDir("texture",cc.SpriteFrame,function(t,a){e.start_game();for(var i=0;i<a.length;i++)_.cPublicMager.image[a[i].name]=a[i]})})},t.prototype.start_game=function(){var e;e=this,this.res_number++,console.log("res_number",this.res_number),3==this.res_number&&this.scheduleOnce(function(){_.cEvent.emit(n.Event_Key.StartGame,"1","2","3"),e.node.destroy()},.2)},t.prototype.update=function(){this.probar.progress+=.005},o([d(cc.ProgressBar)],t.prototype,"probar",void 0),o([s],t)}(cc.Component),a.default=i,cc._RF.pop()},{ClientEvent:"ClientEvent",Config:"Config",PlayerDataMager:"PlayerDataMager",Res:"Res"}],LoadingScene:[function(e,t,a){"use strict";var i,n,o;cc._RF.push(t,"1dd54kjJVpFa5QsSX4wc8QB","LoadingScene"),o=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var c=e("ClientEvent"),r=e("Config"),s=e("PlayerDataMager"),l=e("LoadingResNode"),d=cc._decorator,_=d.ccclass,u=d.property;n=function(e){var t;return o(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).again_btn=null,t.bg=null,t._joinTime=0,t._initing=!1,t.in_game_time=0,t.new_day=!1,t},e),t.prototype.in_game=function(e,t){var a;a=cc.winSize.height/1700,this.bg.scale=a,this.in_game_time=t,this.init_data()},t.prototype.init_data=function(){var e;e=new Date,this._joinTime=e.getTime(),r.cPublicMager.log("init_data"),cc.macro.CLEANUP_IMAGE_CACHE=!1,cc.winSize.height/cc.winSize.width<1.78&&(this.node.getComponent(cc.Canvas).fitHeight=!0),window.addEventListener("message",this.onInit.bind(this))},t.prototype.onInit=function(e){try{if(e.data&&"fofotile"==e.data.game&&"init"==e.data.action){if(this._initing)return;window.removeEventListener("message",this.loading),this._initing=!0,s._p_data.initdone();var t=e.data.data;s._p_data._data.level=t.level,s._p_data._data.item=t.items,s._p_data._data.theme=t.theme,s._p_data._data.theme_collect=t.themes,0==t.level?s._p_data._data.new_player=!0:s._p_data._data.new_player=!1,this.init_day_data(),this.startLoadRes()}}catch(a){console.log("error",a)}},t.prototype.startLoadRes=function(){var e;e=this,this.node.getChildByName("LoadingResNode").getComponent(l.default).startLoades(),r.cSound.effect_switch=1==s._p_data._data.effectSwitch,r.cSound.music_switch=1==s._p_data._data.musicSwitch,r.cEvent.on(c.Event_Key.StartGame,function(){e.startGame()})},t.prototype.start=function(){var e;e=this,r.pfApi.onShow(function(e){!r.cSound._isPause&&r.cSound.now_music&&cc.audioEngine.resumeMusic(),e.scene&&e.scene}),this.scheduleOnce(function(){if(e.node.getChildByName("LoadingResNode"))for(var t=e.node.getChildByName("LoadingResNode").getComponent(l.default).un_finish_bundle,a=0;a<t.length;a++)t[a]},10),this.in_game(null,(new Date).getTime())},t.prototype.on_again=function(){},t.prototype.startGame=function(){var e;e=this,cc.director.loadScene("Main",function(){var t;t=(new Date).getTime()-e._joinTime,console.warn("time:"+t/1e3+"s")})},t.prototype.init_day_data=function(){s._p_data._data.level<0&&(s._p_data._data.level=0),s._p_data._data.item.length>3&&(s._p_data._data.item=[s._p_data._data.item[0],s._p_data._data.item[1],s._p_data._data.item[2]]),isNaN(s._p_data._data.star)&&(s._p_data._data.star=0);for(var e=0;e<r.cPublicMager.skin_name.length;e++)if(!s._p_data._data.theme_collect[e]){var t,a,i;a=[],i=27,t=r.cPublicMager.skin_name[e],-1!=r.cPublicMager.limit_skin.indexOf(t)&&(i=34);for(var n=0;n<i;n++){var o;o=0,"Cozy Garden"==r.cPublicMager.skin_name[e]&&(o=1),a.push(o)}s._p_data._data.theme_collect.push(a)}s._p_data.saveData()},t.prototype.init_game_config=function(){if(s._p_data._data.level_version)r.cPublicMager.config.level_version[s._p_data._data.level_version]||(s._p_data._data.level_version="level_data");else if(0==s._p_data._data.level){var e,t;for(var a in e=[],t=0,r.cPublicMager.config.level_version)e.push({version:a,percent:r.cPublicMager.config.level_version[a].percent}),t+=r.cPublicMager.config.level_version[a].percent;for(var i=Math.random()*t,n=0,o=0;o<e.length;o++)if((n+=e[o].percent)>=i){s._p_data._data.level_version=e[o].version;break}}else s._p_data._data.level_version="level_data";s._p_data.saveData()},i([u({type:cc.Node})],t.prototype,"again_btn",void 0),i([u({type:cc.Node})],t.prototype,"bg",void 0),i([_],t)}(cc.Component),a.default=n,cc._RF.pop()},{ClientEvent:"ClientEvent",Config:"Config",LoadingResNode:"LoadingResNode",PlayerDataMager:"PlayerDataMager"}],LocalStorage:[function(e,t,a){"use strict";var i,n,o,c;cc._RF.push(t,"a7d03QbzeBAIZz0vtrMrNKS","LocalStorage"),n=__extends,Object.defineProperty(a,"__esModule",{value:!0}),i=e("SingleBase"),o=cc.sys.localStorage,c=function(e){var t;return n(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.setItem=function(e,t){o.setItem(e,t)},t.prototype.getItem=function(e){return o.getItem(e)||""},t.prototype.getItemNumber=function(e){var t;return(t=o.getItem(e))?Number(t):0},t.prototype.clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){o.removeItem(e)})},t.prototype.getItemMap=function(e,t){var a;return a=o.getItem(e)||"{}",a=JSON.parse(a),void 0!==t?a[t]||{}:a},t.prototype.setItemMap=function(e,t){var a,i,n,c,r,s;c=t.key,n=t.value,r=(i=(a=this.getItemMap(e))[c]||{}).value||0,s=i.times||0,++s>=2&&(s=0,r+=n),i={value:r,times:s},a[c]=i,o.setItem(e,JSON.stringify(a))},t.prototype.setItemList=function(e,t){var a,i,n,c;i=t.key,n=t.value,c=(a=this.getItemList(e))[i]||0,c+=n,a[i]=c,o.setItem(e,JSON.stringify(a))},t.prototype.getItemList=function(e,t){var a;return a=o.getItem(e)||"{}",a=JSON.parse(a),t?a[t]||0:a},t.prototype.getSkinArr=function(e){var t;if(t=o.getItem(e)||"[1,1,0,0,0,0,0,0]",(t=JSON.parse(t)).length<8)for(;t.length<8;)t.push(0);return t},t.prototype.setItemArr=function(e,t){o.setItem(e,JSON.stringify(t))},t}(i.default),a.default=c,cc._RF.pop()},{SingleBase:"SingleBase"}],MainCamera:[function(e,t,a){"use strict";var i,n,o,c,r;cc._RF.push(t,"05bb2vxFI9JKaRotEsEE7xp","MainCamera"),n=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),a.mainCamera=void 0,c=cc._decorator,r=c.ccclass,c.property,o=function(e){var t;return n(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.onLoad=function(){a.mainCamera=this,this.camera=this.node.getComponent(cc.Camera)},t.prototype.start=function(){},t.prototype.setPos=function(e){this.node.position=e},t.prototype.setZoomRatio=function(e){this.camera.zoomRatio=e},t.prototype.startGameAction=function(){cc.tween(this.camera).to(.5,{zoomRatio:1}).start(),cc.tween(this.node).to(.5,{y:0}).start()},i([r],t)}(cc.Component),a.default=o,cc._RF.pop()},{}],MainScene:[function(e,t,a){"use strict";cc._RF.push(t,"b9c09mVugNGIab9sLWwn0me","MainScene");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0}),a.mainScene=void 0;var o=e("Config"),c=e("PlayerDataMager"),r=e("ViewSet"),s=e("GameScene"),l=!1,d=cc._decorator,_=d.ccclass,u=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=void 0,t.bg_skeleton=void 0,t.p_normal=null,t.theme_bool=!1,t.niupi_bool=!1,t}return i(t,e),t.prototype.onLoad=function(){a.mainScene=this,o.cUI.hideAllTips(),cc.dynamicAtlasManager.reset(),o.cNodePool.clearAll(),this.initScene(),this.initPlatform()},t.prototype.onDisable=function(){},t.prototype.start=function(){this.show_view()},t.prototype.maidian_fun=function(){},t.prototype.onDestroy=function(){},t.prototype.initPlatform=function(){},t.prototype.initScene=function(){},t.prototype.loadGameScene=function(e){o.cUI.addScene(o.cRes.Prefab.game_scene).then(function(t){1!=l&&(l=!0,t.getComponent(s.default).initScene(),e&&e())})},t.prototype.loadGameRes=function(){var e=this;o.cUI.createNode(o.cRes.Prefab.loading).then(function(t){t.y=5,t.parent=o.cUI.getGameLoadingRoot(),o.cUI.loadResDir("prefab/game_items/",t).then(function(){t.destroy(),e.loadGameScene()})})},t.prototype.onBtnStartGame=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cPublicMager.is_zui_niu=!1,this.loadGameScene()},t.prototype.on_refresh=function(){var e=this;this.btn0(),o.pfApi.showVideoAd(function(){c._p_data._data.level=0,c._p_data.saveData(),e.show_view()},function(){})},t.prototype.show_view=function(){var e=this;cc.Tween.stopAllByTarget(this._btn_start_game),this._btn_start_game.scale=1,cc.tween(this._btn_start_game).by(1,{scale:.03}).by(1,{scale:-.03}).union().repeatForever().start(),o.cBunbleMager.get_bundle_texture("level_"+c._p_data._data.theme,"bg"+c._p_data._data.theme).then(function(t){e.bg.spriteFrame=t}),o.cBunbleMager.get_bundle_SkeletonData("level_"+c._p_data._data.theme,"bg"+c._p_data._data.theme+"/bg"+c._p_data._data.theme).then(function(t){e.bg_skeleton.skeletonData=t,e.bg_skeleton.setAnimation(0,"idle",!0)});var t=cc.winSize.height/1700;this.bg.node.scale=t,this.p_normal.string="Level "+(c._p_data._data.level+1),0==c._p_data._data.level&&(this.p_normal.string="Play")},t.prototype.on_setting=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.setting)},t.prototype.on_zhuti=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.skin_ui)},t.prototype.on_youxizhan=function(){this.btn0()},t.prototype.on_test_0=function(){this.btn0(),c._p_data._data.level=0,c._p_data._data.zui_niu_level=0,c._p_data.saveData(),this.show_view()},t.prototype.on_add_level_1=function(){c._p_data._data.level++,c._p_data.saveData(),o.cUI.showTips("next level"),this.show_view()},t.prototype.on_show_win=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.win_ui)},n([u({type:cc.Sprite})],t.prototype,"bg",void 0),n([u({type:sp.Skeleton})],t.prototype,"bg_skeleton",void 0),n([u({type:cc.Label})],t.prototype,"p_normal",void 0),n([_],t)}(r.MainSceneView);a.default=p,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewSet:"ViewSet"}],Main:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"242a601KjVDP4uw5nmgEi2i","Main"),c=__extends,r=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l=e("Config"),d=e("PlayerDataMager");i=cc._decorator,o=i.ccclass,s=i.property,n=function(e){var t;return c(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).bg=null,t},e),t.prototype.onLoad=function(){var e;0==d._p_data._data.effectSwitch?cc.audioEngine.setEffectsVolume(0):cc.audioEngine.setEffectsVolume(1),e=cc.winSize.height/1700,this.bg.scale=e,this.startGame(),cc.winSize.height/cc.winSize.width<1.78&&(this.node.getComponent(cc.Canvas).fitHeight=!0),window.addEventListener("message",function(e){console.log("----xxxx---",e.data,e);try{if(e.data.game&&"fofotile"==e.data.game){var t=e.data.action;if("play"==t)l.cUI.addScene(l.cRes.Prefab.game_scene).then(function(){});else if("callback"==t){var a=e.data.data;d._p_data.callback(a.uuid,a.code)}}}catch(i){}}.bind(this))},t.prototype.startGame=function(){l.cUI.addScene(l.cRes.Prefab.game_scene).then(function(){})},r([s({type:cc.Node})],t.prototype,"bg",void 0),r([o],t)}(cc.Component),a.default=n,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager"}],PlatformApi:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"6d28fkwdH1KTZPmVkDuncMd","PlatformApi"),i=__extends,Object.defineProperty(a,"__esModule",{value:!0}),e("PlayerDataMager"),n=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.onLoad=function(){},t.prototype.showVideoAd=function(){},t.prototype.onShow=function(){},t.prototype.vibrateShort=function(){},t}(e("SingleBase").default),a.default=n,cc._RF.pop()},{PlayerDataMager:"PlayerDataMager",SingleBase:"SingleBase"}],PlayerDataConfig:[function(e,t,a){"use strict";var i;cc._RF.push(t,"bfd54GC1cFLrJSlz29hnyNi","PlayerDataConfig"),Object.defineProperty(a,"__esModule",{value:!0}),a.game_config=a.level_data=a.block_data=a.ad=void 0,a.ad=function(){this.hint_item=0,this.refresh_item=0,this.clear_item=0},i=function(){var e;return(e=function(){var e;e=this,this.id=-1,this.pos=cc.v2(0,0),this.tag=-1,this.on_bool=!0,this.next_block=null,this.last_block=null,this.is_tengman=!1,this.is_yun=!1,this.fun_hide_select=function(){e.block_node&&e.block_node.getComponent("block_item").hide_select()},this.fun_show_select=function(){e.block_node&&e.block_node.getComponent("block_item").show_select()},this.init_view=function(t){e.block_node&&e.block_node.getComponent("block_item").init_view(t)},this.fun_action_init_icon=function(){e.block_node&&e.block_node.getComponent("block_item").init_icon_to_action()},this.fun_show_tip=function(){e.block_node&&e.block_node.getComponent("block_item").show_tip()},this.fun_show_zidong_tip=function(){e.block_node&&e.block_node.getComponent("block_item").show_zidong_tip()},this.fun_hide_tip=function(){e.block_node&&e.block_node.getComponent("block_item").hide_tip()},this.fun_show_chuchang=function(t){e.block_node&&e.block_node.getComponent("block_item").show_chuchang(t)},this.fun_show_delete=function(t,a,i){void 0===t&&(t=!1),e.block_node&&e.block_node.getComponent("block_item").show_delete(t,a,i)},this.fun_show_doudong=function(){e.block_node&&e.block_node.getComponent("block_item").show_doudong()},this.fun_show_fanmian=function(){e.block_node&&e.block_node.getComponent("block_item").show_fanmian()}}).prototype.fun_un_lock=function(){this.block_node&&this.block_node.getComponent("block_item").un_lock()},e}(),a.block_data=i,a.level_data=function(){},a.game_config=function(){this.level_version={level_version:{level_data:{percent:0}}},this.gold=200,this.maxLevel=70,this.levelGold=20,this.star=30,this.ad_star=.5},cc._RF.pop()},{}],PlayerDataMager:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"3cfafhlTt9CUp2f7h+17xed","PlayerDataMager"),Object.defineProperty(a,"__esModule",{value:!0}),a._p_data=void 0,e("PublicMager"),e("Utils"),e("PlayerDataConfig"),i=e("StorageManager"),n=function(){var e;return e=function(){this.storage=i.Storage,this._key="game_key",this._game="fofotile",this._data={effectSwitch:1,musicSwitch:1,vibrateSwitch:1,level:0,item:[1,0,0],theme:0,theme_collect:[],challenge:0,collectting_theme:1,new_player:!0,zui_niu_level:0,zui_niu_finish:!1,zui_niu_open:!1,level_version:null,star:0},this._callbacks={}},Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.initData=function(e){var t;(t=this.storage.get(this._key))&&this.updatePlayerData(JSON.parse(t)),e()},e.prototype.updatePlayerData=function(e){for(var t in e)this._data[t]=e[t]},e.prototype.settle=function(e,t,a){console.log("settle",e,t,a),parent.postMessage({game:this._game,action:"settle",data:{level:e,theme:t,block:a}},"*")},e.prototype.switchTheme=function(e){parent.postMessage({game:this._game,action:"setTheme",data:{theme:e}},"*")},e.prototype.addItem=function(e,t){var a=this.getUuid();this._callbacks[a]=t,parent.postMessage({game:this._game,action:"addItem",data:{uuid:a,itemId:e}},"*")},e.prototype.refreshItem=function(e){var t=this.getUuid();this._callbacks[t]=e,parent.postMessage({game:this._game,action:"resfreshItem",data:{uuid:t}},"*")},e.prototype.callback=function(e,t){this._callbacks[e]&&this._callbacks[e](t),delete this._callbacks[e]},e.prototype.getUuid=function(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t=[],a=0;a<18;a++)t.push(e[Math.floor(Math.random()*e.length)]);return t.join("")},e.prototype.useItem=function(e){parent.postMessage({game:this._game,action:"useItem",data:{itemId:e}},"*")},e.prototype.close=function(){parent.postMessage({game:this._game,action:"close",data:{}},"*")},e.prototype.initdone=function(){parent.postMessage({game:this._game,action:"initdone",data:{}},"*")},e.prototype.saveData=function(){var e;return e=this.initServerData(),this.storage.set(this._key,JSON.stringify(e)),e},e.prototype.initServerData=function(){return this._data},e._instance=null,e}(),a._p_data=n.instance,cc._RF.pop()},{PlayerDataConfig:"PlayerDataConfig",PublicMager:"PublicMager",StorageManager:"StorageManager",Utils:"Utils"}],Pool:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"7bebdMZnUVA8YsUPJHGKLFe","Pool"),s=__extends,i=__awaiter,n=__generator,Object.defineProperty(a,"__esModule",{value:!0}),r=e("SingleBase"),o=e("UI"),c=function(e){var t;return s(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).pools=new Map,t},e),t.prototype.createPool=function(e){var t;return t=new cc.NodePool(e),this.pools.set(t.poolHandlerComp,t),t},t.prototype.get=function(e){return i(this,void 0,Promise,function(){var t;return n(this,function(){return(t=this.pools.get(e)||this.createPool(e)).size()>0?[2,t.get()]:[2,o.default.get().createNode(e).then(function(e){return e})]})})},t.prototype.put=function(e){var t;e&&((t=this.pools.get(e.url_name))?t.put(e):e.destroy())},t.prototype.puts=function(e){var t;t=this,e.forEach(function(e){t.put(e)})},t.prototype.clear=function(e){var t;(t=this.pools.get(e))&&(t.clear(),cc.resources.release(e))},t.prototype.clearAll=function(){this.pools.forEach(function(e){e.clear()})},t}(r.default),a.default=c,cc._RF.pop()},{SingleBase:"SingleBase",UI:"UI"}],PublicMager:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"cfe8796uPBJW67K8oFDmWdl","PublicMager"),s=__extends,Object.defineProperty(a,"__esModule",{value:!0}),e("Res"),r=e("PlayerDataConfig"),c=e("PlayerDataMager"),n=e("SingleBase"),i=e("BundleMager"),e("UI"),o=function(e){var t;return s(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).zidong=!1,t.skin_name=["Cozy Garden","Ocean World","Beauty Guru","Merry Christmas","Animal Kingdom","Master Chef","Home Binge","Lazy Afternoon","Family Playground","Global Journey","Eternal Gems","School Days","Sports Pro"],t.limit_skin=[],t.is_zui_niu=!1,t.is_ading=!1,t.test=!1,t.card_play_order={"id-4":[[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148]],"id-3":[[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141]],"id-2":[[104],[94],[84],[74],[64],[54],[44],[45],[55],[65],[75],[85],[95],[105],[115],[114],[113],[103],[93],[83],[73],[63],[53],[43],[33],[34],[35],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[125],[124],[123],[122],[112],[102],[92],[82],[72],[62],[52],[42],[32],[22],[23],[24],[25],[26],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[136],[135],[134],[133],[132],[131],[121],[111],[101],[91],[81],[71],[61],[51],[41],[31],[21],[11],[12],[13],[14],[15],[16],[17],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[147],[146],[145],[144],[143],[142],[141]],"id-1":[[52],[53],[54],[55],[56],[57],[72],[74],[75],[77],[92],[97]],id0:[[104],[94],[84],[74],[64],[54],[44],[45],[55],[65],[75],[85],[95],[105],[115],[114],[113],[103],[93],[83],[73],[63],[53],[43],[33],[34],[35],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[125],[124],[123],[122],[112],[102],[92],[82],[72],[62],[52],[42],[32],[22],[23],[24],[25],[26],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[136],[135],[134],[133],[132],[131],[121],[111],[101],[91],[81],[71],[61],[51],[41],[31],[21],[11],[12],[13],[14],[15],[16],[17],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[147],[146],[145],[144],[143],[142],[141]],id1:[[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141]],id3:[[141],[142],[143],[144],[145],[146],[147],[148],[131],[132],[133],[134],[135],[136],[137],[138],[121],[122],[123],[124],[125],[126],[127],[128],[111],[112],[113],[114],[115],[116],[117],[118],[101],[102],[103],[104],[105],[106],[107],[108],[91],[92],[93],[94],[95],[96],[97],[98],[81],[82],[83],[84],[85],[86],[87],[88],[71],[72],[73],[74],[75],[76],[77],[78],[61],[62],[63],[64],[65],[66],[67],[68],[51],[52],[53],[54],[55],[56],[57],[58],[41],[42],[43],[44],[45],[46],[47],[48],[31],[32],[33],[34],[35],[36],[37],[38],[21],[22],[23],[24],[25],[26],[27],[28],[11],[12],[13],[14],[15],[16],[17],[18]],id2:[[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148]],id4:[[11],[12],[13],[14],[15],[16],[17],[18],[21],[22],[23],[24],[25],[26],[27],[28],[31],[32],[33],[34],[35],[36],[37],[38],[41],[42],[43],[44],[45],[46],[47],[48],[51],[52],[53],[54],[55],[56],[57],[58],[61],[62],[63],[64],[65],[66],[67],[68],[71],[72],[73],[74],[75],[76],[77],[78],[81],[82],[83],[84],[85],[86],[87],[88],[91],[92],[93],[94],[95],[96],[97],[98],[101],[102],[103],[104],[105],[106],[107],[108],[111],[112],[113],[114],[115],[116],[117],[118],[121],[122],[123],[124],[125],[126],[127],[128],[131],[132],[133],[134],[135],[136],[137],[138],[141],[142],[143],[144],[145],[146],[147],[148]],id5:[[14,15],[24,25],[34,35],[44,45],[54,55],[64,65],[74,75],[84,85],[94,95],[104,105],[114,115],[124,125],[134,135],[144,145],[13,16],[23,26],[33,36],[43,46],[53,56],[63,66],[73,76],[83,86],[93,96],[103,106],[113,116],[123,126],[133,136],[143,146],[12,17],[22,27],[32,37],[42,47],[52,57],[62,67],[72,77],[82,87],[92,97],[102,107],[112,117],[122,127],[132,137],[142,147],[11,18],[21,28],[31,38],[41,48],[51,58],[61,68],[71,78],[81,88],[91,98],[101,108],[111,118],[121,128],[131,138],[141,148]],id6:[[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148]],id7:[[11,18],[21,28],[31,38],[41,48],[51,58],[61,68],[71,78],[81,88],[91,98],[101,108],[111,118],[121,128],[131,138],[141,148],[12,17],[22,27],[32,37],[42,47],[52,57],[62,67],[72,77],[82,87],[92,97],[102,107],[112,117],[122,127],[132,137],[142,147],[13,16],[23,26],[33,36],[43,46],[53,56],[63,66],[73,76],[83,86],[93,96],[103,106],[113,116],[123,126],[133,136],[143,146],[14,15],[24,25],[34,35],[44,45],[54,55],[64,65],[74,75],[84,85],[94,95],[104,105],[114,115],[124,125],[134,135],[144,145]],id8:[[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88]]},t.zty="",t.first_unlock_zuiniu=!1,t.image={},t.atlas=null,t.music={},t.config=new r.game_config,t.level_data=null,t.map_data=null,t.in_game_time=0,t.first_zhiwan=!1,t.can_dingyue_wx=!1,t.appId="wx9310fb0610f7bd91",t.open_chaping=!1,t.open_banner=!1,t.read_server_data=!0,t.day_reward=!1,t.libao_mail=[],t.load_level=[],t.get_sdk_data=!0,t},e),t.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log(e)},t.prototype.load_level_bundle=function(e,t){var a,n;a=this,-1==this.load_level.indexOf(e)?(this.load_level.push(e),n=0,i.default.get().loadBundle("level_"+e,function(i){i.loadDir("texture",cc.SpriteFrame,function(e,i){n++;for(var o=0;o<i.length;o++)a.image[i[o].name]=i[o];2==n&&t&&t()}),i.loadDir("sound",cc.AudioClip,function(i,o){n++;for(var c=0;c<o.length;c++)a.music["level_"+e+"/"+o[c].name]=o[c];2==n&&t&&t()})})):t&&t()},t.prototype.get_skin=function(e){var t,a,i,n;void 0===e&&(e=!1);for(var o=[],r=0;r<c._p_data._data.theme_collect.length;r++){var s;if(s=!1,0==e&&(s=!0),1==s)for(var l=0;l<c._p_data._data.theme_collect[r].length;l++)0==c._p_data._data.theme_collect[r][l]&&o.push({theme:r,skin:l})}if(t=JSON.parse(JSON.stringify(o)),-1!=c._p_data._data.collectting_theme&&-1==this.limit_skin.indexOf(this.skin_name[c._p_data._data.collectting_theme]))for(r=0;r<t.length;r++)t[r].theme!=c._p_data._data.collectting_theme&&(t.splice(r,1),r--);for(t.length<1&&(t=o),i=999,r=0;r<t.length;r++)t[r].theme<i&&(i=t[r].theme);if(i<999)for(r=0;r<t.length;r++)t[r].theme!=i&&(t.splice(r,1),r--);if(t.length<1)for(r=0;r<c._p_data._data.theme_collect.length;r++){var d,_;if(_=this.limit_skin.indexOf(this.skin_name[r]),d=!1,1==e&&-1!=_||0==e&&-1==_&&(d=!0),1==d)for(l=0;l<c._p_data._data.theme_collect[r].length;l++)t.push({theme:r,skin:l})}for(n=t[Math.floor(Math.random()*t.length)],a=!0,r=0;r<this.skin_name.length;r++)if(-1==this.limit_skin.indexOf(this.skin_name[r])){for(l=0;l<c._p_data._data.theme_collect[r].length;l++)if(0==c._p_data._data.theme_collect[r][l]){a=!1;break}if(0==a)break}return 1==a&&(c._p_data._data.collectting_theme=0),n},t.prototype.get_skin_by_theme=function(e,t){void 0===t&&(t=1);for(var a=JSON.parse(JSON.stringify(c._p_data._data.theme_collect[e])),i=[],n=0;n<a.length&&(0==c._p_data._data.theme_collect[e][n]&&(c._p_data._data.theme_collect[e][n]=1,i.push({theme:e,skin:n}),t--),!(t<=0));n++);for(n=0;n<t;n++){var o;o=Math.floor(Math.random()*c._p_data._data.theme_collect[e].length),i.push({theme:e,skin:o})}return i},t}(n.default),a.default=o,cc._RF.pop()},{BundleMager:"BundleMager",PlayerDataConfig:"PlayerDataConfig",PlayerDataMager:"PlayerDataMager",Res:"Res",SingleBase:"SingleBase",UI:"UI"}],Res:[function(e,t,a){"use strict";cc._RF.push(t,"17353NIxmhHCKAqf4qMVo28","Res"),Object.defineProperty(a,"__esModule",{value:!0}),a.bundlesName=a.bundlesNameLength=a.Texture=a.Sound=a.Atlas=a.Prefab=void 0,a.Prefab={loading:"component/loading",setting:"layer/common/setting",game_scene:"scene/game_scene",main_scene:"scene/main_scene",give_up_ui:"layer/give_up_ui",skin_ui:"layer/skin_ui",win_ui:"layer/win_ui",get_item_ui:"layer/get_item_ui",unline_tip_ui:"layer/unline_tip_ui",get_star_tip_ui:"layer/get_star_tip_ui"},a.Atlas={},a.Sound={btn_0:"effect/btn_0",fail:"effect/fail"},a.Texture={},a.bundlesNameLength=4,a.bundlesName={sound:"sound",common:"common",res:"res",prefab:"prefab"},cc._RF.pop()},{}],Setting:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_,u;cc._RF.push(t,"42214gg9GVOroqJhQ9BxLnW","Setting"),u=__extends,_=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),r=e("Config"),o=e("PlayerDataMager"),d=e("ViewBase"),s=e("GameScene"),n=cc._decorator,l=n.ccclass,c=n.property,i=function(e){var t;return u(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).musicSwitchClose=void 0,t.effectSwitchClose=void 0,t.vibrateSwitchClose=void 0,t.touch_number=0,t.zanting=!1,t},e),t.prototype.onLoad=function(){this.updateView(),this.scale_tween()},t.prototype.onBtnExit=function(){r.cSound.playEffect(r.cRes.Sound.btn_0),r.cUI.removeLayer(this.node),o._p_data.saveData()},t.prototype.onBtnMusicSwitch=function(){r.cSound.playEffect(r.cRes.Sound.btn_0),r.cSound.toggleMusic(),this.updateView(),o._p_data._data.musicSwitch=r.cSound.music_switch?1:0},t.prototype.onBtnEffectSwitch=function(){r.cSound.playEffect(r.cRes.Sound.btn_0),r.cSound.toggleEffect(),this.updateView(),o._p_data._data.effectSwitch=r.cSound.effect_switch?1:0,0==o._p_data._data.effectSwitch?cc.audioEngine.setEffectsVolume(0):cc.audioEngine.setEffectsVolume(1)},t.prototype.onBtnVibrateSwitch=function(){r.cSound.playEffect(r.cRes.Sound.btn_0),o._p_data._data.vibrateSwitch=0==o._p_data._data.vibrateSwitch?1:0,this.updateView()},t.prototype.updateView=function(){this.musicSwitchClose.active=!r.cSound.music_switch,this.effectSwitchClose.active=!r.cSound.effect_switch,this.vibrateSwitchClose.active=1!=o._p_data._data.vibrateSwitch},t.prototype.copyOpenId=function(){this.onCopy(o._p_data._data.openId)},t.prototype.onCopy=function(e){console.log("-------------str:",e),this.webCopyString(e)},t.prototype.webCopyString=function(e){var t,a,i,n,o;o=e,(n=document.createElement("textarea")).value=o,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt",(t=getSelection()).rangeCount>0&&(i=t.getRangeAt(0)),document.body.appendChild(n),n.select(),n.selectionStart=0,n.selectionEnd=o.length,a=!1;try{a=document.execCommand("copy")}catch(e){}return document.body.removeChild(n),i&&(t.removeAllRanges(),t.addRange(i)),a},t.prototype.on_give_up=function(){this.btn0(),r.cUI.addLayer(r.cRes.Prefab.give_up_ui),r.cUI.removeLayer(r.cRes.Prefab.setting)},t.prototype.on_again=function(){this.btn0(),s.gameScene.init(),r.cUI.removeLayer(this.node)},t.prototype.on_duihuan=function(){this.btn0(),r.cUI.addLayer(r.cRes.Prefab.duihuan_ui),r.cUI.removeLayer(this.node)},_([c(cc.Node)],t.prototype,"musicSwitchClose",void 0),_([c(cc.Node)],t.prototype,"effectSwitchClose",void 0),_([c(cc.Node)],t.prototype,"vibrateSwitchClose",void 0),_([l],t)}(d.default),a.default=i,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],SingleBase:[function(e,t,a){"use strict";var i;cc._RF.push(t,"747187+MExBEoJ0xS4+BA1G","SingleBase"),Object.defineProperty(a,"__esModule",{value:!0}),i=function(){var e;return(e=function(){}).get=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.timer=function(){return new Promise(function(e,t){e(t)})},e}(),a.default=i,cc._RF.pop()},{}],Sound:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_,u;cc._RF.push(t,"7052dXb+IVIOr/i1QKyYDGo","Sound"),u=__extends,s=__decorate,c=__awaiter,o=__generator,Object.defineProperty(a,"__esModule",{value:!0}),n=e("SingleBase"),i=e("PublicMager"),d=e("UI"),l=cc._decorator,r=l.ccclass,l.property,_=function(e){var t;return u(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).music_switch=!0,t.effect_switch=!0,t.music_volume=1,t.effect_volume=1,t.effect_list=new Map,t.effect_cd_list=new Map,t.audio_id=0,t._isPause=!1,t},e),t.prototype.toggleMusic=function(){this.music_switch=!this.music_switch,this.music_switch?cc.audioEngine.resumeMusic():cc.audioEngine.pauseMusic()},t.prototype.toggleEffect=function(){this.effect_switch=!this.effect_switch},t.prototype.isPlaying=function(e){return cc.audioEngine.getState(e)===cc.audioEngine.AudioState.PLAYING},t.prototype.playEffect=function(e,t){return void 0===t&&(t=!1),c(this,void 0,void 0,function(){var t,a;return o(this,function(n){switch(n.label){case 0:return!e||!this.effect_switch||this.effect_volume<=0?[2]:this.effect_list.has(e)&&1==this.effect_list.get(e)?[2]:(t=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)];case 1:t=n.sent(),n.label=2;case 2:return a=cc.audioEngine.playEffect(t,!1),this.audio_id=a,this.effect_cd_list.set(e,1),[2]}})})},t.prototype.startCd=function(e){var t;t=this,setTimeout(function(){t.effect_cd_list.set(e,0)},.3)},t.prototype.playLoopEffect=function(e){return c(this,void 0,void 0,function(){var t,a;return o(this,function(n){switch(n.label){case 0:return!e||!this.effect_switch||this.effect_volume<=0?[2]:this.effect_list.has(e)?[2]:(t=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)];case 1:t=n.sent(),n.label=2;case 2:return a=cc.audioEngine.playEffect(t,!0),this.effect_list.set(e,a),[2]}})})},t.prototype.stopLoopEffect=function(e){return c(this,void 0,void 0,function(){var t;return o(this,function(){return this.effect_list.has(e)&&(t=this.effect_list.get(e),this.effect_list.delete(e),cc.audioEngine.stopEffect(t)),[2]})})},t.prototype.stopAllEffect=function(){cc.audioEngine.stopAllEffects()},t.prototype.playMusic=function(e,t){return void 0===t&&(t=this.music_volume),c(this,void 0,void 0,function(){var a;return o(this,function(n){switch(n.label){case 0:return!this.music_switch||e===this.now_music||this.music_volume<=0?(e===this.now_music&&this.resumeMusic(),[2]):(cc.audioEngine.stopMusic(),this.now_music=e,(a=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)]);case 1:a=n.sent(),n.label=2;case 2:return this.setMusicVolume(t),cc.audioEngine.playMusic(a,!0),[2]}})})},t.prototype.setMusicVolume=function(e){this.music_volume=e,cc.audioEngine.setMusicVolume(e)},t.prototype.setEffectVolume=function(e){this.effect_volume=e,cc.audioEngine.setEffectsVolume(e)},t.prototype.isMusicPlaying=function(){cc.audioEngine.isMusicPlaying()},t.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},t.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},t.prototype.stopMusic=function(){cc.audioEngine.stopMusic(),this.now_music=null},t.prototype.getMusiclength=function(){return Number(cc.audioEngine.getDuration(this.audio_id).toFixed(1))},s([r],t)}(n.default),a.default=_,cc._RF.pop()},{PublicMager:"PublicMager",SingleBase:"SingleBase",UI:"UI"}],StorageManager:[function(e,t,a){"use strict";cc._RF.push(t,"c610adah+5A7ZmAIXIC67YF","StorageManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.Storage=void 0,function(e){var t;t=function(e){null!=e?(e=e+"_"+a,console.log("a",e),cc.sys.localStorage.removeItem(e)):console.error("key is null")};var a=102500;e.init=function(){},e.serUser=function(e){a=e},e.set=function(e,i){if(null!=(e=e+"_"+a)){if(null==i)return console.warn("value is null"),void t(e);if("function"!=typeof i){if("object"==typeof i)try{i=JSON.stringify(i)}catch(e){return void console.error("json error str = "+i)}else"number"==typeof i&&(i+="");cc.sys.localStorage.setItem(e,i)}else console.error("the value is function")}else console.error("the key is null")},e.get=function(e,t){if(null!=e){var i;if(e=e+"_"+a,i=cc.sys.localStorage.getItem(e),null==t||"string"==typeof t)return i;if(null===i)return t;if("number"==typeof t)return Number(i)||0;if("boolean"==typeof t)return"true"==i;if("object"==typeof t)try{return JSON.parse(i)}catch(e){return console.error("json error,str="+i),t}return i}console.error("the key is null")},e.remove=t}(a.Storage||(a.Storage={})),cc._RF.pop()},{}],TipItem2:[function(e,t,a){"use strict";var i,n,o,c,r,s,l;cc._RF.push(t,"1d8f9XfNHpCP6m7L2BSvvCA","TipItem2"),l=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Pool"),c=cc._decorator,o=c.ccclass,s=c.property,r=function(e){var t;return l(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).icon=null,t.icon_spf=[],t._time=0,t._timeFlag=0,t},e),t.prototype.initText=function(e){var t;t=this,this.icon.spriteFrame=this.icon_spf[e],this.node.y=20,this.node.opacity=255,cc.tween(this.node).delay(2).to(1,{y:250,opacity:0},{easing:"sineIn"}).call(function(){i.default.get().put(t.node)}).start()},n([s({type:cc.Sprite})],t.prototype,"icon",void 0),n([s({type:cc.SpriteFrame})],t.prototype,"icon_spf",void 0),n([o],t)}(cc.Component),a.default=r,cc._RF.pop()},{Pool:"Pool"}],TipItem:[function(e,t,a){"use strict";var i,n,o,c,r,s,l;cc._RF.push(t,"1c6b2nJmdVA5YoK7mE0j9d5","TipItem"),n=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=e("Pool"),r=cc._decorator,c=r.ccclass,l=r.property,o=function(e){var t;return n(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).label=null,t.widget=null,t.layout=null,t._time=0,t._timeFlag=0,t},e),t.prototype.initText=function(e){var t;t=this,this.label.string=e,this.node.y=20,this.node.opacity=255,this.node.scale=0,cc.tween(this.node).to(.5,{scale:1},{easing:"backOut"}).delay(1).to(.2,{scale:0},{easing:"backIn"}).call(function(){s.default.get().put(t.node)}).start()},t.prototype.update=function(){this.widget.width=this.layout.width,this.layout.height>120?(this.widget.height=this.layout.height,this.layout.getComponent(cc.Layout).type=cc.Layout.Type.VERTICAL):this.widget.height=120},i([l(cc.Label)],t.prototype,"label",void 0),i([l({type:cc.Node})],t.prototype,"widget",void 0),i([l({type:cc.Node})],t.prototype,"layout",void 0),i([c],t)}(cc.Component),a.default=o,cc._RF.pop()},{Pool:"Pool"}],UITools:[function(e,t,a){"use strict";var i;cc._RF.push(t,"6c6a06GxR9LaYV1jtdZjLpr","UITools"),Object.defineProperty(a,"__esModule",{value:!0}),a.node=void 0,i=function(){var e;return(e=function(){}).alignFullScreen=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.left=0,a.right=0,a.bottom=0,a.top=0,a.isAlignTop=!0,a.isAlignBottom=!0,a.isAlignLeft=!0,a.isAlignRight=!0},e.alignCenter=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.isAlignHorizontalCenter=!0,a.isAlignVerticalCenter=!0,a.horizontalCenter=0,a.verticalCenter=0},e.alignLeft=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.left=0,a.isAlignLeft=!0},e.alignRight=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.right=0,a.isAlignRight=!0},e.alignTop=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.top=0,a.isAlignTop=!0},e.alignBottom=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.bottom=0,a.isAlignBottom=!0},e.easingScale=function(e){var t;t=e.scale,e.scale=0,e.stopAllActions(),cc.tween(e).to(.1,{scale:t+.15}).to(.2,{scale:t}).start()},e.easingFall=function(e){var t;t=e.y,e.y=cc.winSize.height,e.x=0,e.stopAllActions(),cc.tween(e).by(.3,{position:cc.v2(0,-cc.winSize.height-20+t)},{easing:cc.Tween.expoOut}).by(.2,{position:cc.v2(0,20)}).start()},e.easingFade=function(e){e.opacity=0,e.stopAllActions(),cc.tween(e).to(.1,{opacity:150},{easing:cc.Tween.sineIn}).to(.1,{opacity:255},{easing:cc.Tween.sineOut}).start()},e.removeAllNode=function(e){for(;e[0];)e[0].destroy(),e.shift()},e.easingRise=function(e){var t;t=e.y,e.y=-cc.winSize.height,e.x=0,e.stopAllActions(),cc.tween(e).by(.3,{position:cc.v2(0,cc.winSize.height+20+t)},{easing:cc.Tween.expoOut}).by(.2,{position:cc.v2(0,-20)}).start()},e.runBreathingAction=function(e){var t;e.stopAllActions(),t=e.scale,cc.tween(e).to(.5,{scale:t+.1}).to(.5,{scale:t}).union().repeatForever().start()},e.runBounceAction=function(e){var t,a;e.stopAllActions(),a=e.scaleX,t=e.scaleY,cc.tween(e).to(.15,{scaleX:.5*a,scaleY:1.2*t},{easing:"bounceInOut"}).to(.15,{scaleX:1.3*a,scaleY:.8*t},{easing:"bounceInOut"}).to(.2,{scaleX:.9*a,scaleY:t},{easing:"smooth"}).delay(.7).union().repeatForever().start()},e.shakeScreen=function(e){e.is_tween||(e.is_tween=!0,cc.tween(e).by(.1,{y:5,x:5}).by(.1,{y:-5,x:-5}).delay(1).call(function(){e.is_tween=!1}).union().start())},e.hurtColor=function(e){cc.tween(e).to(.5,{color:cc.color(255,0,0)}).to(.5,{color:cc.color(255,255,255)}).start()},e}(),a.default=i,a.node=function(){throw new Error("Function not implemented.")},cc._RF.pop()},{}],UI:[function(e,t,a){"use strict";var i,n,o,c,r,s,l;cc._RF.push(t,"499f991TGBGnYyP9DmkKhza","UI"),o=__extends,i=__awaiter,n=__generator,l=__values,Object.defineProperty(a,"__esModule",{value:!0}),r=e("SingleBase"),s=e("BundleMager"),c=function(e){var t;return o(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).layer_list=[],t.is_loading=!1,t.res={},t.tip_bool=!1,t},e),t.prototype.getCanvas=function(){return cc.find("Canvas")},t.prototype.getCurrentScene=function(){return this.getGameSceneRoot().children[0]},t.prototype.getGameSceneRoot=function(){return cc.find("Canvas/game_scene")},t.prototype.getGameLayerRoot=function(){return cc.find("Canvas/game_layer")},t.prototype.getGameLoadingRoot=function(){return cc.find("Canvas/game_loading")},t.prototype.getPrevSceneUrl=function(){return this.prev_scene_url},t.prototype.hasLayerItem=function(){return this.layer_list.length>0},t.prototype.showTips=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=2),i(this,void 0,void 0,function(){var a,i,o,c;return i=this,n(this,function(n){switch(n.label){case 0:return e?1==this.tip_bool?[2]:(this.tip_bool=!0,setTimeout(function(){i.tip_bool=!1},2e3),o=(a=cc).instantiate,[4,s.default.get().get_bundle_prefab("prefab","component/tipItem")]):[2];case 1:return(c=o.apply(a,[n.sent()])).parent=cc.find("Canvas"),c.getComponent("TipItem").initText(e,t),[2]}})})},t.prototype.showTips2=function(e){this.createNode("component/tipItem2").then(function(t){t.parent=cc.find("Canvas"),t.getComponent("TipItem2").initText(e)})},t.prototype.hideAllTips=function(){},t.prototype.getPrefab=function(e){return i(this,void 0,Promise,function(){return n(this,function(){return[2,new Promise(function(t){cc.resources.load(e,cc.Prefab,function(a,i){a?console.error(e+" not exist"):t(i)})})]})})},t.prototype.getPrefabSync=function(e){var t;if(t=cc.resources.get(e,cc.Prefab))return t},t.prototype.getAtlas=function(e){return new Promise(function(t){cc.resources.load(e,cc.SpriteAtlas,function(a,i){a?console.error(e+" not exist"):t(i)})})},t.prototype.getAtlasSync=function(e){var t;if(t=cc.resources.get(e,cc.SpriteAtlas))return t;console.error(e+"load failed")},t.prototype.getTextureSync=function(e){var t;if(t=cc.resources.get(e,cc.SpriteFrame))return t;console.error(e+"load failed")},t.prototype.addTexture=function(e){cc.resources.load(e,cc.SpriteFrame)},t.prototype.getTexture=function(e){return new Promise(function(t){cc.resources.load(e,cc.SpriteFrame,function(a,i){a?console.error(e+" not exist"):t(i)})})},t.prototype.createNodeSync=function(e){var t;if(t=this.getPrefabSync(e))return cc.instantiate(t);console.error(e+"load failed")},t.prototype.createNode=function(e){return i(this,void 0,Promise,function(){return n(this,function(){return[2,new Promise(function(t){cc.resources.load(e,cc.Prefab,function(a,i){var n;a?console.error(e+" not exist"):((n=cc.instantiate(i)).name=i.name,n.url_name=e,n.show(),t(n))})})]})})},t.prototype.addLayer=function(e,t){return void 0===t&&(t=!0),i(this,void 0,Promise,function(){var a,i,o,c,r,d,_,u;return i=this,n(this,function(n){switch(n.label){case 0:try{for(_=l(this.layer_list),u=_.next();!u.done;u=_.next())if(u.value.url===e)return[2]}catch(p){o={error:p}}finally{try{u&&!u.done&&(r=_.return)&&r.call(_)}finally{if(o)throw o.error}}return t&&this.is_loading?[2]:(this.is_loading=!0,a=(d=cc).instantiate,[4,s.default.get().get_bundle_prefab("prefab",e)]);case 1:return(c=a.apply(d,[n.sent()])).parent=this.getGameLayerRoot(),c.url_name=e,this.layer_list.push(c),setTimeout(function(){i.is_loading=!1},100),[2,c]}})})},t.prototype.add_layer_bundle=function(e,t,a){return void 0===a&&(a=!0),i(this,void 0,Promise,function(){var o,c,r,d,_,u,p,h;return u=this,n(this,function(f){switch(f.label){case 0:try{for(p=l(this.layer_list),c=p.next();!c.done;c=p.next())if((r=c.value).url===t)return[2]}catch(e){h={error:e}}finally{try{c&&!c.done&&(o=p.return)&&o.call(p)}finally{if(h)throw h.error}}return a&&this.is_loading?[2]:(this.is_loading=!0,s.default.get().find_bundle(e)?[3,2]:[4,s.default.get().loadBundle(e,function(){return i(u,void 0,void 0,function(){var a,i,o,c;return a=this,n(this,function(n){switch(n.label){case 0:return o=(i=cc).instantiate,[4,s.default.get().get_bundle_prefab(e,"prefab/"+t)];case 1:return(c=o.apply(i,[n.sent()])).parent=this.getGameLayerRoot(),c.url_name=t,this.layer_list.push(c),setTimeout(function(){a.is_loading=!1},100),[2,c]}})})})]);case 1:return f.sent(),[3,4];case 2:return _=(d=cc).instantiate,[4,s.default.get().get_bundle_prefab(e,"prefab/"+t)];case 3:return(r=_.apply(d,[f.sent()])).parent=this.getGameLayerRoot(),r.url_name=t,this.layer_list.push(r),setTimeout(function(){u.is_loading=!1},100),[2,r];case 4:return[2]}})})},t.prototype.removeLayer=function(e){for(var t=0;t<this.layer_list.length;t++){var a;if((a=this.layer_list[t]).url_name===e||a===e){a.destroy(),this.layer_list.splice(t,1);break}}},t.prototype.removeAllLayer=function(){this.layer_list.forEach(function(e){return e.destroy()}),this.layer_list=[]},t.prototype.loadScene=function(e){return i(this,void 0,Promise,function(){var t,a;return a=this,n(this,function(){return(t=this.getGameLoadingRoot().$("loading")).show(),t.$("percent").setLabel("0%"),[2,new Promise(function(i){var n,o,c;a.res[e]?(o=[5,18,25,29,40,45,60,80,90,100,100],n=0,c=setInterval(function(){n++,t.$("percent").setLabel(o[n]+"%"),n>10&&(clearInterval(c),t.hide(),a.addScene(e),i(!0))},50)):a.loadResDir("./atlas",t.$("percent")).then(function(){a.res[e]=!0,t.hide(),a.addScene(e),i(!0)})})]})})},t.prototype.reloadScene=function(e){this.removeScene(e),this.addScene(e)},t.prototype.removeScene=function(e){this.scene&&this.scene.url_name===e&&(this.scene.destroy(),this.scene=null)},t.prototype.addScene=function(e){return i(this,void 0,Promise,function(){var t,a,i,o;return o=this,n(this,function(n){switch(n.label){case 0:return this.scene&&this.scene.url_name===e?[2]:this.is_loading?[2]:(this.is_loading=!0,a=(t=cc).instantiate,[4,s.default.get().get_bundle_prefab("prefab",e)]);case 1:return(i=a.apply(t,[n.sent()])).parent=this.getGameSceneRoot(),this.scene&&(this.prev_scene_url=this.scene.url_name,this.scene.destroy(),this.scene=null),this.scene=i,setTimeout(function(){o.is_loading=!1},100),[2,i]}})})},t.prototype.loadResDir=function(e,t){return console.time(e),new Promise(function(a){var i;i=0,cc.resources.loadDir(e,function(e,a){var n;(n=(e/a).toFixed(2).toNumber())>i&&(i=n,t instanceof cc.ProgressBar?t.progress=n:t instanceof cc.Node&&t.setLabel((100*n).toFixed(0)+"%"))},function(t,i){t||0===i.length?console.error(e+" not exist"):a(i),console.timeEnd(e)})})},t.prototype.loadResArray=function(e,t){return console.time(e.toString()),new Promise(function(a){var i;i=0,cc.resources.load(e,function(e,a){var n;(n=(e/a).toFixed(2).toNumber())>i&&(i=n,t instanceof cc.ProgressBar?t.progress=n:t.setLabel((100*n).toFixed(0)+"%"))},function(){a(!0),console.timeEnd(e.toString())})})},t.prototype.loadRes=function(e,t){return new Promise(function(a){cc.resources.load(e,t,function(t,i){t?console.error(e+" not exist"):a(i)})})},t.prototype.loadSound=function(e){return new Promise(function(t){cc.assetManager.getBundle("sound").load(e,cc.AudioClip,function(a,i){a?console.error(e+" not exist"):t(i)})})},t.prototype.loadScene_bundle=function(e,t,a,i){var n;n=this,void 0===i&&(i=!1),t||(t=e),s.default.get().loadBundle(e,function(){s.default.get().get_bundle_prefab(e,t).then(function(e){var i,o;n.scene&&(n.prev_scene_url=n.scene.url_name),o=cc.instantiate(e),n.scene=o,n.scene.url_name=t,(i=n.getGameSceneRoot()).destroyAllChildren(),o.parent=i,a&&a(o)})},i)},t.prototype.getSkeleton=function(e){return new Promise(function(t){cc.resources.load(e,sp.SkeletonData,function(a,i){a?console.error(e+" not exist"):t(i)})})},t.prototype.play_sp_animation=function(e,t,a,i,n){void 0===a&&(a=!0),e.clearTracks(),e.setToSetupPose(),e.timeScale=1,e.setAnimation(0,t,a),a||(n&&e.setEventListener(function(){n()}),e.setTrackCompleteListener(e.getCurrent(0),function(){i&&i()}))},t}(r.default),a.default=c,cc._RF.pop()},{BundleMager:"BundleMager",SingleBase:"SingleBase"}],Utils:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"f6011eAZjBE87YxjlyTuaC7","Utils"),i=__read,Object.defineProperty(a,"__esModule",{value:!0}),n=function(){var e;return(e=function(){}).parseUrl=function(){var e,t,a;if(e={},null==window.location)return e;for(var i=window.location.href,n=i.indexOf("?"),o=(i=i.substr(n+1)).split("&"),c=0;c<o.length;c++)(n=o[c].indexOf("="))>0&&(t=o[c].substring(0,n),a=o[c].substr(n+1),e[t]=a);return e},e.strToBuffer=function(e){var t;t=function(e){var t,a,i,n;return a=e.toString(2),e<128?e.toString(16):e<2048?(a=("00000000000000000"+a).slice(-11),i=parseInt("110"+a.substring(0,5),2),n=parseInt("10"+a.substring(5),2),i.toString(16)+","+n.toString(16)):(a=("00000000000000000"+a).slice(-16),i=parseInt("1110"+a.substring(0,4),2),n=parseInt("10"+a.substring(4,10),2),t=parseInt("10"+a.substring(10),2),i.toString(16)+","+n.toString(16)+","+t.toString(16))};for(var a="",i=0;i<e.length;i++)a+=","+t(e.charCodeAt(i));return a+=",00",new Uint8Array(a.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)})).buffer},e.code2utf8=function(e){var t,a,i,n;return t=e.toString(2),e<128?e.toString(16):e<2048?(t=("00000000000000000"+t).slice(-11),n=parseInt("110"+t.substring(0,5),2),i=parseInt("10"+t.substring(5),2),n.toString(16)+","+i.toString(16)):(t=("00000000000000000"+t).slice(-16),n=parseInt("1110"+t.substring(0,4),2),i=parseInt("10"+t.substring(4,10),2),a=parseInt("10"+t.substring(10),2),n.toString(16)+","+i.toString(16)+","+a.toString(16))},e.numberFormat=function(e,t){var a;return(a=e.toString().length-t)<0?[].init(-a,0).join("")+e:e.toString()},e.removeFrontNum0=function(e){return e.replace(/\b(0+)/gi,"")},e.getRepeatCount=function(e,t){var a,i;for(var n in a={},e.forEach(function(e){a[e]?a[e]++:a[e]=1}),i=[],a)a[n]>=t&&i.push(+n);return i},e.regUserName=function(e,t){void 0===t&&(t=7);for(var a=/^[\u4e00-\u9fa5]$|^[\dA-Za-z]$/,i=e.split(""),n=3*t,o=0;o<i.length;o++){if(!a.test(i[o]))return!1;if((n-=3===this.getUtf8Length(i[o])?3:1.5)<0)return!1}return!0},e.getShuffle=function(e){for(var t,a=0;a<e.length;a++){var n;n=Math.floor(Math.random()*e.length),t=i([e[a],e[n]],2),e[n]=t[0],e[a]=t[1]}return e},e.getNumToArray=function(e){return e[Math.floor(Math.random()*e.length)]},e.getNumMinToMax=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.getRandomDir=function(){return Math.random()>.5?1:-1},e.weightsRadom=function(e){var t;t=0,e.forEach(function(e){t+=e});for(var a=Math.random()*t,i=0,n=0;n<e.length;n++)if(a<(i+=e[n]))return n},e.getProbability=function(e,t){void 0===t&&(t=2);for(var a=+Math.random().toFixed(t),i=0,n=0;n<e.length;n++)if((i+=e[n])>=a)return n},e.getDate=function(e){var t,a,i,n,o,c;return t=(c=new Date(e)).getFullYear(),o=c.getMonth()+1,n=c.getDate(),a=c.getHours(),i=c.getMinutes(),c.getSeconds(),t+"/"+this.numberFormat(o,2)+"/"+this.numberFormat(n,2)+" "+this.numberFormat(a,2)+":"+this.numberFormat(i,2)},e.getShowDate=function(t){var a,i,n,o,c;return i=new Date(t),a=e.numberFormat(i.getHours(),2),n=e.numberFormat(i.getMinutes(),2),c=e.numberFormat(i.getMonth()+1,2),o=e.numberFormat(i.getDate(),2),Date.now()-t<864e5?"Today "+a+":"+n:Date.now()-t<1728e5?"Yesterday "+a+":"+n:Date.now()-t<2592e5?"Three days "+a+":"+n:c+"-"+o+" "+a+":"+n},e.getTimeRange=function(t,a){var i;return i=new Date(a-t),e.numberFormat(i.getMinutes(),2)+":"+e.numberFormat(i.getSeconds(),2)},e.formatMinSeconds=function(t){var a,i;return a=Math.floor(t/60),i=Math.floor(t%60),e.numberFormat(a,2)+":"+e.numberFormat(i,2)},e.getNum=function(e){return+e.replace(/[^\d]/gi,"")},e.getArrToNum=function(e,t){var a,i,n,o;for(a=[],o=Math.sign(e),e=Math.abs(e);t>1;)n=e/t*2,i=(i=Math.random()*n)<1?1:i,i=Math.round(i),a.push(i*o),t--,e-=i;return a.push(Math.round(e)*o),a},e.getRandomNumToStr=function(t){var a,i,n,o,c;return o=t.indexOf("["),i=t.indexOf("]"),o<0||i<0?{n:0,str:t}:(n=(a=t.slice(o+1,i)).split("-").map(function(e){return+e}),{n:c=e.getNumMinToMax(n[0],n[1]),str:t.replace(a,c.toString())})},e.getDisTwoPos=function(e,t){var a,i;return i=e.x-t.x,a=e.y-t.y,Math.sqrt(i*i+a*a)},e.getDateSeconds=function(e){return void 0===e&&(e=1),(new Date).getTime()%e},e.judgeTwoPosInDis=function(e,t,a){return this.getDisTwoPos(e,t)<=Math.pow(a,2)},e.number_conversion=function(e,t){var a,i,n,o,c,r,s,l;if(void 0===t&&(t=!1),l=["","k","m","b","t"],c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],i=(r=Math.floor(e)+"").length,s=Math.floor((i-1)/3),r.indexOf("e+")>-1&&(s=Number(r.split("+")[1]),s=Math.floor(s/3)),o="",s<l.length)o=l[s];else if(s<c.length+l.length)o=c[s-5];else{var d,_;s-=5,_=Math.floor(s/c.length),o=d=c[s%=c.length];for(var u=0;u<_;u++)o+=d}if(n="",(a=e)>=1e3){for(;a>=1e6;)a/=1e3;n=Math.floor(a/10)/100+o}else n=t?Math.floor(100*a)/100+o:Math.round(a)+o;return n},e.getRandomArrayElements=function(e,t){for(var a,i,n=e.slice(0),o=e.length,c=o-t;o-- >c;)a=n[i=Math.floor((o+1)*Math.random())],n[i]=n[o],n[o]=a;return n.slice(c)},e.getAngle=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},e.angle_to_radian=function(e){return Math.PI/180*e},e.angle_to_vector=function(e){var t,a,i;return a=this.angle_to_radian(e),i=Math.cos(a),t=Math.sin(a),new cc.Vec2(i,t).normalize()},e.radian_to_angle=function(e){return 180/Math.PI*e},e.vector_to_angle=function(e){var t;return t=e.signAngle(new cc.Vec2(1,0)),-this.radian_to_angle(t)},e.time_stamp_to_time=function(e){var t;return{year:(t=new Date(e)).getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}},e.getUtf8Length=function(e){for(var t=0,a=0;a<e.length;a++){var i;(i=e.charCodeAt(a))<127?t++:128<=i&&i<=2047?t+=2:2048<=i&&i<=65535&&(t+=3)}return t},e}(),a.default=n,cc._RF.pop()},{}],ViewBase:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_,u,p,h,f;cc._RF.push(t,"392f2NnVKpMmqRDZqreFKQK","ViewBase"),i=__extends,l=__decorate,u=__awaiter,p=__generator,Object.defineProperty(a,"__esModule",{value:!0}),f=e("UITools"),h=e("Config"),function(e){e[e.on=0]="on",e[e.off=1]="off"}(r||(r={})),function(e){e[e.none=0]="none",e[e.center=1]="center",e[e.full=2]="full",e[e.left=3]="left",e[e.right=4]="right",e[e.top=5]="top",e[e.bottom=6]="bottom"}(o||(o={})),function(e){e[e.none=0]="none",e[e.easingScale=1]="easingScale",e[e.easingFade=2]="easingFade",e[e.easingFall=3]="easingFall",e[e.easingRise=4]="easingRise",e[e.random=5]="random"}(d||(d={})),_=cc._decorator,c=_.ccclass,s=_.property,n=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).blockInputEvent=r.off,t.alignMode=o.none,t.showMode=d.none,t},e),t.prototype.onEnable=function(){},t.prototype.onDisable=function(){},t.prototype.onDestroy=function(){},t.prototype.initEvents=function(){},t.prototype.onConnectSuccess=function(){},t.prototype.close=function(){},t.prototype.loadConfig=function(){this.addBlockInput(),this.addAlignMode(),this.addShowMode()},t.prototype.addBlockInput=function(){this.blockInputEvent===r.on&&this.node.findComponent(cc.BlockInputEvents)},t.prototype.addAlignMode=function(){var e;switch(e=cc.Widget.AlignMode.ON_WINDOW_RESIZE,this.alignMode){case o.none:break;case o.center:f.default.alignCenter(this.node,e);break;case o.full:f.default.alignFullScreen(this.node,e);break;case o.left:f.default.alignLeft(this.node,e);break;case o.right:f.default.alignRight(this.node,e);break;case o.top:f.default.alignTop(this.node,e);break;case o.bottom:f.default.alignBottom(this.node,e)}},t.prototype.addShowMode=function(){var e;if(e=this.node.$("bg")||this.node.$("_bg"))switch(this.showMode){case d.none:case d.random:break;case d.easingFade:f.default.easingFade(e);break;case d.easingFall:f.default.easingFall(e);break;case d.easingRise:f.default.easingRise(e);break;case d.easingScale:f.default.easingScale(e)}},t.prototype.timer=function(e){return u(this,void 0,Promise,function(){var t;return t=this,p(this,function(){return[2,new Promise(function(a){t.scheduleOnce(function(){a(!0)},e)})]})})},t.prototype.btn0=function(){h.cSound.playEffect(h.cRes.Sound.btn_0)},t.prototype.scale_tween=function(e,t){e||(e=this.node.getChildByName("node")),e&&(e.scale=0,cc.tween(e).to(.5,{scale:1},{easing:"backOut"}).call(function(){t&&t()}).start())},l([s({type:cc.Enum(r)})],t.prototype,"blockInputEvent",void 0),l([s({type:cc.Enum(o)})],t.prototype,"alignMode",void 0),l([s({type:cc.Enum(d)})],t.prototype,"showMode",void 0),l([c],t)}(cc.Component),a.default=n,cc._RF.pop()},{Config:"Config",UITools:"UITools"}],ViewSet:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d;cc._RF.push(t,"46875iEMQtJx67TH80EDx9I","ViewSet"),i=__extends,Object.defineProperty(a,"__esModule",{value:!0}),a.MainSceneView=a.GameSceneView=a.PauseView=a.NoticeView=a.TipsItemView=a.LoadingView=void 0,c=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig()},t}((r=e("ViewBase")).default),a.LoadingView=c,l=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._content=this.node.$("tips_bg/_content"),this._bgNode=this.node.$("_bgNode")},t}(r.default),a.TipsItemView=l,s=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._bg=this.node.$("_bg"),this._btn_close=this.node.$("_bg/_btn_close"),this._btn_close.click(this.onBtnClose.bind(this))},t}(r.default),a.NoticeView=s,o=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._btn_continue=this.node.$("bg/_btn_continue"),this._btn_continue.click(this.onBtnContinue.bind(this)),this._btn_exit=this.node.$("bg/_btn_exit"),this._btn_exit.click(this.onBtnExit.bind(this))},t}(r.default),a.PauseView=o,d=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig()},t}(r.default),a.GameSceneView=d,n=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._btn_start_game=this.node.$("_btn_start_game")},t}(r.default),a.MainSceneView=n,cc._RF.pop()},{ViewBase:"ViewBase"}],bao_zhu:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d;cc._RF.push(t,"06214nFTwNLmpKsKwiRMN4R","bao_zhu"),d=__extends,r=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=e("Config"),o=e("GameScene"),n=cc._decorator,l=n.ccclass,i=n.property,c=function(e){var t;return d(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).spine=null,t._fa_she_ing=!1,t.gaibian=!1,t.target=null,t._oldPos=cc.v2(),t},e),t.prototype.start=function(){},t.prototype.init=function(){this.node.getChildByName("tui_dong").active=!1,this._fa_she_ing=!1,this.node.scale=1,this.node.position=cc.v2(0,0),s.cUI.play_sp_animation(this.spine,"idle",!0)},t.prototype.fa_she=function(e,t,a){var i,n,o;n=this,this.target=a,this.node.getChildByName("tui_dong").active=!0,this._fa_she_ing=!0,this.node.scale=.3,s.cUI.play_sp_animation(this.spine,"yan_hua",!0),(i=(i=this.node.position.add(e)).mul(.5)).x<e.x?i.x-=400:i.x+=400,i.y<e.y?i.y-=200:i.y+=200,o=.5*Math.random(),cc.tween(this.node).bezierTo(.7+o,this.node.position,i,e).call(function(){n.node.getChildByName("tui_dong").active=!1,n.node.angle=0,s.cNodePool.put(n.node),t&&t()}).start()},t.prototype.update=function(){var e;if(this._fa_she_ing&&(e=180*Math.atan2(this.node.y-this._oldPos.y,this.node.x-this._oldPos.x)/Math.PI,this.node.angle=e-90,this._oldPos=this.node.position,0==this.gaibian&&1==this.target.on_bool)){this.gaibian=!0;for(var t=o.gameScene.lie_can_move([this.target]),a=0;a<t.length;a++)t[a].on_bool=!1}},r([i(sp.Skeleton)],t.prototype,"spine",void 0),r([l],t)}(cc.Component),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene"}],bing_bao:[function(e,t,a){"use strict";var i,n,o,c,r;cc._RF.push(t,"e96bbf9bYhGQIKFMxHw51lQ","bing_bao"),o=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=cc._decorator,n=i.ccclass,i.property,r=function(e){var t;return o(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.init=function(e){var t,a,i,n;switch(a=this,(i=this.node.getComponent(sp.Skeleton)).clearTracks(),i.setToSetupPose(),t="A_",e){case-6:case-5:case-4:t+=3;break;case-8:t+=4}i.setSkin(t),n=i.setAnimation(0,"bao",!1),i.setTrackCompleteListener(n,function(){a.node.destroy()})},c([n],t)}(cc.Component),a.default=r,cc._RF.pop()},{}],block_item_copy:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d;cc._RF.push(t,"382c86RMSRCMZG5DFvg2Sx1","block_item_copy"),n=__extends,s=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Config"),c=e("PlayerDataMager"),l=cc._decorator,d=l.ccclass,o=l.property,r=function(e){var t;return n(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).block=null,t.icon=null,t.zhezhao=null,t.theme=-1,t.type=-1,t},e),t.prototype.init=function(e,t){this.theme=e,this.type=t,this.init_view()},t.prototype.init_view=function(){this.show_icon(),0==c._p_data._data.theme_collect[this.theme][this.type]?this.zhezhao.active=!0:this.zhezhao.active=!1},t.prototype.show_icon=function(){var e,t,a,n;n=this,a=i.cPublicMager.image[this.theme+"-"+(this.type+1)],this.icon.spriteFrame=a,e=(t=this.theme).toString(),t<10&&(e="0"+t),this.block.getComponent(cc.Sprite).spriteFrame=i.cPublicMager.image[e],this.zhezhao.getComponent(cc.Sprite).spriteFrame=i.cPublicMager.image[e],a||(cc.assetManager.getBundle("level_"+this.theme)||i.cPublicMager.load_level_bundle(this.theme),this.scheduleOnce(function(){n.show_icon()},.5))},s([o({type:cc.Node})],t.prototype,"block",void 0),s([o({type:cc.Sprite})],t.prototype,"icon",void 0),s([o({type:cc.Node})],t.prototype,"zhezhao",void 0),s([d],t)}(cc.Component),a.default=r,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager"}],block_item:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_,u;cc._RF.push(t,"4f9110GJlZJdqrAUZZyswxF","block_item"),l=__extends,r=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),d=e("Config"),u=e("PlayerDataMager"),i=e("GameScene"),n=e("bing_bao"),o=cc._decorator,s=o.ccclass,c=o.property,_=function(e){var t;return l(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).id=null,t.id2=null,t.block=null,t.img_id=null,t.select_node=null,t.tip_node=null,t.icon=null,t.icon_spine=null,t.cover_node=null,t.cover_sp=null,t.lock=null,t.bing_bao=null,t.data=null,t.callback=null,t.yun=null,t.moving=!1,t.move_id=-1,t},e),t.prototype.init=function(e,t){this.id&&(this.id.string=e.tag.toString()),this.id2&&(this.id2.string=e.tag.toString()),this.data=e,this.callback=t,this.init_view(),this.new_yun()},t.prototype.new_yun=function(){var e,t,a,n;1==this.data.is_yun&&(this.yun=new cc.Node("yun"),this.yun.parent=i.gameScene.line_parent,n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=this.yun.parent.convertToNodeSpaceAR(n),this.yun.x=t.x,this.yun.y=t.y+4,this.yun.scale=.4,e=this.yun.addComponent(cc.Sprite),a="block_-11-"+(Math.floor(3*Math.random())+1),e.spriteFrame=d.cPublicMager.image[a],this.yun.scale=0)},t.prototype.delect_yun=function(){var e;this.yun&&(e=this.yun.getPosition(),d.cBunbleMager.get_bundle_SkeletonData("common","cloud/yun").then(function(t){var a,n,o;(n=new cc.Node("san")).parent=i.gameScene.line_parent,n.setPosition(e),n.scale=.5,(a=n.addComponent(sp.Skeleton)).skeletonData=t,a.premultipliedAlpha=!1,o=a.addAnimation(0,"bao",!1),a.setTrackCompleteListener(o,function(){n.destroy()})}),this.yun.destroy(),this.yun=null),this.data.is_yun=!1},t.prototype.init_view=function(){var e,t,a,n,o,c,r,s,l;if(c=this,n=(s=u._p_data._data.theme).toString(),s<10&&(n="0"+s),e=d.cPublicMager.image[n],this.block.active=!0,this.icon_spine.active=!1,t="s"+n+"-2",a=d.cPublicMager.image[t],this.select_node.getComponent(cc.Sprite).spriteFrame=a,o="s"+n+"-1",r=d.cPublicMager.image[o],this.tip_node.getComponent(cc.Sprite).spriteFrame=r,1==this.data.is_tengman?this.lock.active=!0:this.lock.active=!1,this.data.id>=0)this.block.scale=1,this.block.active=!0,this.block.getComponent(cc.Sprite).spriteFrame=e,l=d.cPublicMager.image[u._p_data._data.theme+"-"+(this.data.id+1)],this.icon.spriteFrame=l,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1,l||this.scheduleOnce(function(){c.init_view()},.1);else if(-2==this.data.id)this.block.active=!0,e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.cover_node.active=!1;else if(-3==this.data.id){var _;this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!1,this.cover_node.active=!0,this.cover_sp.node.active=!1,_=d.cPublicMager.image[n+"_1"],this.cover_node.getComponent(cc.Sprite).spriteFrame=_}else if(-1==this.data.id)this.block.active=!1,this.icon.node.active=!0,this.cover_node.active=!1;else if(-5==this.data.id||-4==this.data.id||-6==this.data.id)e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1;else if(-7==this.data.id)e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!1,this.cover_node.active=!1;else if(-9==this.data.id)this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1,this.icon_spine.active=!0,d.cBunbleMager.get_bundle_SkeletonData("common","boom/bao_zhu").then(function(e){var t;(t=c.icon_spine.getComponent(sp.Skeleton)).skeletonData=e,t.addAnimation(0,"idle",!0)});else if(-10==this.data.id){var p,h,f;e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,f=this.node.convertToWorldSpaceAR(cc.v2(0,0)),h=i.gameScene.line_parent.convertToNodeSpaceAR(f),(p=new cc.Node).parent=i.gameScene.line_parent,p.setPosition(h)}},t.prototype.move_fun=function(e,t){var a;if(a=this,1!=this.moving){var n,o,c,r,s,l,_,p,h;if(this.moving=!0,c=(o=u._p_data._data.theme).toString(),o<10&&(c="0"+o),s=d.cPublicMager.image[c],this.data.id>=0?this.block.getComponent(cc.Sprite).spriteFrame=s:-9!=this.data.id&&(s=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=s),1==this.data.is_tengman?this.lock.active=!0:this.lock.active=!1,this.data.id>=0)this.icon.spriteFrame=d.cPublicMager.image[u._p_data._data.theme+"-"+(e.id+1)];else if(-9==this.data.id){var f;f=d.cPublicMager.image["block_"+this.data.id],this.icon.spriteFrame=f}else-7==this.data.id&&(this.icon.spriteFrame=null);e.target.init_view(),r=e.target.block_node.convertToWorldSpaceAR(cc.v2(0,0)),l=this.node.convertToNodeSpaceAR(r),this.block.active=!0,this.block.scale=1,this.block.angle=0,this.block.setPosition(l),this.cover_node.scale=1,this.cover_node.angle=0,this.cover_node.setPosition(l),-3==e.id&&(h=(p=u._p_data._data.theme).toString(),p<10&&(h="0"+p),this.block.active=!1,this.cover_node.active=!0,this.cover_sp.node.active=!1,_=d.cPublicMager.image[h+"_1"],this.cover_node.getComponent(cc.Sprite).spriteFrame=_),this.unschedule(this.no_move_yincang),n=.2,e.num>2&&(n=.1*e.num),n>.5&&(n=.5),cc.Tween.stopAllByTarget(this.block),cc.tween(this.block).to(n,{x:0,y:0}).call(function(){a.move_id=-1,1==e.bool&&d.cSound.playEffect(i.gameScene.move_end_effect),a.moving=!1,t(e),a.init_view()}).start(),cc.Tween.stopAllByTarget(this.cover_node),cc.tween(this.cover_node).to(.2,{x:0,y:0}).start()}},t.prototype.no_move_yincang=function(){this.block.scale=0},t.prototype.on=function(){this.callback&&this.callback(this.data)},t.prototype.switchSkin=function(){var e=u._p_data._data.theme,t=e.toString();e<10&&(t="0"+e);var a=d.cPublicMager.image[t];this.block.getComponent(cc.Sprite).spriteFrame=a,j=d.cPublicMager.image[u._p_data._data.theme+"-"+(this.data.id+1)],this.icon.spriteFrame=j},t.prototype.show_select=function(){var e;this.select_node.active=!0,e=this.icon.node,cc.Tween.stopAllByTarget(e),e.scale=.3,cc.tween(e).by(.1,{scale:.05}).by(.1,{scale:-.05}).start()},t.prototype.hide_select=function(){this.select_node.active=!1},t.prototype.show_tip=function(){this.tip_node.active=!0,cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.scale=.3,this.icon.node.angle=0,cc.tween(this.icon.node).to(.5,{scale:.33}).to(.5,{scale:.3}).union().repeatForever().start()},t.prototype.hide_tip=function(){this.tip_node.active=!1,cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.scale=.33,this.icon.node.angle=0},t.prototype.show_zidong_tip=function(){cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.angle=0,cc.tween(this.icon.node).to(0,{scale:.35}).to(.05,{angle:-10}).to(.1,{angle:10}).to(.1,{angle:-10}).to(.1,{angle:10}).to(.05,{angle:0}).to(0,{scale:.3}).delay(1.5).union().repeatForever().start()},t.prototype.init_icon_to_action=function(){var e,t;e=this,t=this.icon.node,cc.tween(t).to(.2,{scale:0},{easing:"backIn"}).call(function(){e.init_view()}).delay(.2).to(.2,{scale:.3},{easing:"backOut"}).start()},t.prototype.show_chuchang=function(e){var t;void 0===e&&(e=.1),this.node.scale=1,(t=this.icon.node).scale=0,cc.tween(t).to(e,{scale:.3},{easing:"backOut"}).start(),this.yun&&cc.tween(this.yun).to(e,{scale:.4},{easing:"backOut"}).start()},t.prototype.show_delete=function(e,t,a){var i;i=this,void 0===e&&(e=!1),void 0===t&&(t=.2),void 0===a&&(a=.2),1!=this.moving&&this.scheduleOnce(function(){1!=i.moving&&cc.tween(i.block).to(a,{scale:0}).call(function(){var t,a,n;n=(t=u._p_data._data.theme).toString(),t<10&&(n="0"+t),a=d.cPublicMager.image[n],i.data.id>=0?i.block.getComponent(cc.Sprite).spriteFrame=a:-7==i.data.id&&(a=d.cPublicMager.image["block_"+i.data.id],i.block.getComponent(cc.Sprite).spriteFrame=a),-2==i.data.id&&(i.block.scale=1,i.block.active=!0,i.select_node.active=!1,i.icon.node.active=!1),1==e&&(i.init_view(),i.block.scale=1)}).start()},t)},t.prototype.show_doudong=function(){1!=this.moving&&(cc.Tween.stopAllByTarget(this.block),this.block.angle=0,this.block.scale=1,cc.tween(this.block).to(.02,{angle:20}).to(.02,{angle:-15}).to(.08,{angle:10}).to(.1,{angle:-5}).to(.1,{angle:0}).start())},t.prototype.show_fanmian=function(){for(var e=this,t=2,a=function(a){i.scheduleOnce(function(){if(3==a)if(-1!=e.move_id){var i=d.cPublicMager.image[u._p_data._data.theme+"-"+(e.move_id+1)];e.icon.spriteFrame=i,e.cover_sp.spriteFrame=i,e.cover_node.active=!1,e.block.active=!0}else e.init_view();else{var n=u._p_data._data.theme,o=n.toString();n<10&&(o="0"+n);var c=d.cPublicMager.image[o+"_"+t];e.cover_node.getComponent(cc.Sprite).spriteFrame=c,t++,2==a&&(e.cover_sp.node.active=!0),i=d.cPublicMager.image[u._p_data._data.theme+"-"+(e.data.id+1)],-1!=e.move_id&&(i=d.cPublicMager.image[u._p_data._data.theme+"-"+(e.move_id+1)]),e.cover_sp.spriteFrame=i}},.07*a)},i=this,n=0;n<4;n++)a(n)},t.prototype.un_lock=function(){var e;e=this,this.data.is_tengman=!1,this.scheduleOnce(function(){var t,a,o;t=e.block.convertToWorldSpaceAR(cc.v2(0,0)),a=i.gameScene.node.convertToNodeSpaceAR(t),(o=cc.instantiate(e.bing_bao)).parent=i.gameScene.node,o.setPosition(a),o.getComponent(n.default).init(-8)},.35),this.scheduleOnce(function(){e.lock.active=!1},.35)},r([c({type:cc.Label})],t.prototype,"id",void 0),r([c({type:cc.Label})],t.prototype,"id2",void 0),r([c({type:cc.Node})],t.prototype,"block",void 0),r([c({type:cc.Label})],t.prototype,"img_id",void 0),r([c({type:cc.Node})],t.prototype,"select_node",void 0),r([c({type:cc.Node})],t.prototype,"tip_node",void 0),r([c({type:cc.Sprite})],t.prototype,"icon",void 0),r([c({type:cc.Node})],t.prototype,"icon_spine",void 0),r([c({type:cc.Node})],t.prototype,"cover_node",void 0),r([c({type:cc.Sprite})],t.prototype,"cover_sp",void 0),r([c({type:cc.Node})],t.prototype,"lock",void 0),r([c({type:cc.Prefab})],t.prototype,"bing_bao",void 0),r([s],t)}(cc.Component),a.default=_,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",bing_bao:"bing_bao"}],combo_item:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"50c11hhwb1CkKbJnE23Bh95","combo_item"),i=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=cc._decorator,n=s.ccclass,r=s.property,c=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).lianji_spf=[],t},e),t.prototype.init=function(e){var t,a;console.log("combo",e),t=this,(a=(e-3)%this.lianji_spf.length)>=this.lianji_spf.length&&(a=this.lianji_spf.length-1),this.node.getComponent(cc.Sprite).spriteFrame=this.lianji_spf[a],Math.random(),this.node.angle=-15,cc.tween(this.node).by(.5,{y:30,opacity:-255}).call(function(){t.node.destroy()}).start()},o([r({type:cc.SpriteFrame})],t.prototype,"lianji_spf",void 0),o([n],t)}(cc.Component),a.default=c,cc._RF.pop()},{}],delect_effect:[function(e,t,a){"use strict";var i,n,o,c,r;cc._RF.push(t,"8c8adxlqv9FOJzjHbku7unD","delect_effect"),r=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),c=cc._decorator,n=c.ccclass,c.property,i=function(e){var t;return r(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.start=function(){var e,t,a;t=this,(e=this.node.getComponent(sp.Skeleton))&&(e.clearTracks(),e.setToSetupPose(),a=e.setAnimation(0,"bao",!1),e.setTrackCompleteListener(a,function(){t.node.destroy()}))},o([n],t)}(cc.Component),a.default=i,cc._RF.pop()},{}],get_item_ui:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"216abC/45pMG6eHvbzsOZv8","get_item_ui"),i=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l=e("Config"),d=e("PlayerDataMager"),_=e("ViewBase"),u=e("GameScene");r=cc._decorator,o=r.ccclass,s=r.property,n=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).item_name=null,t.icon=null,t.desc=null,t.item_icon=[],t.huxi=null,t.ad_tu=null,t.ad_share_icon=[],t.type=-1,t.ad=!0,t.fun_=null,t},e),t.prototype.init=function(e){switch(this.scale_tween(),this.type=e,this.type){case 0:this.item_name.string="Hint",this.desc.string="Get 3 Hints";break;case 1:this.item_name.string="Refresh",this.desc.string="Shuffle All Tiles";break;case 2:this.item_name.string="Clear",this.desc.string="Clear 1 Set of Blocks"}this.icon.spriteFrame=this.item_icon[this.type],cc.tween(this.huxi).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start(),this.fun_=this.fun.bind(this)},t.prototype.on_get=function(){var e,t;this.btn0(),this.type,e=(t=this).type,d._p_data.addItem(e,function(a){0==a?cc.isValid(t)?t.fun_():cc.isValid(u.gameScene)&&(d._p_data._data.item[e]++,0==e&&(d._p_data._data.item[0]+=2),d._p_data.saveData(),u.gameScene.ad_num++,u.gameScene.show_item(-1,e)):l.cUI.showTips("Ad loading failed. Please try again later.")})},t.prototype.fun=function(){d._p_data._data.item[this.type]++,0==this.type&&(d._p_data._data.item[0]+=2),d._p_data.saveData(),cc.isValid(u.gameScene)&&(u.gameScene.ad_num++,u.gameScene.show_item(this.icon.node.parent.y,this.type)),cc.isValid(this.node)&&l.cUI.removeLayer(this.node)},t.prototype.on_back=function(){this.btn0(),l.cUI.removeLayer(this.node)},t.prototype.onDisable=function(){},c([s({type:cc.Label})],t.prototype,"item_name",void 0),c([s({type:cc.Sprite})],t.prototype,"icon",void 0),c([s({type:cc.Label})],t.prototype,"desc",void 0),c([s({type:cc.SpriteFrame})],t.prototype,"item_icon",void 0),c([s({type:cc.Node})],t.prototype,"huxi",void 0),c([s({type:cc.Sprite})],t.prototype,"ad_tu",void 0),c([s({type:cc.SpriteFrame})],t.prototype,"ad_share_icon",void 0),c([o],t)}(_.default),a.default=n,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],get_star_tip_ui:[function(e,t,a){"use strict";var i,n,o,c,r;cc._RF.push(t,"8ab14GrXjJCFb9RnxQJDAxC","get_star_tip_ui"),o=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var s=e("Config"),l=e("ViewBase"),d=e("PlayerDataMager"),_=e("GameScene");c=cc._decorator.ccclass,i=cc._decorator.property,r=function(e){var t;return o(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).btn=null,t.get_star_label=null,t.pro_label=null,t},e),t.prototype.start=function(){var e,t;this.scale_tween(),cc.tween(this.btn).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start();var a=d._p_data._data.level>s.cPublicMager.config.maxLevel?s.cPublicMager.config.maxLevel:d._p_data._data.level,i=s.cPublicMager.config.gold+(a-1)*s.cPublicMager.config.levelGold;this.get_star_label.string="x"+i.toString(),e=((t=_.gameScene.return_jindu()).number/t.max*100).toFixed(),this.pro_label.string=e+"%"},t.prototype.on_game=function(){this.btn0(),s.cUI.removeAllLayer()},t.prototype.on_back=function(){this.btn0(),s.cUI.removeLayer(this.node)},n([i({type:cc.Node})],t.prototype,"btn",void 0),n([i({type:cc.Label})],t.prototype,"get_star_label",void 0),n([i({type:cc.Label})],t.prototype,"pro_label",void 0),n([c],t)}(l.default),a.default=r,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],give_up_ui:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_;cc._RF.push(t,"5091duRi3VHOqso1JtlzFx1","give_up_ui"),r=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Config"),e("PlayerDataMager"),d=e("ViewBase"),_=e("GameScene"),s=cc._decorator,l=s.ccclass,o=s.property,c=function(e){var t;return r(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).progress_node=null,t},e),t.prototype.start=function(){var e,t;this.scale_tween(),t=((e=_.gameScene.return_jindu()).number/e.max*100).toFixed(),this.progress_node.string=t+"%"},t.prototype.on_give_up=function(){this.btn0(),i.cUI.addScene(i.cRes.Prefab.main_scene)},t.prototype.on_back=function(){this.btn0(),i.cUI.removeLayer(this.node)},n([o({type:cc.Label})],t.prototype,"progress_node",void 0),n([l],t)}(d.default),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],item_icon:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"5647eDAPpVEfYJL8HK4q4eP","item_icon"),i=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=cc._decorator,s=n.ccclass,o=n.property,r=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).tu=[],t},e),t.prototype.init=function(e){this.node.getComponent(cc.Sprite).spriteFrame=this.tu[e]},c([o({type:cc.SpriteFrame})],t.prototype,"tu",void 0),c([s],t)}(cc.Component),a.default=r,cc._RF.pop()},{}],level:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"bd61aFNNJBOcqb1aUXi8IOq","level"),i=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=e("GameScene"),o=cc._decorator,r=o.ccclass,o.property,c=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).effect_label_bool=!1,t},e),t.prototype.init=function(){},t.prototype.delect_block=function(){},t.prototype.show_fly_item=function(e,t){s.gameScene.show_fly_item(e,t)},n([r],t)}(cc.Component),a.default=c,cc._RF.pop()},{GameScene:"GameScene"}],line:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"249ddm8rCVEvbLROOhHj85G","line"),r=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=cc._decorator,c=s.ccclass,o=s.property,i=function(e){var t;return r(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).graphics=[],t.yuan=[],t.arr=[],t.time=.5,t.opacity={num:255},t},e),t.prototype.init=function(e){this.arr=e,cc.tween(this.opacity).to(this.time,{num:0},{easing:"quadIn"}).start()},t.prototype.update=function(e){for(var t=0;t<this.graphics.length;t++){this.graphics[t].clear();for(var a=0;a<this.arr.length&&0!=cc.isValid(this.arr[a].block_node);a++){var i,n;i=this.arr[a].block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.parent.convertToNodeSpaceAR(i),0==a?this.graphics[t].moveTo(n.x,n.y):this.graphics[t].lineTo(n.x,n.y),this.graphics[t].strokeColor.a=this.opacity.num}this.graphics[t].stroke()}this.time-=e,this.time<0&&this.node.destroy()},n([o({type:cc.Graphics})],t.prototype,"graphics",void 0),n([o({type:cc.Graphics})],t.prototype,"yuan",void 0),n([c],t)}(cc.Component),a.default=i,cc._RF.pop()},{}],skin_item:[function(e,t,a){"use strict";var i,n,o,c,r,s,l,d,_,u;cc._RF.push(t,"02eee24lA9KWarxauss7CYH","skin_item"),s=__extends,r=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),l=e("Config"),n=e("PlayerDataMager"),c=e("ViewBase"),i=e("block_item_copy"),u=cc._decorator,_=u.ccclass,o=u.property,d=function(e){var t;return s(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).bg=null,t.bg_spf=[],t.skin_name=null,t.shouji_number=null,t.shouji_label=null,t.shouji_labelOuutline=null,t.lock=null,t.loudou=null,t.block_parent=null,t.block_prefab=null,t.theme=-1,t.callback=null,t.lock_bool=!1,t},e),t.prototype.init=function(e,t){void 0!==e&&(this.theme=e,this.callback=t),this.show_view(),this.new_block()},t.prototype.show_view=function(){for(var e=!0,t=!1,a=0,i=0;i<n._p_data._data.theme_collect[this.theme].length;i++)0==n._p_data._data.theme_collect[this.theme][i]?(e=!1,this.lock_bool=!0):a++;1==e?n._p_data._data.theme==this.theme&&(t=!0):n._p_data._data.collectting_theme==this.theme&&(t=!0),this.lock.active=!1,this.loudou.active=!1,this.shouji_number.node.parent.active=!1,this.skin_name.string=l.cPublicMager.skin_name[this.theme],1==e?(1==t?(this.bg.spriteFrame=this.bg_spf[1],this.shouji_label.string="In Use",this.shouji_labelOuutline.color=cc.color().fromHEX("822b0d")):(this.bg.spriteFrame=this.bg_spf[0],this.shouji_label.string="Select",this.shouji_labelOuutline.color=cc.color().fromHEX("303331")),this.shouji_number.node.parent.active=!1):(1==t?(this.bg.spriteFrame=this.bg_spf[2],this.shouji_label.string="Collecting",this.shouji_labelOuutline.color=cc.color().fromHEX("0f5c26"),this.loudou.active=!0):(this.bg.spriteFrame=this.bg_spf[3],this.shouji_label.string="Locked",this.shouji_labelOuutline.color=cc.color().fromHEX("2b2b2b"),this.lock.active=!0),this.shouji_number.node.parent.active=!0),this.shouji_number.string=a+"/"+n._p_data._data.theme_collect[this.theme].length,this.load_bundle_data()},t.prototype.load_bundle_data=function(){var e,t;if(e=this,t=cc.assetManager.getBundle("level_"+this.theme))for(var a=t.getDirWithPath("texture"),i=0;i<a.length;i++)for(var n=a[i].path,o=0;o<n.length;o++)n[o];else this.scheduleOnce(function(){e.load_bundle_data()},.5)},t.prototype.new_block=function(){var e;e=this,setTimeout(function(){for(var t=0;t<n._p_data._data.theme_collect[e.theme].length;t++){var a;(a=cc.instantiate(e.block_prefab)).parent=e.block_parent,a.scale=.85,-1!=l.cPublicMager.limit_skin.indexOf(l.cPublicMager.skin_name[e.theme])&&(a.scale=.767),a.zIndex=t,a.getComponent(i.default).init(e.theme,t)}},10)},t.prototype.on=function(){var e;this.btn0(),e=!0,console.log("cur theme",this.theme);for(var t=0;t<n._p_data._data.theme_collect[this.theme].length;t++)if(0==n._p_data._data.theme_collect[this.theme][t]){e=!1;break}console.log("theme is unlock",e),e&&(n._p_data._data.theme=this.theme,n._p_data.saveData(),this.callback&&this.callback())},r([o({type:cc.Sprite})],t.prototype,"bg",void 0),r([o({type:cc.SpriteFrame})],t.prototype,"bg_spf",void 0),r([o({type:cc.Label})],t.prototype,"skin_name",void 0),r([o({type:cc.Label})],t.prototype,"shouji_number",void 0),r([o({type:cc.Label})],t.prototype,"shouji_label",void 0),r([o({type:cc.LabelOutline})],t.prototype,"shouji_labelOuutline",void 0),r([o({type:cc.Node})],t.prototype,"lock",void 0),r([o({type:cc.Node})],t.prototype,"loudou",void 0),r([o({type:cc.Node})],t.prototype,"block_parent",void 0),r([o({type:cc.Prefab})],t.prototype,"block_prefab",void 0),r([_],t)}(c.default),a.default=d,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",block_item_copy:"block_item_copy"}],skin_ui:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"7cde77lX6ZKV5bxC6DLMHD+","skin_ui"),r=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l=e("Config"),d=e("PlayerDataMager"),_=e("ViewBase"),u=e("GameScene"),p=e("skin_item");n=cc._decorator,s=n.ccclass,o=n.property,i=function(e){var t;return r(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).node1_view=null,t.prefab1=null,t.prefab2=null,t.page_label=null,t.lr_btn=[],t.now_type=0,t.back_fun=null,t.page1=1,t.max_page1=1,t.page1_skin=[],t},e),t.prototype.start=function(){this.scale_tween(),this.new_item(),this.select_ui(0),this.load_xianding()},t.prototype.load_xianding=function(){for(var e=0,t=0;t<d._p_data._data.theme_collect.length;t++)-1!=l.cPublicMager.limit_skin.indexOf(l.cPublicMager.skin_name[t])&&e<3&&(e++,l.cPublicMager.load_level_bundle(t))},t.prototype.new_item=function(){for(var e=0,t=0;t<l.cPublicMager.skin_name.length;t++)-1==l.cPublicMager.limit_skin.indexOf(l.cPublicMager.skin_name[t])&&(e++,this.page1_skin.push(l.cPublicMager.skin_name[t]));for(this.max_page1=Math.ceil(e/3),t=0;t<this.max_page1;t++)this.node1_view.addPage(cc.instantiate(this.prefab1))},t.prototype.select_ui=function(e){var t;t=0,0==e?(this.node1_view.node.zIndex=1,this.node1_view.node.getChildByName("background").color=cc.color(255,255,255),t=this.page1):(this.node1_view.node.zIndex=0,this.node1_view.node.getChildByName("background").color=cc.color().fromHEX("cbcbcb")),this.now_type=e,this.show_view(t)},t.prototype.onDisable=function(){this.now_type},t.prototype.show_view=function(e){if(0!=cc.isValid(this.node)){var t,a,i,n;if(a=null,n=[],i=0,0==this.now_type&&(a=this.node1_view,n=this.page1_skin,i=this.max_page1),a.setCurrentPageIndex(e-1),(t=a.getPages()[e-1])&&t.children.length<1)for(var o=0;o<3;o++)(c=n[3*(e-1)+o])&&-1!=(r=l.cPublicMager.skin_name.indexOf(c))&&this.new_item2(r,t);for(o=0;o<3;o++){var c,r;(c=n[3*(e-1)+o+3])&&-1!=(r=l.cPublicMager.skin_name.indexOf(c))&&(cc.assetManager.getBundle("level_"+r)||l.cPublicMager.load_level_bundle(r))}for(this.page_label.string=e+"/"+i,o=0;o<this.lr_btn.length;o++)this.lr_btn[o].active=!0;1==e&&(this.lr_btn[0].active=!1),e==i&&(this.lr_btn[1].active=!1)}},t.prototype.new_item2=function(e,t){var a,i;a=this,(i=cc.instantiate(this.prefab2)).parent=t,i.zIndex=e,i.getComponent(p.default).init(e,function(){a.switchSkin()})},t.prototype.switchSkin=function(){for(var e=0;e<this.node1_view.getPages().length;e++)for(var t=this.node1_view.getPages()[e].children,a=0;a<t.length;a++)t[a].getComponent(p.default).show_view();cc.isValid(u.gameScene)&&u.gameScene.switchSkin(),d._p_data.switchTheme(d._p_data._data.theme)},t.prototype.on_select=function(e,t){var a;this.btn0(),a=Number(t),this.select_ui(a)},t.prototype.on_back=function(){this.btn0(),this.back_fun&&this.back_fun(),l.cUI.removeLayer(this.node)},t.prototype.init_skin=function(e){var t;t=0,0==this.now_type&&(this.page1=e.getCurrentPageIndex()+1,t=this.page1),this.show_view(t)},t.prototype.on_left=function(){this.btn0(),0==this.now_type&&(this.page1--,this.show_view(this.page1))},t.prototype.on_right=function(){this.btn0(),0==this.now_type&&(this.page1++,this.show_view(this.page1))},c([o({type:cc.PageView,tooltip:"page1"})],t.prototype,"node1_view",void 0),c([o({type:cc.Prefab,tooltip:"prefab1"})],t.prototype,"prefab1",void 0),c([o({type:cc.Prefab,tooltip:"prefab2"})],t.prototype,"prefab2",void 0),c([o({type:cc.Label,tooltip:"page"})],t.prototype,"page_label",void 0),c([o({type:cc.Node,tooltip:"arrow"})],t.prototype,"lr_btn",void 0),c([s],t)}(_.default),a.default=i,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",skin_item:"skin_item"}],star:[function(e,t,a){"use strict";var i,n,o,c,r,s,l;cc._RF.push(t,"e564avfEIVNB7h605kVYBwo","star"),o=__extends,l=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=e("Config"),s=e("GameScene"),i=cc._decorator,r=i.ccclass,i.property,c=function(e){var t;return o(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).world_pos=null,t},e),t.prototype.init=function(e){var t,a,i,o,c,r;a=this,c=this.node.parent.convertToNodeSpaceAR(e),this.node.setPosition(c),this.node.scale=0,t=s.gameScene.gift_box,s.gameScene.xiao_window&&(t=s.gameScene.level_label.node),i=t.convertToWorldSpaceAR(cc.v2(0,0)),r=this.node.parent.convertToNodeSpaceAR(i),o=c.sub(r).len()/2e3,cc.tween(this.node).to(.2,{scale:1.2}).to(.1,{scale:1}).delay(.3).to(o,{x:r.x,y:r.y}).call(function(){n.cSound.playEffect("effect/progress"),t==s.gameScene.gift_box?(cc.tween(t).to(.04,{scale:.58}).to(.04,{scale:.5}).start(),s.gameScene.show_jindu(),a.node.destroy()):a.node.destroy()}).start()},t.prototype.init2=function(e,t){var a,i;a=this,i=this.node.parent.convertToNodeSpaceAR(e),cc.tween(this.node).to(.2,{x:i.x,y:i.y}).call(function(){t(),a.node.destroy()}).start()},t.prototype.init3=function(e,t){var a;a=this,this.world_pos=e,this.node.scale=0,cc.tween(this.node).to(.2,{scale:1}).delay(.5).call(function(){var e,t,i;i=a.node.parent.convertToNodeSpaceAR(a.world_pos),e=0,t=0,Math.random()<.5?(e=i.x,t=a.node.y):(e=a.node.x,t=i.y),cc.tween(a.node).bezierTo(.5,a.node.getPosition(),cc.v2(e,t),i).start(),cc.tween(a.node).by(.5,{angle:360}).start()}).delay(.51).call(function(){t&&t(),a.node.destroy()}).start()},l([r],t)}(cc.Component),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene"}],ts:[function(e,t){"use strict";cc._RF.push(t,"d5559/u4IZAkZhq+SDk5QVb","ts"),cc._RF.pop()},{}],unline_tip_ui:[function(e,t,a){"use strict";var i,n,o,c,r,s;cc._RF.push(t,"9b1c2hBe0NMKbGW7KT8oqWL","unline_tip_ui"),n=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l=e("Config"),d=e("PlayerDataMager"),_=e("ViewBase"),u=e("GameScene");i=cc._decorator,o=i.ccclass,r=i.property,s=function(e){var t;return n(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).progress_node=null,t.huxi=null,t.ad_icon=null,t.ad_share_icon=[],t.ad=!0,t.fun_=null,t},e),t.prototype.start=function(){var e,t;this.scale_tween(),t=((e=u.gameScene.return_jindu()).number/e.max*100).toFixed(),this.progress_node&&(this.progress_node.string=t+"%"),d._p_data._data.item[1]>0?this.ad_icon.active=!1:this.ad_icon.active=!0,cc.tween(this.huxi).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start(),this.fun_=this.fun.bind(this)},t.prototype.on_get=function(){var e;if(this.btn0(),d._p_data._data.item[1]>0)return d._p_data.useItem(1),d._p_data._data.item[1]--,d._p_data.saveData(),u.gameScene.show_item_fun(),u.gameScene.refresh(),void l.cUI.removeLayer(this.node);e=this,d._p_data.refreshItem(function(t){0==t?(playerDataMager._p_data.refreshItem(sign),cc.isValid(e)?e.fun_():cc.isValid(u.gameScene)&&(u.gameScene.ad_num++,u.gameScene.refresh())):l.cUI.showTips("Ad loading failed. Please try again later.")})},t.prototype.fun=function(){cc.isValid(u.gameScene)&&(u.gameScene.ad_num++,u.gameScene.refresh()),this&&cc.isValid(this.node)&&l.cUI.removeLayer(this.node)},t.prototype.on_back=function(){this.btn0(),l.cUI.removeLayer(this.node),cc.Tween.stopAllByTarget(u.gameScene.refresh_btn),u.gameScene.refresh_btn.scale=1,u.gameScene.hide_unline_btn(),cc.tween(u.gameScene.refresh_btn).to(.5,{scale:1.1}).to(.5,{scale:1}).union().repeatForever().start()},t.prototype.onDisable=function(){},c([r({type:cc.Label})],t.prototype,"progress_node",void 0),c([r({type:cc.Node})],t.prototype,"huxi",void 0),c([r({type:cc.Node})],t.prototype,"ad_icon",void 0),c([r({type:cc.SpriteFrame})],t.prototype,"ad_share_icon",void 0),c([o],t)}(_.default),a.default=s,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],win_ui:[function(e,t,i){"use strict";cc._RF.push(t,"86a15G6aFRIpa1huR4O9q7f","win_ui");var n=__extends,o=__decorate;Object.defineProperty(i,"__esModule",{value:!0});var c=e("Config"),r=e("PlayerDataMager"),s=e("ViewBase"),l=e("block_item_copy"),d=e("GameScene"),_=e("skin_ui"),u=cc._decorator.ccclass,p=cc._decorator.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mid=null,t.win_title2=null,t.guang=null,t.tu=null,t.btn1=null,t.block_parent=null,t.block_perfab=null,t.progress=null,t.progress_text=null,t.progress_niu=null,t.isGet=null,t.btn=null,t.use_btn=null,t.theme_unlock=null,t.use_btn_spf=null,t.stage1=null,t.stage2=null,t.cur=null,t.btn2=null,t.menu_btn=null,t.theme_name=null,t.zi_2=[],t.huo=null,t.time=null,t.new=null,t.title2=null,t.rank=null,t.caidai=null,t.star_label=null,t.star_percent=null,t.guan=null,t.bg_=null,t.kuang=null,t.kuang_bg=null,t.stage_title=null,t.now_theme=0,t}return n(t,e),t.prototype.start=function(){if(c.cSound.stopMusic(),c.cSound.playEffect("effect/cheer"),c.cSound.playEffect("effect/win"),this.star_label.node.parent.scale=0,cc.isValid(d.gameScene)&&d.gameScene.level_data.star){var e=d.gameScene.ad_num;e<0&&(e=0);var t=r._p_data._data.level>c.cPublicMager.config.maxLevel?c.cPublicMager.config.maxLevel:r._p_data._data.level,i=c.cPublicMager.config.gold+(t-1)*c.cPublicMager.config.levelGold;this.star_label.string=i.toString(),this.star_percent.string=d.gameScene.level_data.star.toString(),d.gameScene.level_data.star>1?this.star_percent.node.active=!0:this.star_percent.node.active=!1,r._p_data.saveData()}else this.star_label.node.parent.active=!1;var n=!0;for(a=0;a<r._p_data._data.theme_collect.length;a++){if(-1==c.cPublicMager.limit_skin.indexOf(c.cPublicMager.skin_name[a]))for(var o=0;o<r._p_data._data.theme_collect[a].length;o++)if(0==r._p_data._data.theme_collect[a][o]){n=!1;break}if(0==n)break}1==n?this.stage_2_action():this.stage_1_action()},t.prototype.stage_1_action=function(){var e=this;this.stage1.active=!0,this.stage2.active=!1,this.mid.scale=0,this.btn.scale=0,this.title2.string="Well done!",cc.tween(this.guang).by(3,{angle:360}).repeatForever().start();var t=c.cPublicMager.get_skin();r._p_data._data.theme_collect[t.theme][t.skin]=1,this.tu.getComponent(l.default).init(t.theme,t.skin),r._p_data._data.collectting_theme=t.theme,r._p_data.saveData(),r._p_data.settle(r._p_data._data.level,t.theme,t.skin);for(var a=0,i=0;i<r._p_data._data.theme_collect[t.theme].length;i++)1==r._p_data._data.theme_collect[t.theme][i]&&a++;this.zi_2[0].getComponent(cc.Label).string=a+"/"+r._p_data._data.theme_collect[t.theme].length,this.show_time(),this.win_title2.string=c.cPublicMager.skin_name[t.theme],r._p_data._data.collectting_theme<0?this.show_donghua(t):c.cBunbleMager.find_bundle("level_"+r._p_data._data.collectting_theme)?this.show_donghua(t):c.cPublicMager.load_level_bundle(r._p_data._data.collectting_theme,function(){e.show_donghua(t)})},t.prototype.show_donghua=function(e){var t=this;this.now_theme=e.theme;for(var a=null,i=0,n=0,o=0;o<r._p_data._data.theme_collect[e.theme].length;o++){var s=cc.instantiate(this.block_perfab);s.parent=this.block_parent,s.getComponent(l.default).init(e.theme,o),e.skin==o&&((a=s).opacity=0),i++,1==r._p_data._data.theme_collect[e.theme][o]&&n++}for(this.bg_.spriteFrame=c.cPublicMager.image["m_bg"+this.now_theme],o=0;o<this.zi_2.length;o++)this.zi_2[o].scale=0;this.win_title2.node.parent.scale=0,this.time.node.parent.scale=0,cc.tween(this.win_title2.node.parent).call(function(){cc.tween(t.time.node.parent).to(.5,{scale:1},{easing:"backOut"}).start()}).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(this.mid).to(.5,{scale:1},{easing:"backOut"}).start(),this.progress.node.opacity=0,this.kuang.opacity=0,this.kuang_bg.opacity=0,this.btn1.opacity=0,cc.tween(this.kuang).delay(1.5).call(function(){cc.tween(t.guang).to(.5,{scale:0}).start(),cc.tween(t.btn1).to(.5,{opacity:255}).start(),cc.tween(t.win_title2.node).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.zi_2[0]).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.kuang_bg).to(.5,{opacity:255}).start(),cc.tween(t.progress.node).to(.5,{opacity:255},{easing:"backOut"}).start();var e=(n-1)/i;t.progress.progress=e,0==t.progress.progress&&(t.progress.progress=.01),t.progress_text.string=(100*e).toFixed()+"%"}).to(.5,{opacity:255}).delay(.5).call(function(){var o=a.convertToWorldSpaceAR(cc.v2(0,0)),r=t.mid.parent.convertToNodeSpaceAR(o);t.isGet.active=!1,t.new.active=!1,cc.tween(t.tu).to(.5,{scale:.83}).start(),t.scheduleOnce(function(){c.cSound.playEffect("effect/skin_fly")},.2),cc.tween(t.tu).to(.5,{x:r.x,y:r.y},{easing:"backIn"}).call(function(){a.opacity=255,t.tu.opacity=0,t.scheduleOnce(function(){c.cSound.playEffect("effect/win_jump"),cc.tween(t.progress_niu).by(.15,{y:20}).by(.15,{y:-20}).delay(.1).start()},.1)}).delay(.5).call(function(){c.cSound.playEffect("effect/win_walk");var a=n/i;cc.tween(t.progress).to(.5,{progress:a}).delay(.2).call(function(){cc.tween(t.zi_2[1]).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.btn).to(.5,{scale:1},{easing:"backOut"}).start(),i==n&&(t.theme_unlock.string=c.cPublicMager.skin_name[e.theme]+" Unlock",t.theme_unlock.node.parent.x=-400,cc.tween(t.theme_unlock.node.parent).to(.5,{x:0},{easing:"backOut"}).start(),cc.tween(t.use_btn).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.progress_niu).delay(.2).by(.15,{y:20}).by(.15,{y:-20}).union().repeatForever().start(),t.caidai.active=!0,c.cSound.playEffect("effect/fireworks"))}).start(),t.progress_text.string=(100*a).toFixed()+"%"}).start()}).start()},t.prototype.show_time=function(){var e=1111;if(cc.isValid(d.gameScene)&&(e=d.gameScene.jishi_time),e>3600)this.time.string=">1hour";else{var t=e%60,a=Math.floor(e/60),i=t.toString();t<10&&(i="0"+i);var n=a.toString();a<10&&(n="0"+n),this.time.string="Level Timer "+n+":"+i}},t.prototype.get_skin_block=function(){var e=[],t=r._p_data._data.collectting_theme;if(-1!=c.cPublicMager.limit_skin.indexOf(c.cPublicMager.skin_name[t])&&(r._p_data._data.collectting_theme=0,t=r._p_data._data.collectting_theme),-1!=t)for(var a=0;a<r._p_data._data.theme_collect[t].length;a++)0==r._p_data._data.theme_collect[t][a]&&e.push(t+"-"+(a+1));else for(a=0;a<r._p_data._data.theme_collect.length;a++)for(var i=0;i<r._p_data._data.theme_collect[a].length;i++)e.push(a+"-"+(i+1));if(e.length<1){var n=!1;for(a=0;a<r._p_data._data.theme_collect.length;a++){for(i=0;i<r._p_data._data.theme_collect[a].length;i++)-1==c.cPublicMager.limit_skin.indexOf(c.cPublicMager.skin_name[a])&&0==r._p_data._data.theme_collect[a][i]&&(e.push(a+"-"+(i+1)),n=!0,r._p_data._data.collectting_theme=a);if(1==n)break}}if(e.length<1){for(a=0;a<r._p_data._data.theme_collect.length;a++)for(i=0;i<r._p_data._data.theme_collect[a].length;i++)-1==c.cPublicMager.limit_skin.indexOf(c.cPublicMager.skin_name[a])&&e.push(a+"-"+(i+1));r._p_data._data.collectting_theme=-1}if(1==c.cPublicMager.is_zui_niu){var o=[];for(a=0;a<c.cPublicMager.limit_skin.length;a++){var s=c.cPublicMager.skin_name.indexOf(c.cPublicMager.limit_skin[a]);if(-1!=s)for(i=0;i<r._p_data._data.theme_collect[s].length;i++)if(0==r._p_data._data.theme_collect[s][i]){o.push(s);break}}var d=0;o.length>0&&(d=o[Math.floor(Math.random()*o.length)]);var _=c.cPublicMager.skin_name.indexOf(c.cPublicMager.limit_skin[d]);for(a=0;a<r._p_data._data.theme_collect[_].length;a++)0==r._p_data._data.theme_collect[_][a]&&e.push(_+"-"+(a+1));if(e.length<1)for(a=0;a<r._p_data._data.theme_collect[_].length;a++)e.push(_+"-"+(a+1))}var u=e[Math.floor(Math.random()*e.length)].split("-"),p=Number(u[0]),h=Number(u[1]);r._p_data._data.theme_collect[p][h-1]=1;var f=!0;for(a=0;a<r._p_data._data.theme_collect[p].length;a++)0==r._p_data._data.theme_collect[p][a]&&(f=!1);if(1==f)for(r._p_data._data.collectting_theme=-1,a=0;a<r._p_data._data.theme_collect.length;a++){for(i=0;i<r._p_data._data.theme_collect[a].length;i++){var g=c.cPublicMager.limit_skin.indexOf(c.cPublicMager.skin_name[a]);if(0==r._p_data._data.theme_collect[a][i]&&-1==g){r._p_data._data.collectting_theme=a;break}}if(-1!=r._p_data._data.collectting_theme)break}r._p_data.saveData(),this.tu.getComponent(l.default).init(p,h-1);var v=0;for(a=0;a<r._p_data._data.theme_collect[p].length;a++)1==r._p_data._data.theme_collect[p][a]&&v++;return this.theme_name.string=v+"/"+r._p_data._data.theme_collect[p].length,{theme:p,id:h-1}},t.prototype.on_sure=function(){this.btn0(),this.stage_2_action()},t.prototype.getRank=function(e){return{one:Math.floor(2e5+2e5*(1-Math.pow(e,this.rankFactor(2,1e3)))),two:Math.floor(2e5+2e5*(1-Math.pow(e+1,this.rankFactor(2,1e3))))}},t.prototype.rankFactor=function(e,t){return Math.log(e)/Math.log(t)},t.prototype.stage_2_action=function(){var e=this;this.stage1.active=!1,this.stage2.active=!0,this.show_time();var t=this.getRank(r._p_data._data.level),a=t.one,i=t.two;this.cur.string="Rank"+a,this.rank.string="+"+(a-i).toString(),1==c.cPublicMager.is_zui_niu&&(this.cur.string="Level "+(r._p_data._data.zui_niu_level-1)),this.stage_title.scale=0,cc.tween(this.stage_title).to(.5,{scale:1},{easing:"backOut"}).start(),this.scheduleOnce(function(){e.cur.node.parent.active=!0,e.cur.node.parent.scale=0,cc.tween(e.cur.node.parent).to(.25,{scale:1},{easing:"backOut"}).start(),cc.tween(e.guan).to(.25,{scale:1},{easing:"backOut"}).start(),e.scheduleOnce(function(){e.scheduleOnce(function(){c.cSound.playEffect("effect/spring")},.3),e.scheduleOnce(function(){cc.tween(e.cur.node.parent).by(.2,{scale:.5},{easing:"quadOut"}).call(function(){e.cur.string="Rank"+i,e.rank.node.active=!0,1==c.cPublicMager.is_zui_niu&&(e.cur.string="Level "+r._p_data._data.zui_niu_level,e.rank.node.active=!1)}).by(.2,{scale:-.5},{easing:"quadIn"}).start(),cc.tween(e.guan).by(.2,{scale:.5},{easing:"quadOut"}).by(.2,{scale:-.5},{easing:"quadIn"}).by(.05,{angle:5}).by(.1,{angle:-5}).by(.05,{angle:5}).start(),cc.tween(e.cur.node.parent).by(.05,{angle:5}).by(.1,{angle:-5}).by(.05,{angle:5}).delay(.5).call(function(){e.scale_tween(e.btn2),e.scale_tween(e.menu_btn),e.scale_tween(e.star_label.node.parent)}).start()},.5)},.5)},.5)},t.prototype.on_next=function(){this.btn0(),c.cUI.removeLayer(this.node),d.gameScene.init()},t.prototype.on_change_theme=function(){this.btn0(),c.cUI.addLayer(c.cRes.Prefab.skin_ui).then(function(e){e.getComponent(_.default).back_fun=function(){}})},t.prototype.on_use=function(){this.btn0(),r._p_data._data.theme=this.now_theme,this.use_btn.getComponent(cc.Sprite).spriteFrame=this.use_btn_spf,this.use_btn.getChildByName("text").getComponent(cc.Label).string="In Use"},t.prototype.onDisable=function(){},t.prototype.on_back=function(){this.btn0(),c.cUI.removeLayer(this.node),c.cUI.addScene(c.cRes.Prefab.main_scene)},t.prototype.on_share=function(){this.btn0()},o([p({type:cc.Node})],t.prototype,"mid",void 0),o([p({type:cc.Label})],t.prototype,"win_title2",void 0),o([p({type:cc.Node})],t.prototype,"guang",void 0),o([p({type:cc.Node})],t.prototype,"tu",void 0),o([p({type:cc.Node})],t.prototype,"btn1",void 0),o([p({type:cc.Node})],t.prototype,"block_parent",void 0),o([p({type:cc.Prefab})],t.prototype,"block_perfab",void 0),o([p({type:cc.ProgressBar})],t.prototype,"progress",void 0),o([p({type:cc.Label})],t.prototype,"progress_text",void 0),o([p({type:cc.Node})],t.prototype,"progress_niu",void 0),o([p({type:cc.Node})],t.prototype,"isGet",void 0),o([p({type:cc.Node})],t.prototype,"btn",void 0),o([p({type:cc.Node})],t.prototype,"use_btn",void 0),o([p({type:cc.Label})],t.prototype,"theme_unlock",void 0),o([p({type:cc.SpriteFrame})],t.prototype,"use_btn_spf",void 0),o([p({type:cc.Node})],t.prototype,"stage1",void 0),o([p({type:cc.Node})],t.prototype,"stage2",void 0),o([p({type:cc.Label})],t.prototype,"cur",void 0),o([p({type:cc.Node})],t.prototype,"btn2",void 0),o([p({type:cc.Node})],t.prototype,"menu_btn",void 0),o([p({type:cc.Label})],t.prototype,"theme_name",void 0),o([p({type:cc.Node})],t.prototype,"zi_2",void 0),o([p({type:cc.Node})],t.prototype,"huo",void 0),o([p({type:cc.Label})],t.prototype,"time",void 0),o([p({type:cc.Node})],t.prototype,"new",void 0),o([p({type:cc.Label})],t.prototype,"title2",void 0),o([p({type:cc.Label})],t.prototype,"rank",void 0),o([p({type:cc.Node})],t.prototype,"caidai",void 0),o([p({type:cc.Label})],t.prototype,"star_label",void 0),o([p({type:cc.Label})],t.prototype,"star_percent",void 0),o([p({type:cc.Node})],t.prototype,"guan",void 0),o([p({type:cc.Sprite})],t.prototype,"bg_",void 0),o([p({type:cc.Node})],t.prototype,"kuang",void 0),o([p({type:cc.Node})],t.prototype,"kuang_bg",void 0),o([p({type:cc.Node})],t.prototype,"stage_title",void 0),o([u],t)}(s.default);i.default=h,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",block_item_copy:"block_item_copy",skin_ui:"skin_ui"}]},{},["ClientEvent","Config","PlatformApi","PublicMager","Res","BundleMager","HttpRequest","LocalStorage","Pool","SingleBase","Sound","StorageManager","UI","UITools","Utils","ViewBase","ViewSet","PlayerDataConfig","PlayerDataMager","bao_zhu","bing_bao","block_item","block_item_copy","combo_item","delect_effect","level","line","star","Setting","TipItem","TipItem2","get_item_ui","get_star_tip_ui","give_up_ui","item_icon","skin_item","skin_ui","unline_tip_ui","win_ui","GameScene","LoadingResNode","LoadingScene","Main","MainCamera","MainScene","ts"]);