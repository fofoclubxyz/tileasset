window.__require=function e(t,a,i){function n(c,s){if(!a[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+c+"'")}c=r}var d=a[c]={exports:{}};t[c][0].call(d.exports,function(e){return n(t[c][1][e]||e)},d,d.exports,e,t,a,i)}return a[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({BundleMager:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"22d58/roU9NFZicmF0l3UQC","BundleMager"),i=__extends,l=__awaiter,s=__generator,Object.defineProperty(a,"__esModule",{value:!0}),r=e("Res"),n=e("SingleBase"),c=e("Sound"),i(p=function(){var e;return(e=null!==d&&d.apply(this,arguments)||this).autoReleaseNames=[],e.sound_id_arr=[],e.play_audio_id=0,e},d=n.default),p.prototype.preLoadBundle=function(e){for(var t in r.bundlesName)this.loadBundle(r.bundlesName[t],e)},p.prototype.find_bundle=function(e){return cc.assetManager.getBundle(e)},p.prototype.loadBundle=function(e,t,a){var i,n;i=this,void 0===a&&(a=!1),cc.assetManager.loadBundle(e,function(e,t,a,n){return l(i,void 0,void 0,function(){return s(this,function(){return console.log("---------------text:",e),console.log("---------------value:",t),console.log("---------------defaultSelected:",a),console.log("---------------selected:",n),[2]})})},function(a,i){a?console.error("load bundle failed:",e,a):t&&t(i)}),a&&(this.autoReleaseNames.push(e),this.autoReleaseNames.length>2)&&(n=this.autoReleaseNames.shift(),this.removeBundle(n))},p.prototype.get_bundle_sound=function(e,t,a,i){var n;return n=this,void 0===a&&(a=!1),new Promise(function(o){var s;(s=cc.assetManager.getBundle(e))?s.load("sound/"+t,cc.AudioClip,function(e,s){if(s){if(o(s),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(s,a),n.sound_id_arr.push({id:n.play_audio_id,ac:s}),0==a&&setTimeout(function(){n.stop_sound(s)},1e3*s.duration)}else cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(e,t){if(e)i&&i();else{if(o(t),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(t,a),n.sound_id_arr.push({id:n.play_audio_id,ac:t}),0==a&&setTimeout(function(){n.stop_sound(t)},1e3*t.duration)}})}):cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(s,r){if(s)console.error("load bundle failed",e,",",t),i&&i();else{if(o(r),!c.default.get().effect_switch)return;n.play_audio_id=cc.audioEngine.playEffect(r,a),n.sound_id_arr.push({id:n.play_audio_id,ac:r}),0==a&&setTimeout(function(){n.stop_sound(r)},1e3*r.duration)}})})},p.prototype.stop_sound=function(e){for(var t=0;t<this.sound_id_arr.length;t++)this.sound_id_arr[t].ac==e&&(cc.audioEngine.stop(this.sound_id_arr[t].id),this.sound_id_arr.splice(t,1),t--)},p.prototype.get_bundle_bgm=function(e,t,a){var i;return i=this,void 0===a&&(a=!0),new Promise(function(n){var o;(o=cc.assetManager.getBundle(e))?o.load("sound/"+t,cc.AudioClip,function(o,s){if(s){if(n(s),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(s,a)}else cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(o,s){if(o)console.error("load bundle failed",e,",",t);else{if(n(s),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(s,a)}})}):cc.assetManager.getBundle("common").load("sound/"+t,cc.AudioClip,function(o,s){if(o)console.error("load bundle failed",e,",",t);else{if(n(s),c.default.get().now_music=t,!c.default.get().music_switch)return;i.play_audio_id=cc.audioEngine.playMusic(s,a)}})})},p.prototype.get_bundle_texture=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("texture/"+t,cc.SpriteFrame,function(i,n){n?a(n):cc.assetManager.getBundle("common").load("texture/"+t,cc.SpriteFrame,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})}):cc.assetManager.getBundle("common").load("texture/"+t,cc.SpriteFrame,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})})},p.prototype.get_bundle_SkeletonData=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("texture/"+t,sp.SkeletonData,function(i,n){n?a(n):cc.assetManager.getBundle("common").load("texture/"+t,sp.SkeletonData,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})}):cc.assetManager.getBundle("common").load("texture/"+t,sp.SkeletonData,function(i,n){i?console.error("load bundle failed",e,",",t):a(n)})})},p.prototype.get_bundle_prefab=function(e,t){return l(this,void 0,Promise,function(){return s(this,function(){return[2,new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load(t,cc.Prefab,function(e,i){i?a(i):cc.assetManager.getBundle("common").load("prefab/"+t,cc.Prefab,function(e,t){a(e?null:t)})}):cc.assetManager.getBundle("common").load("prefab/"+t,cc.Prefab,function(e,t){a(e?null:t)})})]})})},p.prototype.getDataJson=function(e,t){return new Promise(function(a){cc.assetManager.getBundle(e).load(t,cc.JsonAsset,function(i,n){n?a(n):console.error("load bundle failed",e,",",t)})})},p.prototype.getCsvData=function(e){return new Promise(function(t){var a;(a=cc.assetManager.getBundle("jsonData"))?a.load(e,cc.TextAsset,function(a,i){var n;i?(n=i.text,t(n)):console.error("load bundle failed","jsonData",",",e)}):console.log("csv load failed",e)})},p.prototype.getSkeleton=function(e,t){return new Promise(function(a){var i;(i=cc.assetManager.getBundle(e))?i.load("spine/"+t,sp.SkeletonData,function(e,i){e?console.error(t+" not exist"):a(i)}):console.log("not found bundle:",t)})},p.prototype.removeBundleAsset=function(e,t,a){var i;(i=cc.assetManager.getBundle(e))?i.release(t,a):console.warn("removeBundleAsset bundle:"+e+",not exist")},p.prototype.removeBundle=function(e){var t;(t=cc.assetManager.getBundle(e))?(t.releaseAll(),cc.assetManager.removeBundle(t)):console.warn("removeBundleAsset bundle:"+e+",not exist")},o=p,a.default=o,cc._RF.pop()},{Res:"Res",SingleBase:"SingleBase",Sound:"Sound"}],ClientEvent:[function(e,t,a){"use strict";var i,n,o,c,s;cc._RF.push(t,"947aesipJ9J0LZ1JbGOTdpk","ClientEvent"),i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),a.Event_Key=a._EventTargetMager=void 0,n=(o=cc._decorator).ccclass,o.property,s=function(){},Object.defineProperty(s,"Instace",{get:function(){return this._instace||(this._instace=new cc.EventTarget),this._instace},enumerable:!1,configurable:!0}),c=i([n],s),a._EventTargetMager=c.Instace,(a.Event_Key||(a.Event_Key={})).StartGame="start_game",cc._RF.pop()},{}],Config:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"a32bcSEGOlCjr0F3XpzdyJJ","Config"),Object.defineProperty(a,"__esModule",{value:!0}),a.cRes=a.cPublicMager=a.cBunbleMager=a.pfApi=a.cNodePool=a.cEvent=a.cUI=a.cStorage=a.cSound=void 0,c=e("LocalStorage"),n=e("PlatformApi"),l=e("Pool"),p=e("UI"),o=e("Sound"),r=e("Res"),d=e("BundleMager"),s=e("ClientEvent"),i=e("PublicMager"),a.cSound=o.default.get(),a.cStorage=c.default.get(),a.cUI=p.default.get(),a.cEvent=s._EventTargetMager,a.cNodePool=l.default.get(),a.pfApi=n.default.get(),a.cBunbleMager=d.default.get(),a.cPublicMager=i.default.get(),a.cRes={Sound:r.Sound,Prefab:r.Prefab,Texture:r.Texture,Atlas:r.Atlas,bundlesName:r.bundlesName},cc._RF.pop()},{BundleMager:"BundleMager",ClientEvent:"ClientEvent",LocalStorage:"LocalStorage",PlatformApi:"PlatformApi",Pool:"Pool",PublicMager:"PublicMager",Res:"Res",Sound:"Sound",UI:"UI"}],GameScene:[function(e,t,a){"use strict";cc._RF.push(t,"3e019bOEe5B4p/EsNVnuqpO","GameScene");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0}),a.gameScene=void 0;var o=e("Config"),c=e("PlayerDataConfig"),s=e("PlayerDataMager"),r=e("ViewSet"),l=e("block_item"),d=e("line"),p=e("star"),_=e("bing_bao"),u=e("level"),h=e("item_icon"),f=e("combo_item"),g=cc._decorator,m=g.ccclass,v=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameUI=void 0,t.is_pause=!1,t.bg=void 0,t.bg_skeleton=void 0,t.block_parent=void 0,t.block_prefab=void 0,t.hp_parent=null,t.line_parent=null,t.line_prefab=void 0,t.item_parent=null,t.level_label=null,t.hard_node=null,t.refresh_label=null,t.tip_btn=null,t.delect_prefab=void 0,t.lianji_node=null,t.lianji_label=null,t.lianji_progress=null,t.lianji_effect=null,t.lianji_word=null,t.new_player_prefab=null,t.progress_node=null,t.progress_bar=null,t.tip_ui=null,t.tip_img=void 0,t.tip_btn_fly=void 0,t.tip_word=void 0,t.tip_bg=null,t.tip_skeleton=void 0,t.refresh_btn=null,t.star_pre=null,t.gift_box=null,t.bubble_label=null,t.zui_niu_json=void 0,t.level_json=null,t.map_json=null,t.bing_bao=void 0,t.move_json=null,t.guidao=null,t.setting_btn=null,t.feidan_prefab=null,t.baozha=null,t.item_icon_prefab=null,t.tip_number=0,t.move_time=.51,t.data=[],t.select_block=null,t.hp=3,t.is_over=!1,t.ad_num=0,t.relive_num=3,t.lianji_num=0,t.lianji_time=11,t.zidong_tip_num=3,t.new_player_data=[],t.new_player_node=null,t.new_player_type=-1,t.jishi_time=0,t.level_data=null,t.map_data=[],t.out_id=[],t.xiao_window=!1,t.shipei_scale=1,t.xun_huan_block_arr=[],t.xunhuan_move=!1,t.zhiwan=!1,t.win_bool=!1,t.move_data=[],t.moving=!1,t.ad_star=0,t.level_script=null,t.delect_effect=null,t.delect_music=null,t.bgm=null,t.fly_item=null,t.touch_effect=null,t.move_end_effect=null,t.new_block_effect=null,t.new_block_end_effect=null,t.touch_effectt=null,t.fanpai_effect=null,t.jianting_=null,t.zhiwan_daojishi=20149,t.zhiwan_in=!1,t.xunhuan_=[11,70],t.xunhuan_zuiniu=[0,34],t.last_dian=null,t.onen_touch_fun_=null,t.dian=!1,t.xiaochu_cishu=0,t.un_move_arr=[],t.move_block_data=[],t.zhiwan_bool=!1,t.moving_block=[],t.now_finish_level=0,t.tip_block=[],t.tip_bool=!0,t.zidong_tip_block=[],t.item_y=0,t.zidong=!1,t}return i(t,e),t.prototype.onLoad=function(){a.gameScene=this},t.prototype.initScene=function(){},t.prototype.update=function(){},t.prototype.onDestroy=function(){o.cUI.removeAllLayer()},t.prototype.pauseGame=function(){this.is_pause=!0,o.cSound.stopMusic(),this.node.pauseAllActions()},t.prototype.resumeGame=function(){this.is_pause=!1,o.cSound.resumeMusic(),this.node.resumeAllActions()},t.prototype.gameResult=function(){this.is_pause=!0,this.unscheduleAllCallbacks()},t.prototype.onBtnSetting=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cUI.addLayer(o.cRes.Prefab.setting)},t.prototype.onBtnTheme=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cUI.addLayer(o.cRes.Prefab.skin_ui)},t.prototype.returnMainScene=function(){o.cUI.addScene(o.cRes.Prefab.main_scene).then(function(){o.cUI.removeAllLayer()})},t.prototype.start=function(){this.init(),this.setting_btn.zIndex=2,this.tip_ui.zIndex=2},t.prototype.init=function(){var e=this;if(this.new_player_node&&(this.new_player_node.destroy(),this.new_player_node=null),o.cSound.stopMusic(),this.select_block=null,this.level_data=null,this.map_data=null,this.win_bool=!1,this.xun_huan_block_arr=[],this.hp=3,this.show_hp(),this.show_item_fun(),this.is_over=!1,this.ad_num=-1,this.relive_num=3,this.xiaochu_cishu=0,this.un_move_arr=[],this.move_data=[],this.tip_number=0,this.level_label.string="Level"+(s._p_data._data.level+1),1==o.cPublicMager.is_zui_niu){var t=new Date;this.level_label.string=t.getMonth()+1+"-"+t.getDate()}if(this.show_shuaxin_num(),cc.Tween.stopAllByTarget(this.lianji_node),this.lianji_node.x=448.5,this.lianji_num=0,this.lianji_node.active=!1,o.cPublicMager.first_unlock_zuiniu=!1,this.line_parent.destroyAllChildren(),this.moving=!1,this.level_script=null,o.cPublicMager.config.ad_star&&(this.ad_star=o.cPublicMager.config.ad_star),this.init_level_script(),this.new_data(),this.new_block(),this.show_bg(),this.unschedule(this.jishi_fun),this.jishi_start(),this.zidong_tip_num=3,0==s._p_data._data.level&&(this.zidong_tip_num=25),this.zidong_tip(),this.hide_qipao(),cc.sys.isBrowser){var a=this.item_parent.getComponent(cc.Widget);a.bottom=20,a.updateAlignment()}1==o.cPublicMager.zidong&&(t=4,this.level_data.moveType>0&&(t=6),this.scheduleOnce(function(){e.zidong_game()},t)),this.move_block_data=[];for(var i=0;i<this.data.length;i++)for(var n=0;n<this.data[i].length;n++)this.move_block_data[this.data[i][n].tag]=[];if(this.tip_btn.active=!1,0!=this.level_data.moveType&&-1!=this.level_data.moveType){var c=this.tip_btn.getChildByName("icon").getComponent(cc.Sprite);o.cUI.getTexture("texture/dir/"+this.level_data.moveType).then(function(e){c.spriteFrame=e})}this.show_jindu(),this.jixing()},t.prototype.init_level_script=function(){this.delect_effect=this.delect_prefab,this.delect_music="effect/cleanup",this.bgm="effect/gamebgm",this.fly_item=this.star_pre,this.touch_effect="effect/click_block",this.move_end_effect="effect/move_end",this.new_block_effect="effect/block_create",this.new_block_end_effect="effect/block_create_end",this.fanpai_effect="effect/flip",this.touch_effectt=this.lianji_effect,this.load_level_script()},t.prototype.load_level_script=function(){for(var e=this.node.getComponents(u.default),t=0;t<e.length;t++)e[t].destroy()},t.prototype.jianting=function(){this.jixing();var e=cc.view.getCanvasSize();e.width>e.height?this.level_label.node.parent.scale=.4:this.level_label.node.parent.scale=1},t.prototype.jixing=function(){var e=cc.view.getCanvasSize(),t=e.height/e.width;t<1.9333333333333333?(this.block_parent.y=30,this.shipei_scale=t/1.9933333333333334,this.xiao_window=!0,this.item_parent.getComponent(cc.Widget).bottom=20,this.item_parent.getComponent(cc.Widget).updateAlignment()):this.shipei_scale=1,this.block_parent.scale=this.shipei_scale,this.item_parent.scale=this.shipei_scale},t.prototype.show_jindu=function(){var e=this.return_jindu(),t=e.number,a=e.max,i=(t/a*100).toFixed();this.progress_node.string=i+"%",this.progress_bar.progress=t/a},t.prototype.return_jindu=function(){for(var e=0,t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)(this.data[t][a].id>=0||-3==this.data[t][a].id)&&e++;var i=0;for(t=0;t<this.map_data.length;t++)for(a=0;a<this.map_data[t].length;a++)(this.map_data[t][a]>=0||-3==this.map_data[t][a])&&i++;return{number:e=i-e,max:i}},t.prototype.jishi_start=function(){this.jishi_time=0,this.schedule(this.jishi_fun,1)},t.prototype.jishi_fun=function(){this.jishi_time++},t.prototype.show_bg=function(){var e=this;o.cBunbleMager.get_bundle_texture("level_"+s._p_data._data.theme,"bg"+s._p_data._data.theme).then(function(t){e.bg.spriteFrame=t}),o.cBunbleMager.get_bundle_SkeletonData("level_"+s._p_data._data.theme,"bg"+s._p_data._data.theme+"/bg"+s._p_data._data.theme).then(function(t){e.bg_skeleton.skeletonData=t,e.bg_skeleton.setAnimation(0,"idle",!0)});var t=cc.winSize.height/1700;this.bg.node.scale=t},t.prototype.switchSkin=function(){this.show_bg();for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)this.data[e][t].id>=0&&this.data[e][t].block_node.getComponent(l.default).switchSkin()},t.prototype.onDisable=function(){s._p_data.close()},t.prototype.show_hp=function(){for(var e=this.hp_parent.children,t=0;t<e.length;t++)e[t].active=t<this.hp;this.hp<=0&&this.gameOver()},t.prototype.show_qipao=function(){var e=this,t=Math.floor(3*Math.random()),a=this.bubble_label.node.parent;switch(this.find_can_line()||(t=1),t){case 0:this.bubble_label.string="Check the Hint";break;case 1:this.bubble_label.string="Try Refreshing";break;case 2:this.bubble_label.string="Random Clear"}a.scale=0,a.active=!0;var i=this.item_parent.children[t].convertToWorldSpaceAR(cc.v2(0,0)),n=a.parent.convertToNodeSpaceAR(i);a.setPosition(n),a.y+=55;var o=1;a.x>0?(o=-1,this.bubble_label.node.scaleX=-1):this.bubble_label.node.scaleX=1,cc.Tween.stopAllByTarget(a),cc.tween(a).to(.3,{scaleX:o,scaleY:1},{easing:"backOut"}).call(function(){cc.tween(a).to(1,{scaleX:1.1*o,scaleY:1.1}).to(1,{scaleX:o,scaleY:1}).union().repeatForever().start()}).start(),1==this.xiao_window&&this.scheduleOnce(function(){e.hide_qipao()},3)},t.prototype.hide_qipao=function(){this.unschedule(this.show_qipao);var e=this.bubble_label.node.parent;cc.Tween.stopAllByTarget(e),e.active=!1},t.prototype.new_data=function(){var e,t;if(e=o.cPublicMager.level_data?JSON.parse(JSON.stringify(o.cPublicMager.level_data)):JSON.parse(JSON.stringify(this.level_json.json)),this.level_data=e["level_"+(s._p_data._data.level+1)],!this.level_data){for(var a={},i=0,n=this.xunhuan_[0];n<=Object.keys(e).length;n++)a["level_"+n]=e["level_"+n],i++;var r=s._p_data._data.level+1-Object.keys(e).length;console.log("max level",r,",",i,s._p_data._data.level),t=r%i+this.xunhuan_[0],console.log("cur level",t),this.level_data=a["level_"+t]}if(!this.level_data){var l=JSON.parse(JSON.stringify(this.level_json.json)),d=Math.floor(Math.random()*(Object.keys(l).length-this.xunhuan_[0])+this.xunhuan_[0]);this.level_data=l["level_"+d]}if(o.cPublicMager.map_data?o.cPublicMager.map_data["id"+this.level_data.mapId]&&(this.map_data=JSON.parse(JSON.stringify(o.cPublicMager.map_data["id"+this.level_data.mapId]))):this.map_json.json["id"+this.level_data.mapId]&&(this.map_data=JSON.parse(JSON.stringify(this.map_json.json["id"+this.level_data.mapId]))),!this.map_data)for(this.map_data=[],n=0;n<14;n++){for(var p=[],_=0;_<8;_++)p.push(0);this.map_data.push(p)}for(n=0;n<this.level_data.obstacle.length;n++)for(_=0;_<this.level_data.obstacle[n][1];_++){var u=Math.floor(14*Math.random()),h=Math.floor(8*Math.random());0==this.map_data[u][h]?this.map_data[u][h]=this.level_data.obstacle[n][0]:_--}this.data=[];var f=[];for(n=0;n<this.level_data.num;n++)f.push(n);var g=[];for(n=0;n<this.level_data.num;n++){var m=Math.floor(Math.random()*f.length);g.push(f[m]),f.splice(m,1)}var v=[],y=0;for(n=0;n<16;n++){var b=[];for(_=0;_<10;_++){var w=new c.block_data;w.pos.x=n,w.pos.y=_,w.tag=y,b.push(w),y++}v.push(b)}for(n=0;n<this.map_data.length;n++)for(_=0;_<this.map_data[n].length;_++)-8==this.map_data[n][_]&&(this.map_data[n][_]=0,v[n+1][_+1].is_tengman=!0),-11==this.map_data[n][_]&&(this.map_data[n][_]=0,v[n+1][_+1].is_yun=!0);var k=[],S=0;for(n=0;n<this.map_data.length;n++)for(_=0;_<this.map_data[n].length;_++)this.map_data[n][_]>0&&(k[this.map_data[n][_]]||(k[this.map_data[n][_]]=[]),k[this.map_data[n][_]].push(-1)),0!=this.map_data[n][_]&&-3!=this.map_data[n][_]||S++;for(n=0;n<k.length;n++)if(k[n])for(i=g[m=Math.floor(Math.random()*g.length)],g.splice(m,1),_=0;_<k[n].length;_++)k[n][_]=i;var M=[],x=S/2,P=0;for(n=0;n<x;n++)g[n]?M.push(g[n]):P++;var C=[],R=Math.floor(g.length*this.level_data.rate);for(R<1&&(R=1),n=0;n<R;n++)i=g[m=Math.floor(Math.random()*g.length)],g.splice(m,1),C.push(i);for(n=0;n<P;n++)t=(n+1)%C.length,M.push(C[t]);var T=M.length;for(n=0;n<T;n++)M.push(M[n]);for(n=0;n<M.length;n++)for(_=n+1;_<M.length;_++){var O=M[m=Math.floor(Math.random()*M.length)];M[m]=M[_],M[_]=O}for(n=1;n<v.length-1;n++)for(_=1;_<v[n].length-1;_++)(i=this.map_data[n-1][_-1])<0&&-3!=i?v[n][_].id=i:0==i||-3==i?(v[n][_].id=M[0],M.splice(0,1)):(v[n][_].id=k[i][0],k[i].splice(0,1));var F=[],I=[];for(n=1;n<v.length-1;n++)for(_=1;_<v[n].length-1;_++)0==this.map_data[n-1][_-1]&&(F[v[n][_].id]||(F[v[n][_].id]={block_arr:[],num:0}),F[v[n][_].id].num++,I.push(v[n][_]));for(n=1;n<v.length-1;n++)for(_=1;_<v[n].length-1;_++)if(0==this.map_data[n-1][_-1])for(var N=0;N<F.length;N++)F[N]&&F[N].block_arr.push(v[n][_]);if(this.level_data.distr>0)for(n=0;n<F.length;n++)if(F[n])for(_=0;_<F[n].num;_++){var A=F[n].block_arr;if(j=A[m=Math.floor(Math.random()*A.length)]){A.splice(m,1);var B=I.indexOf(j);-1!=m&&I.splice(B,1)}else j=I[m=Math.floor(Math.random()*I.length)],I.splice(m,1);for(j.id=n,N=0;N<A.length;N++)Math.abs(j.pos.x-A[N].pos.x)+Math.abs(j.pos.y-A[N].pos.y)<this.level_data.distr&&(A.splice(N,1),N--);for(N=0;N<F.length;N++)if(F[N])for(var E=0;E<F[N].block_arr.length;E++){var D=F[N].block_arr.indexOf(j);-1!=D&&F[N].block_arr.splice(D,1)}}for(n=1;n<v.length-1;n++)for(_=1;_<v[n].length-1;_++)-3==this.map_data[n-1][_-1]&&(this.out_id.push(v[n][_].id),v[n][_].id=-3);if(this.data=v,this.move_json.json["id"+this.level_data.moveType])this.move_data=JSON.parse(JSON.stringify(this.move_json.json["id"+this.level_data.moveType]));else if(-6==this.level_data.moveType)for(n=1;n<this.data.length-1;n++)for(_=1;_<this.data[n].length-1;_++){var j=this.data[n][_];this.data[j.pos.x][j.pos.y-1].pos.y>0&&(j.next_block=this.data[j.pos.x][j.pos.y-1],this.data[j.pos.x][j.pos.y-1].last_block=j)}for(n=0;n<v.length;n++)for(_=0;_<v[n].length;_++)if(-10==v[n][_].id)for(N=0;N<3;N++)for(E=0;E<3;E++)this.move_data[n-N]&&this.move_data[n-N][_-E]&&(this.move_data[n-N][_-E]=0);this.difficulty_control(!0),this.move_link()},t.prototype.move_link=function(){for(var e=0;e<this.move_data.length;e++)for(var t=0;t<this.move_data[e].length;t++){var a=this.data[e+1][t+1];switch(this.move_data[e][t]){case 1:this.data[a.pos.x][a.pos.y-1].pos.y>0&&(a.next_block=this.data[a.pos.x][a.pos.y-1],this.data[a.pos.x][a.pos.y-1].last_block=a);break;case 2:this.data[a.pos.x][a.pos.y+1].pos.y<this.data[e].length-1&&(a.next_block=this.data[a.pos.x][a.pos.y+1],this.data[a.pos.x][a.pos.y+1].last_block=a);break;case 3:this.data[a.pos.x-1][a.pos.y].pos.x>0&&(a.next_block=this.data[a.pos.x-1][a.pos.y],this.data[a.pos.x-1][a.pos.y].last_block=a);break;case 4:this.data[a.pos.x+1][a.pos.y].pos.x<this.data.length-1&&(a.next_block=this.data[a.pos.x+1][a.pos.y],this.data[a.pos.x+1][a.pos.y].last_block=a)}}var i=[];for(e=0;e<this.data.length;e++)for(t=0;t<this.data[e].length;t++)if(-1==i.indexOf(this.data[e][t])){i.push(this.data[e][t]);var n=[this.data[e][t]];a=this.data[e][t];for(var o=!1;a.next_block;)if(n.push(a.next_block),i.push(a.next_block),a=a.next_block,-1!=n.indexOf(a.next_block)){o=!0;break}1==o&&this.xun_huan_block_arr.push(n)}},t.prototype.sisuo=function(){var e=Math.floor(Math.random()*(this.data.length-3)+1),t=Math.floor(Math.random()*(this.data[0].length-3)+1),a=this.data[e][t],i=this.data[e][t+1];if(a.id!=i.id&&-1!=a.id&&-1!=i.id){var n=this.data[e+1][t],o=this.data[e+1][t+1],c=[a.id,i.id],s=[n.id,o.id];n.id=i.id,o.id=a.id;for(var r=0;r<c.length;r++)for(var l=!1,d=1;d<this.data.length-1;d++){for(var p=1;p<this.data[d].length-1;p++)if(this.data[d][p].id==c[r]&&this.data[d][p].tag!=a.tag&&this.data[d][p].tag!=i.tag&&this.data[d][p].tag!=n.tag&&this.data[d][p].tag!=o.tag){this.data[d][p].id=s[r],l=!0;break}if(1==l)break}var _=[];for(r=0;r<27;r++)r!=c[0]&&r!=c[1]&&_.push(r);var u=Math.floor(Math.random()*_.length),h=Math.floor(Math.random()*_.length);for(r=0;r<this.data.length;r++)for(d=0;d<this.data[r].length;d++)this.data[r][d].tag!=a.tag&&this.data[r][d].tag!=i.tag&&this.data[r][d].tag!=n.tag&&this.data[r][d].tag!=o.tag&&(this.data[r][d].id==c[0]&&(this.data[r][d].id=_[u]),this.data[r][d].id==c[1]&&(this.data[r][d].id=_[h]));var f=[];for(r=0;r<this.data.length;r++)for(d=0;d<this.data[r].length;d++){var g=this.data[r][d],m=-1;for(p=0;p<f.length;p++)if(f[p].id==g.id){m=p;break}-1==m?f.push({id:g.id,num:1}):f[m].num+=1}}else this.sisuo()},t.prototype.new_block=function(){var e=this;this.block_parent.destroyAllChildren();for(var t=this.data.length*this.block_prefab.data.height/2-50,a=-this.data[0].length*this.block_prefab.data.width/2+this.block_prefab.data.width/2,i=[],n=0;n<this.data.length;n++)for(var c=0;c<this.data[n].length;c++){i.push(this.data[n][c]);var r=cc.instantiate(this.block_prefab);r.parent=this.block_parent,r.y=t-n*r.height,r.x=a+c*r.width,r.getComponent(l.default).init(this.data[n][c],this.on_block.bind(this)),this.data[n][c].block_node=r,r.scale=0}this.is_pause=!0;var d=o.cPublicMager.card_play_order["id"+this.level_data.moveType],p=.04;1==o.cPublicMager.is_zui_niu&&(d=o.cPublicMager.card_play_order.id5,p=.04),d||(d=o.cPublicMager.card_play_order.id5);var _=0,u=function(t){_+=p;for(var a=function(a){h.scheduleOnce(function(){i[d[t][a]].fun_show_chuchang(),t==d.length-1&&a==d[t].length-1&&e.scheduleOnce(function(){o.cSound.playEffect(e.new_block_end_effect),e.is_pause=!1;for(var t=0;t<d.length;t++)for(var a=0;a<d[t].length;a++)i[d[t][a]].fun_show_chuchang(.2);if(e.scheduleOnce(function(){o.cSound.playMusic(e.bgm),e.show_tip_ui(e.player_can_play.bind(e))},.5),1==s._p_data._data.new_player){e.new_player_type=0,e.new_player_node=cc.instantiate(e.new_player_prefab),e.new_player_node.parent=e.node;var n=e.find_can_line();e.new_player_data.push(n.data1),e.new_player_data.push(n.data2),e.show_new_player(n.data1.block_node)}},.2)},_)},n=0;n<d[t].length;n++)a(n);p*=.98},h=this;for(n=0;n<d.length;n++)u(n);o.cSound.playEffect(this.new_block_effect),this.gra_duigdao()},t.prototype.compute_dir=function(e,t){var a=0,i=1;return e.y==t.y&&e.x!=t.x&&(a=1,e.x<t.x&&(i=-1)),e.x==t.x&&e.y!=t.y&&(a=2,e.y>t.y&&(i=-1)),{dir:a,dir2:i}},t.prototype.gra_duigdao=function(){this.guidao.clear();for(var e=-1,t=-1,a=0,i=0;i<this.xun_huan_block_arr.length;i++){var n=this.xun_huan_block_arr[i][0].block_node.convertToWorldSpaceAR(cc.v2(0,0)),o=this.guidao.node.convertToNodeSpaceAR(n);this.guidao.moveTo(o.x,o.y);for(var c=this.xun_huan_block_arr[i][0].pos,s=o,r=1;r<this.xun_huan_block_arr[i].length;r++){var l=this.xun_huan_block_arr[i][r];-1!=e&&(t=e);var d=this.compute_dir(c,l.pos);e=d.dir,a=d.dir2,1==r&&(1==e&&(a>0?this.guidao.moveTo(s.x,s.y+4.5):this.guidao.moveTo(s.x,s.y-4.5)),2==e&&(a>0?this.guidao.moveTo(s.x+4.5,s.y):this.guidao.moveTo(s.x-4.5,s.y)));var p=l.block_node.convertToWorldSpaceAR(cc.v2(0,0)),_=this.guidao.node.convertToNodeSpaceAR(p);-1!=t&&t!=e&&(2==e&&(_.x>s.x?this.guidao.moveTo(s.x+4.5,s.y):this.guidao.moveTo(s.x-4.5,s.y)),1==e&&(_.y>s.y?this.guidao.moveTo(s.x,s.y+4.5):this.guidao.moveTo(s.x,s.y-4.5))),this.guidao.lineTo(_.x,_.y),this.guidao.moveTo(_.x,_.y),r+1<this.xun_huan_block_arr[i].length&&(1==e&&this.xun_huan_block_arr[i][r+1].pos.y!=l.pos.y&&this.guidao.lineTo(_.x,_.y+4.5*a),2==e&&this.xun_huan_block_arr[i][r+1].pos.x!=l.pos.x&&this.guidao.lineTo(_.x+4.5*a,_.y)),this.guidao.moveTo(_.x,_.y),c=l.pos,s=_}1==e?this.guidao.lineTo(o.x,o.y+4.5*a):this.guidao.lineTo(o.x+4.5*a,o.y)}this.guidao.stroke(),this.guidao.fill()},t.prototype.player_can_play=function(){for(var e=this,t=function(t){for(var i=function(i){a.scheduleOnce(function(){cc.tween(e.xun_huan_block_arr[t][i].block_node).to(.07,{scale:1.2}).to(.07,{scale:1}).start()},.02*i)},n=0;n<a.xun_huan_block_arr[t].length;n++)i(n)},a=this,i=0;i<this.xun_huan_block_arr.length;i++)t(i)},t.prototype.open_touch_fun=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)this.data[e][t].on_bool=!0},t.prototype.on_block=function(e){var t=this;if(1!=this.is_over&&1!=this.is_pause&&0!=e.on_bool&&1!=this.xunhuan_move&&-1==[-1,-2,-3,-4,-5,-6,-7,-10,-11].indexOf(e.id)&&1!=e.is_tengman&&1!=e.is_yun)if(this.unschedule(this.onen_touch_fun_),this.onen_touch_fun_=this.open_touch_fun.bind(this),this.scheduleOnce(this.onen_touch_fun_,5),o.cSound.playEffect(this.touch_effect),this.unschedule(this.dian_jishi),this.scheduleOnce(this.dian_jishi,.5),e==this.last_dian&&(this.doudong_same(e),this.scheduleOnce(function(){t.last_dian=null})),this.last_dian=e,this.dian=!0,this.select_block){if(this.select_block==e)return this.select_block.fun_hide_select(),void(this.select_block=null);e.fun_show_select();var a=this.check_delect(this.select_block,e);a?this.delect([a.data1,a.data2],a.lian):this.select_block.id==e.id?(this.error_select(this.select_block,e),this.select_block=null):(this.select_block.fun_hide_select(),this.select_block=e,this.select_block.fun_show_select()),1==this.new_player_type&&this.new_player_node&&cc.isValid(this.new_player_node)&&(this.new_player_node.destroy(),this.new_player_node=null,this.new_player_type=-1,s._p_data._data.new_player=!1,s._p_data.saveData())}else this.select_block=e,e.fun_show_select(),this.new_player_node&&this.finish_new_player(0,this.new_player_data[1].block_node)},t.prototype.doudong_same=function(e){if(1==this.dian){o.pfApi.vibrateShort();for(var t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)this.data[t][a].id==e.id&&this.data[t][a].fun_show_doudong();this.dian=!1}},t.prototype.dian_jishi=function(){this.dian=!1,this.last_dian=null},t.prototype.check_delect=function(e,t){if(e.id!=t.id)return null;if(-2==e.id||-2==t.id)return null;if(-4!=e.id&&-5!=e.id&&-6!=e.id&&-7!=e.id&&-10!=e.id&&-11!=e.id){var a=[],i=this.round_ray(e,t),n=this.round_ray(t,e);if(-1!=i.indexOf(t))return a.push(e,t),{data1:e,data2:t,lian:a};for(var o=null,c=0;c<i.length;c++)if(-1!=n.indexOf(i[c])){o=i[c];break}if(o)return a.push(e,o,t),{data1:e,data2:t,lian:a};var s=null,r=null,l=!1;for(c=0;c<i.length;c++){for(var d=0;d<n.length;d++){if(i[c].pos.x==n[d].pos.x){if((h=i[c].pos.y)>(f=n[d].pos.y)){var p=h;h=f,f=p}for(var _=!0,u=h+1;u<f;u++)if(-1!=this.data[i[c].pos.x][u].id){_=!1;break}if(1==_){l=!0,s=i[c],r=n[d];break}}if(i[c].pos.y==n[d].pos.y){var h,f;for((h=i[c].pos.x)>(f=n[d].pos.x)&&(p=h,h=f,f=p),_=!0,u=h+1;u<f;u++)if(-1!=this.data[u][i[c].pos.y].id){_=!1;break}if(1==_){l=!0,s=i[c],r=n[d];break}}}if(1==l)break}return 1==l?(a.push(e,s,r,t),{data1:e,data2:t,lian:a}):null}},t.prototype.check_line=function(e,t){var a=[],i=this.round_ray(e,t),n=this.round_ray(t,e);if(-1!=i.indexOf(t))return a.push(e,t),{data1:e,data2:t,lian:a};for(var o=null,c=0;c<i.length;c++)if(-1!=n.indexOf(i[c])){o=i[c];break}if(o)return a.push(e,o,t),{data1:e,data2:t,lian:a};var s=null,r=null,l=!1;for(c=0;c<i.length;c++){for(var d=0;d<n.length;d++){if(i[c].pos.x==n[d].pos.x){if((h=i[c].pos.y)>(f=n[d].pos.y)){var p=h;h=f,f=p}for(var _=!0,u=h+1;u<f;u++)if(-1!=this.data[i[c].pos.x][u].id){_=!1;break}if(1==_){l=!0,s=i[c],r=n[d];break}}if(i[c].pos.y==n[d].pos.y){var h,f;for((h=i[c].pos.x)>(f=n[d].pos.x)&&(p=h,h=f,f=p),_=!0,u=h+1;u<f;u++)if(-1!=this.data[u][i[c].pos.y].id){_=!1;break}if(1==_){l=!0,s=i[c],r=n[d];break}}}if(1==l)break}return 1==l?(a.push(e,s,r,t),{data1:e,data2:t,lian:a}):null},t.prototype.delect=function(e,t,a){var i=this;this.last_dian=null,this.xiaochu_cishu++;for(var n=[],c=e[0].id,r=0;r<e.length;r++){-9==e[r].id&&n.push(e[r]),e[r].id=-1,e[r].fun_show_delete();var l=e[r].block_node.convertToWorldSpaceAR(cc.v2(0,0)),p=this.node.convertToNodeSpaceAR(l),_=cc.instantiate(this.delect_effect);_.parent=this.node,_.setPosition(p),this.level_script&&this.level_script.delect_block(e[r],c)}n.length>0&&this.feidan(n);var u=this.get_week(e),h=this.active_block(u),f=h.delect_arr;for(r=0;r<e.length;r++)f.push(e[r]);var g=[],m=[],v=[];for(r=0;r<f.length;r++){for(var y=f[r],b=0;b<1&&-1==v.indexOf(y)&&(v.push(y),y.next_block);)y=y.next_block;-1==m.indexOf(y)&&m.push(y)}var w=[];if(a)for(r=0;r<a.length;r++)w.push(a[r]);for(r=0;r<f.length;r++)w.push(f[r]);for(r=0;r<h.can_move.length;r++)w.push(h.can_move[r]);var k=[];for(r=0;r<m.length;r++){var S=m[r];for(b=0;b<1&&-1==k.indexOf(S)&&(k.push(S),g.push(S),S.on_bool=!1,S.last_block);)S=S.last_block}if(this.un_move_arr.push({xiaochu_cishu:this.xiaochu_cishu,arr:g}),this.select_block&&(this.select_block=null),o.pfApi.vibrateShort(),t){var M=cc.instantiate(this.line_prefab);M.parent=this.line_parent,M.getComponent(d.default).init(t),this.scheduleOnce(function(){i.level_script?i.level_script.show_fly_item(t,c):i.show_fly_item(t,c)},.3)}if(1==this.check_win())this.is_over=!0,this.scheduleOnce(function(){i.win_fun()},.5);else{if(1==this.is_over)return;this.check_move(w,this.xiaochu_cishu)}for(r=0;r<this.tip_block.length;r++)this.tip_block[r].fun_hide_tip();for(this.tip_block=[],r=0;r<this.zidong_tip_block.length;r++)this.zidong_tip_block[r].fun_hide_tip();this.zidong_tip_block=[],this.lianji_num++,this.init_lianji(c,e[e.length-1]);var x=this.lianji_num;if(x>8&&(x=8),this.scheduleOnce(function(){o.cSound.playEffect(i.delect_music)},.2),this.zidong_tip(),1==s._p_data._data.level){var P=this.xiaochu_cishu.toString();this.xiaochu_cishu<10&&(P="0"+P)}this.hide_qipao(),0==this.is_over&&this.scheduleOnce(this.show_qipao,7)},t.prototype.get_week=function(e){for(var t=[],a=0;a<e.length;a++){var i=[];this.data[e[a].pos.x-1]&&this.data[e[a].pos.x-1][e[a].pos.y]&&i.push(this.data[e[a].pos.x-1][e[a].pos.y]),this.data[e[a].pos.x+1]&&this.data[e[a].pos.x+1][e[a].pos.y]&&i.push(this.data[e[a].pos.x+1][e[a].pos.y]),this.data[e[a].pos.x][e[a].pos.y-1]&&i.push(this.data[e[a].pos.x][e[a].pos.y-1]),this.data[e[a].pos.x][e[a].pos.y+1]&&i.push(this.data[e[a].pos.x][e[a].pos.y+1]);for(var n=0;n<i.length;n++)-1==t.indexOf(i[n])&&-1==e.indexOf(i[n])&&t.push(i[n])}return t},t.prototype.active_block=function(e){for(var t=this,a=!1,i=[],n=[],c=function(c){if(-4==e[c].id||-5==e[c].id||-6==e[c].id){var r=e[c].id;s.scheduleOnce(function(){o.cSound.playEffect("effect/snow_break");var a=e[c].block_node.convertToWorldSpaceAR(cc.v2(0,0)),i=t.node.convertToNodeSpaceAR(a),n=cc.instantiate(t.bing_bao);if(n.parent=t.node,n.setPosition(i),n.getComponent(_.default).init(r),-5==r||-6==r){var s=e[c].block_node.getComponent(l.default).block;cc.Tween.stopAllByTarget(s),cc.tween(s).to(.02,{angle:15}).to(.04,{angle:-15}).to(.02,{angle:0}).start(),e[c].init_view()}else-4==r&&e[c].fun_show_delete(!1,0,.1)},.35)}-3==e[c].id?(0==a&&(a=!0,o.cSound.playEffect(s.fanpai_effect)),e[c].id=s.out_id[0],s.out_id.shift(),e[c].fun_show_fanmian()):-6==e[c].id?e[c].id=-5:-5==e[c].id?e[c].id=-4:-4==e[c].id?(i.push(e[c]),e[c].id=-1):1==e[c].is_tengman&&(n.push(e[c]),e[c].fun_un_lock())},s=this,r=0;r<e.length;r++)c(r);return n.length>0&&this.scheduleOnce(function(){o.cSound.playEffect("effect/vine_effect")},.35),{delect_arr:i,can_move:n}},t.prototype.show_fly_item=function(e,t){if(e.length<3){var a=(e[0].block_node.x+e[1].block_node.x)/2,i=(e[0].block_node.y+e[1].block_node.y)/2,n=e[0].block_node.x-a,o=e[0].block_node.y-i;(r=cc.instantiate(this.fly_item)).parent=this.node;var c=e[0].block_node.convertToWorldSpaceAR(cc.v2(-n,-o));r.getComponent(p.default).init(c,t)}else for(var s=1;s<e.length-1;s++){var r;c=e[s].block_node.convertToWorldSpaceAR(cc.v2(0,0)),(r=cc.instantiate(this.fly_item)).parent=this.node,r.getComponent(p.default).init(c,t)}},t.prototype.init_lianji=function(e,t){var a=11;if(this.lianji_num>5&&(a=6),this.unschedule(this.lianji_jishi),this.scheduleOnce(this.lianji_jishi,a),this.level_script&&1==this.level_script.effect_label_bool){var i=t.block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.convertToNodeSpaceAR(i);(o=cc.instantiate(this.touch_effectt)).parent=this.node,o.setPosition(n),o.getComponent(f.default).init(e)}else if(t&&this.lianji_num>2){var o;i=t.block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.convertToNodeSpaceAR(i),(o=cc.instantiate(this.touch_effectt)).parent=this.node,o.setPosition(n),o.getComponent(f.default).init(this.lianji_num)}},t.prototype.lianji_jishi=function(){this.lianji_num=0},t.prototype.check_move=function(e,t){for(var a=[],i=[],n=0,o=[],c=0;c<e.length;c++){for(var s=e[c],r=0;r<1;){if(++n>1e3)return;if(i.push(s),!s.next_block)break;if(-1!=i.indexOf(s.next_block)){o.push(s);break}s=s.next_block}-1==a.indexOf(s)&&a.push(s)}var l=[],d=[-2,-4,-5,-6],p=[];for(c=0;c<a.length;c++){var _=0,u=a[c];for(r=0;r<1&&-1==p.indexOf(u);){if(p.push(u),-1!=d.indexOf(u.id)&&(_=0),-1==u.id)_++;else{var h=_;-1!=o.indexOf(a[c])&&(h=1),h>0&&l.push({data:u,num:h})}if(!u.last_block)break;u=u.last_block}}this.move_block(l,t)},t.prototype.move_block=function(e,t){for(var a=this,i=[],n=0;n<e.length;n++){for(var o=e[n].data,c=e[n].data,s=0;s<e[n].num;s++)c=c.next_block;i.push({target:o,start:c,num:e[n].num})}var r=[];for(n=0;n<i.length;n++){var d=i[n].start.id;i[n].start.id=i[n].target.id,i[n].target.id=d;var p=i[n].start.is_tengman;i[n].start.is_tengman=i[n].target.is_tengman,i[n].target.is_tengman=p,i[n].start.fun_hide_select(),i[n].target.fun_hide_select();var _=!1;n==i.length-1&&(_=!0);var u={start:i[n].start,target:i[n].target,id:i[n].start.id,bool:_,num:i[n].num};this.move_block_data[i[n].start.tag]||(this.move_block_data[i[n].start.tag]=[]),this.move_block_data[i[n].start.tag].push(u),r.push(u.start)}i.length<1?this.can_move(t):this.moving=!0;var h=function(e){var n=f.move_block_data[i[e].start.tag][0],o=-1;f.move_block_data[i[e].target.tag][0]&&(o=r.indexOf(f.move_block_data[i[e].target.tag][0].start));for(var c=-1,s=0;s<f.moving_block.length;s++)if(f.moving_block[s]==n.target){c=e;var d=n.start.block_node.getComponent(l.default);d.scheduleOnce(d.no_move_yincang,f.move_time);break}-1==o&&0!=f.move_block_data[i[e].target.tag].length||-1!=c||(n.target.block_node.getComponent(l.default).move_id=n.start.id,f.scheduleOnce(function(){a.move_fun(n,t)},f.move_time))},f=this;for(n=0;n<i.length;n++)h(n);this.test_link_ui()},t.prototype.test_link_ui=function(){var e=this;this.find_can_line()||0!=this.is_pause||this.scheduleOnce(function(){e.is_over||(o.cPublicMager.is_zui_niu,o.cUI.addLayer(o.cRes.Prefab.unline_tip_ui))},.5)},t.prototype.can_move=function(e){for(var t=0;t<this.un_move_arr.length;t++)if(this.un_move_arr[t].xiaochu_cishu==e){for(var a=0;a<this.un_move_arr[t].arr.length;a++)this.un_move_arr[t].arr[a].on_bool=!0;this.un_move_arr.splice(t,1);break}this.xunhuan_move=!1},t.prototype.move_fun=function(e,t){var a=this;this.moving_block.push(e.start),e.start.block_node.getComponent(l.default).move_fun(e,function(e){var i=a.moving_block.indexOf(e.start);-1!=i&&a.moving_block.splice(i,1);var n=a.move_block_data[e.start.tag];n.splice(0,1),0==n.length&&(a.can_move(t),a.moving=!1)})},t.prototype.feidan=function(e){var t=this;this.is_pause=!0,this.scheduleOnce(function(){for(var i=[],n=0;n<t.data.length;n++)for(var c=0;c<t.data[n].length;c++)t.data[n][c].id>=0&&i.push(t.data[n][c]);for(var s=Math.floor(4*e.length/2),r=[],l=0;l<s&&!(i.length<=0);l++){var d=i[Math.floor(Math.random()*i.length)].id,p=[];for(n=0;n<i.length;n++)i[n].id==d&&p.push(i[n]);for(n=0;n<2;n++){var _=Math.floor(Math.random()*p.length),u=p[_];r.push(u),p.splice(_,1);var h=i.indexOf(u);-1!=h&&i.splice(h,1)}}var f=[];r.length>0?o.cSound.playEffect("effect/rocket_launch"):t.is_pause=!1;var g=function(i){if(0==cc.isValid(r[i].block_node))return"continue";var n=e[Math.floor(i/4)].block_node.convertToWorldSpaceAR(cc.v2(0,0)),c=t.line_parent.convertToNodeSpaceAR(n),s=cc.instantiate(t.feidan_prefab);s.parent=t.line_parent,s.setPosition(c);var l=r[i].block_node.convertToWorldSpaceAR(cc.v2(0,0)),d=t.line_parent.convertToNodeSpaceAR(l);s.getComponent("bao_zhu").fa_she(d,function(){f.push(r[i]),f.length==r.length&&(t.delect(f),t.scheduleOnce(function(){t.is_pause=!1,t.test_link_ui()},1),t.scheduleOnce(function(){a.gameScene.show_jindu()},.1));var e=cc.instantiate(t.baozha);e.parent=t.line_parent,e.setPosition(d);var n=e.getComponent(sp.Skeleton);n.setToSetupPose(),n.clearTracks();var c=n.addAnimation(0,"huo",!1);n.setTrackCompleteListener(c,function(){cc.isValid(e)&&e.destroy()});var s=Math.floor(3*Math.random()+1);o.cSound.playEffect("effect/explosion"+s)},r[i],i)};for(n=0;n<r.length;n++)g(n)},this.move_time)},t.prototype.round_ray=function(e,t){for(var a=[],i=e.pos.x-1;i>=0&&(-1==this.data[i][e.pos.y].id||this.data[i][e.pos.y]==t);i--)a.push(this.data[i][e.pos.y]);for(i=e.pos.x+1;i<this.data.length&&(-1==this.data[i][e.pos.y].id||this.data[i][e.pos.y]==t);i++)a.push(this.data[i][e.pos.y]);for(i=e.pos.y-1;i>=0&&(-1==this.data[e.pos.x][i].id||this.data[e.pos.x][i]==t);i--)a.push(this.data[e.pos.x][i]);for(i=e.pos.y+1;i<this.data[0].length&&(-1==this.data[e.pos.x][i].id||this.data[e.pos.x][i]==t);i++)a.push(this.data[e.pos.x][i]);return a},t.prototype.error_select=function(e,t){var a=this;o.cSound.playEffect("effect/eliminate_failure"),this.scheduleOnce(function(){a.show_hp(),e.fun_hide_select(),t.fun_hide_select()},this.move_time);var i=e.block_node.getChildByName("item"),n=t.block_node.getChildByName("item");cc.Tween.stopAllByTarget(i),cc.Tween.stopAllByTarget(n),cc.tween(i).to(.02,{angle:-20}).to(.04,{angle:20}).to(.06,{angle:-10}).to(.08,{angle:5}).to(.06,{angle:0}).start(),cc.tween(n).to(.02,{angle:-20}).to(.04,{angle:20}).to(.06,{angle:-10}).to(.08,{angle:5}).to(.06,{angle:0}).start(),s._p_data._data.level<10&&o.cUI.showTips("You can only make connections with up to 2 corners.")},t.prototype.gameOver=function(){1!=this.is_over&&(this.is_over=!0,o.cUI.addScene(o.cRes.Prefab.main_scene))},t.prototype.check_win=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)if(this.data[e][t].id>=0||-3==this.data[e][t].id||-9==this.data[e][t].id)return!1;return!0},t.prototype.win_fun=function(){var e=this;if(1!=this.win_bool)if(this.win_bool=!0,this.block_parent.destroyAllChildren(),this.line_parent.destroyAllChildren(),this.guidao.clear(),0==s._p_data._data.level){o.cSound.stopMusic(),o.cSound.playEffect("effect/difficulty_surge"),s._p_data._data.level++,s._p_data.saveData(),s._p_data.settle(s._p_data._data.level,0,0),this.hard_node.active=!0,cc.Tween.stopAllByTarget(this.hard_node),this.hard_node.x=-720;var t=this.hard_node.getChildByName("label");cc.tween(this.hard_node).to(.7,{x:0},{easing:"backOut"}).delay(.2).call(function(){o.cSound.playEffect("effect/difficulty_word"),cc.tween(t).to(.15,{scale:1.1}).to(.15,{scale:1}).start()}).delay(.8).to(.7,{x:-720},{easing:"backIn"}).call(function(){e.hard_node.active=!1,e.init()}).start()}else s._p_data._data.level++,s._p_data.saveData(),o.cUI.addLayer(o.cRes.Prefab.win_ui,!1),0==o.cPublicMager.get_sdk_data&&(this.now_finish_level++,this.now_finish_level>=3&&(o.cPublicMager.get_sdk_data=!0))},t.prototype.show_item=function(e,t){var a=this;if(-1!=e){var i=cc.instantiate(this.item_icon_prefab);i.parent=this.node,i.y=e,i.getComponent(h.default).init(t),o.cSound.playEffect("effect/prop_shake");var n=this.item_parent.children[t].convertToWorldSpaceAR(cc.v2(0,0)),c=this.node.convertToNodeSpaceAR(n);cc.tween(i).to(.05,{angle:10}).to(.1,{angle:-20}).to(.05,{angle:10}).to(.5,{x:c.x,y:c.y,scale:.5},{easing:"backIn"}).call(function(){o.cSound.playEffect("effect/get_prop"),i.destroy(),a.show_item_fun(),cc.tween(a.item_parent.children[t]).to(.1,{scale:1.2}).to(.1,{scale:1}).start()}).start()}else this.show_item_fun()},t.prototype.show_item_fun=function(){for(var e=this.item_parent.children,t=0;t<s._p_data._data.item.length;t++){var a=e[t].getChildByName("node2").getChildByName("label");a.getComponent(cc.Label).string=s._p_data._data.item[t].toString(),s._p_data._data.item[t]<=0?(a.parent.active=!1,e[t].getChildByName("node1").active=!0):(a.parent.active=!0,e[t].getChildByName("node1").active=!1)}},t.prototype.on_btn=function(e,t){if(1!=this.is_pause){this.btn0(),cc.Tween.stopAllByTarget(e.target);var a=Number(t);if(s._p_data._data.item[a]<=0){if(o.cUI.addLayer(o.cRes.Prefab.get_item_ui).then(function(e){e.getComponent("get_item_ui").init(a)}),1==a){var i=this.find_can_line();cc.Tween.stopAllByTarget(this.refresh_btn),this.refresh_btn.scale=1,i||cc.tween(this.refresh_btn).to(.5,{scale:1.1}).to(.5,{scale:1}).union().repeatForever().start()}}else{switch(s._p_data._data.item[a]--,a){case 0:this.tip();break;case 1:this.refresh();break;case 2:this.item_delect()}s._p_data.useItem(a),this.show_item_fun(),s._p_data.saveData()}}},t.prototype.tip=function(){this.tip_block.length>0&&(this.tip_block[0].fun_hide_tip(),this.tip_block[1].fun_hide_tip(),this.tip_block=[]),this.zidong_tip_block.length>0&&(this.zidong_tip_block[0].fun_hide_tip(),this.zidong_tip_block[1].fun_hide_tip(),this.zidong_tip_block=[]);for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)(this.data[t][a].id>=0||-9==this.data[t][a].id)&&e.push(this.data[t][a]);var i=!1;for(t=0;t<e.length;t++)if(1!=e[t].is_tengman&&1!=e[t].is_yun){for(a=t+1;a<e.length;a++)if(1!=e[a].is_tengman&&1!=e[a].is_yun&&e[t].id==e[a].id){var n=this.check_delect(e[t],e[a]);if(n){this.tip_block.push(n.data1),this.tip_block.push(n.data2),n.data1.fun_show_tip(),n.data2.fun_show_tip(),i=!0,o.cSound.playEffect("effect/hint_prop"),this.tip_number++;break}}if(1==i)break}0==i&&(s._p_data._data.item[0]++,s._p_data.saveData(),this.show_item_fun()),this.hide_qipao()},t.prototype.refresh=function(){var e=this;o.cSound.playEffect("effect/refresh_item"),this.show_unline_btn(),this.tip_block.length>0&&(this.tip_block[0].fun_hide_tip(),this.tip_block[1].fun_hide_tip(),this.tip_block=[]),this.zidong_tip_block.length>0&&(this.zidong_tip_block[0].fun_hide_tip(),this.zidong_tip_block[1].fun_hide_tip(),this.zidong_tip_block=[]);for(var t=[],a=[],i=0;i<this.data.length;i++)for(var n=0;n<this.data[i].length;n++)this.data[i][n].id>=0&&(t.push(this.data[i][n].id),a.push(this.data[i][n]));for(i=0;i<t.length;i++){var c=Math.floor(Math.random()*t.length),s=t[i];t[i]=t[c],t[c]=s}for(i=0;i<a.length;i++)a[i].id=t[i];if(this.difficulty_control(),a[0]){var r=a[0].id;for(i=1;i<a.length;i++)a[i].id==r&&(s=a[1].id,a[1].id=r,a[i].id=s)}for(i=0;i<a.length;i++)a[i].fun_action_init_icon();var d=[-2,-4,-5,-6,-7,-10];this.find_can_line()||(this.is_pause=!0,this.scheduleOnce(function(){for(var t=[],a=[],i=[],n=0;n<e.data.length;n++)for(var c=0;c<e.data[n].length;c++)-3==e.data[n][c].id&&(e.data[n][c].id=e.out_id[0],e.out_id.shift(),e.data[n][c].fun_show_fanmian()),-1!=d.indexOf(e.data[n][c].id)&&t.push(e.data[n][c]),1==e.data[n][c].is_tengman&&a.push(e.data[n][c]),1==e.data[n][c].is_yun&&i.push(e.data[n][c]);e.scheduleOnce(function(){if(a.length>0)if(t.length>0){for(var n=0;n<a.length;n++)a[n].is_tengman=!1,a[n].fun_un_lock();e.delect(t,null,a),e.scheduleOnce(function(){e.is_pause=!1,e.test_link_ui()},1)}else{for(e.scheduleOnce(function(){o.cSound.playEffect("effect/vine_effect")},.35),n=0;n<a.length;n++)a[n].is_tengman=!1,a[n].fun_un_lock();e.check_move(a,1),e.is_pause=!1}else t.length>0?(e.delect(t,null,a),e.scheduleOnce(function(){e.is_pause=!1,e.test_link_ui()},1)):e.is_pause=!1;for(n=0;n<i.length;n++)i[n].block_node.getComponent(l.default).delect_yun();i.length>0&&o.cSound.playEffect("effect/cloud_shatter"),e.line_parent.destroyAllChildren()},.2)},.7)),this.show_shuaxin_num(),cc.Tween.stopAllByTarget(this.refresh_btn),this.refresh_btn.scale=1,this.hide_qipao()},t.prototype.add_hp=function(){if(this.hp>=6)return s._p_data._data.item[2]++,this.show_item_fun(),s._p_data.saveData(),void o.cUI.showTips("Health is already at maximum.");o.cSound.playEffect("effect/life_prop"),this.hp+=3,this.hp>6&&(this.hp=6),this.show_hp(),s._p_data.saveData()},t.prototype.item_delect=function(){if(1==this.moving)return s._p_data._data.item[2]++,s._p_data.saveData(),void this.show_item_fun();for(var e=[],t=0;t<this.data.length;t++)for(var i=0;i<this.data[t].length;i++)1!=this.data[t][i].is_tengman&&this.data[t][i].id>=0&&e.push(this.data[t][i]);var n=[];for(t=0;t<e.length;t++)for(i=t+1;i<e.length;i++)if(e[t].id==e[i].id){var o=[];o.push(e[t]),o.push(e[i]),n.push(o)}if(0==n.length)return s._p_data._data.item[2]++,s._p_data.saveData(),void this.show_item_fun();var c=n[Math.floor(Math.random()*n.length)];this.select_block&&this.select_block.fun_hide_select(),this.delect([c[0],c[1]]),this.scheduleOnce(function(){a.gameScene.show_jindu()},.2)},t.prototype.relive=function(){o.cSound.resumeMusic(),o.cSound.playEffect("effect/life_prop"),this.is_over=!1,this.relive_num--,this.hp+=3,this.show_hp()},t.prototype.zidong_game=function(){var e=this;if(1!=this.is_over)if(0!=o.cPublicMager.zidong)if(1!=this.is_pause){this.zidong=!0;for(var t=[],a=0;a<this.data.length;a++)for(var i=0;i<this.data[a].length;i++)1!=this.data[a][i].is_tengman&&1!=this.data[a][i].is_yun&&this.data[a][i].id>=0&&t.push(this.data[a][i]);var n=1.2,c=!1;for(a=0;a<t.length;a++){for(i=a+1;i<t.length;i++)if(t[a].id==t[i].id){var s=this.check_delect(t[a],t[i]);if(s){s.data1.fun_show_select(),s.data2.fun_show_select(),this.delect([s.data1,s.data2],s.lian),c=!0;break}}if(1==c)break}0==c&&(n=2.5),this.scheduleOnce(function(){e.zidong_game()},n)}else this.scheduleOnce(function(){e.zidong_game()},1);else this.zidong=!1;else this.zidong=!1},t.prototype.show_shuaxin_num=function(){this.refresh_label.string="Refresh Num:"+this.ad_num},t.prototype.on_tip_btn=function(){var e=this;if(0!=this.tip_bool)switch(this.tip_bool=!1,this.scheduleOnce(function(){e.tip_bool=!0},3),o.cSound.playEffect("effect/popup_prompt"),this.level_data.moveType){case-10:o.cUI.showTips("Covered tiles cannot be tapped.");break;case-9:o.cUI.showTips("Magnets attract nearby tiles, making them immovable.");break;case-8:o.cUI.showTips("Connect to launch a rocket and destroy tiles!");break;case-7:o.cUI.showTips("Clear tiles next to vines to remove them.");break;case-6:o.cUI.showTips("Wooden blocks can\u2019t be connected, but they move with others.");break;case 9:case 10:case 11:case 12:o.cUI.showTips("Tiles follow a track and loop when cleared.");break;case-4:o.cUI.showTips("Break the ice! Clear nearby tiles to melt it.");break;case-3:o.cUI.showTips(" Hidden tiles flip when adjacent ones are cleared.");break;case-2:o.cUI.showTips("Stones cannot be cleared or moved.");break;case 1:o.cUI.showTips("Tiles move LEFT after clearing.");break;case 3:o.cUI.showTips("Tiles move UP after clearing.");break;case 2:o.cUI.showTips("Tiles move RIGHT after clearing.");break;case 4:o.cUI.showTips("Tiles move DOWN after clearing.");break;case 5:o.cUI.showTips("Tiles move LEFT and RIGHT after clearing.");break;case 6:o.cUI.showTips("Tiles move UP and DOWN after clearing.");break;case 7:o.cUI.showTips("Tiles move from both sides toward the center after clearing.");break;case 8:o.cUI.showTips("Tiles move from top and bottom to the center after clearing.")}},t.prototype.show_tip_ui=function(e){var t=this;if(0!=this.level_data.moveType&&-1!=this.level_data.moveType){switch(o.cUI.getTexture("texture/dir/"+this.level_data.moveType).then(function(e){t.tip_img.spriteFrame=e}),this.level_data.moveType){case-10:this.tip_word.string="Covered tiles cannot be tapped.";break;case-9:this.tip_word.string="Magnets attract nearby tiles, making them immovable.";break;case-8:this.tip_word.string="Connect to launch a rocket and destroy tiles!";break;case-7:this.tip_word.string="Clear tiles next to vines to remove them.";break;case-6:this.tip_word.string="Wooden blocks can\u2019t be connected, but they move with others.";break;case 9:case 10:case 11:case 12:this.tip_word.string="Tiles follow a track and loop when cleared.";break;case-4:this.tip_word.string="Break the ice! Clear nearby tiles to melt it.";break;case-3:this.tip_word.string=" Hidden tiles flip when adjacent ones are cleared.";break;case-2:this.tip_word.string="Stones cannot be cleared or moved.";break;case 1:this.tip_word.string="Tiles move LEFT after clearing.";break;case 3:this.tip_word.string="Tiles move UP after clearing.";break;case 2:this.tip_word.string="Tiles move RIGHT after clearing.";break;case 4:this.tip_word.string="Tiles move DOWN after clearing.";break;case 5:this.tip_word.string="Tiles move LEFT and RIGHT after clearing.";break;case 6:this.tip_word.string="Tiles move UP and DOWN after clearing.";break;case 7:this.tip_word.string="Tiles move from both sides toward the center after clearing.";break;case 8:this.tip_word.string="Tiles move from top and bottom to the center after clearing."}var a=this.tip_btn.convertToWorldSpaceAR(cc.v2(0,0)),i=this.tip_btn_fly.parent.convertToNodeSpaceAR(a);this.tip_btn_fly.scale=1.5,this.tip_btn_fly.setPosition(cc.v2(0,90)),this.tip_bg.opacity=0,this.tip_word.node.opacity=255,cc.tween(this.tip_bg).to(.1,{opacity:200}).start(),this.tip_ui.active=!0,cc.tween(this.tip_btn_fly).by(.05,{angle:-10}).by(.1,{angle:20}).by(.1,{angle:-20}).by(.1,{angle:20}).by(.05,{angle:-10}).union().repeat(1).delay(.4).call(function(){cc.tween(t.tip_bg).to(.35,{opacity:0}).start(),cc.tween(t.tip_word.node).to(.35,{opacity:0}).start()}).to(.4,{x:i.x,y:i.y,scale:1}).call(function(){t.tip_ui.active=!1,t.tip_btn.active=!0,t.tip_bg.opacity=200,t.tip_word.node.opacity=255,e()}).start()}else e()},t.prototype.zidong_tip=function(){},t.prototype.zidong_tip_fun=function(){for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)-1!=this.data[t][a].id&&e.push(this.data[t][a]);var i=!1;for(t=0;t<e.length;t++){for(a=t+1;a<e.length;a++)if(e[t].id==e[a].id){var n=this.check_delect(e[t],e[a]);if(n){n.data1.fun_show_zidong_tip(),n.data2.fun_show_zidong_tip(),this.zidong_tip_block.push(n.data1),this.zidong_tip_block.push(n.data2),i=!0;break}}if(1==i)break}1==i&&this.zidong_tip_num--},t.prototype.find_can_line=function(){for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)1!=this.data[t][a].is_tengman&&1!=this.data[t][a].is_yun&&(this.data[t][a].id>=0||-9==this.data[t][a].id)&&e.push(this.data[t][a]);var i=null;for(t=0;t<e.length;t++){for(a=t+1;a<e.length;a++)if(e[t].id==e[a].id&&-3!=e[t].id){var n=this.check_delect(e[t],e[a]);if(n){i=n;break}}if(i)break}return i},t.prototype.show_new_player=function(e){if(this.new_player_node)if(0!=cc.isValid(e)){this.new_player_node.active=!0;var t=this.new_player_node.getChildByName("mask");this.new_player_node.getChildByName("hand");var a=e.width*e.scale,i=e.height*e.scale;t.width=a,t.height=i,t.scale=this.shipei_scale;var n=e.convertToWorldSpaceAR(cc.v2(0,0)),o=this.new_player_node.parent.convertToNodeSpaceAR(n);this.new_player_node.setPosition(o)}else this.new_player_node&&(this.new_player_node.active=!1)},t.prototype.finish_new_player=function(e,t){this.new_player_node&&this.new_player_type==e&&(this.new_player_type++,this.show_new_player(t))},t.prototype.difficulty_control=function(e){void 0===e&&(e=!1);for(var t=[],a=[],i=1;i<this.data.length-1;i++)for(var n=1;n<this.data[i].length-1;n++)this.data[i][n].id>=0&&(t.push(this.data[i][n]),a.push(this.data[i][n]));var o=[];for(i=0;i<this.map_data.length;i++)for(n=0;n<this.map_data[i].length;n++)if(this.map_data[i][n]>0){var c=this.data[i+1][n+1];o.push(c)}for(i=0;i<o.length;i++)(l=t.indexOf(o[i]))>=0&&(t.splice(l,1),a.splice(l,1));if(!(t.length<=2)){var s=this.level_data.refreshPairs;1==e&&(s=this.level_data.pairsNum),s>Math.floor(t.length/6)&&(s=Math.floor(t.length/6)),s<1&&(s=1);var r=[];for(i=0;i<s;i++){var l=Math.floor(Math.random()*a.length);r.push(a[l]),a.splice(l,1)}var d=[];for(i=0;i<r.length;i++){var p=r[i];if(!p)break;var _=[];this.data[p.pos.x-1]&&this.data[p.pos.x-1][p.pos.y]&&this.data[p.pos.x-1][p.pos.y].id>=0&&this.data[p.pos.x-1][p.pos.y].pos.x>0&&_.push(this.data[p.pos.x-1][p.pos.y]),this.data[p.pos.x+1]&&this.data[p.pos.x+1][p.pos.y]&&this.data[p.pos.x+1][p.pos.y].id>=0&&this.data[p.pos.x+1][p.pos.y].pos.x<this.data.length-1&&_.push(this.data[p.pos.x+1][p.pos.y]),this.data[p.pos.x][p.pos.y-1]&&this.data[p.pos.x][p.pos.y-1].id>=0&&this.data[p.pos.x][p.pos.y-1].pos.y>0&&_.push(this.data[p.pos.x][p.pos.y-1]),this.data[p.pos.x][p.pos.y+1]&&this.data[p.pos.x][p.pos.y+1].id>=0&&this.data[p.pos.x][p.pos.y+1].pos.y<this.data[p.pos.x].length-1&&_.push(this.data[p.pos.x][p.pos.y+1]);for(var u=0;u<o.length;u++)(l=_.indexOf(o[u]))>=0&&_.splice(l,1);if(!(_.length<1)){var h=_[Math.floor(Math.random()*_.length)],f=[];for(n=0;n<t.length;n++){var g=d.indexOf(t[n]);t[n].tag!=p.tag&&-1==g&&t[n].id==p.id&&f.push(t[n])}if(!(f.length<1)){var m=Math.floor(Math.random()*f.length),v=f[m].id;f[m].id=h.id,h.id=v,d.push(h),d.push(p)}}}}},t.prototype.hide_unline_btn=function(){var e=this.item_parent.children;cc.tween(e[0]).to(.5,{y:-300}).start(),cc.tween(e[2]).to(.5,{y:-300}).start()},t.prototype.show_unline_btn=function(){if(0!=cc.isValid(this.item_parent)){var e=this.item_parent.children;cc.isValid(e[0])&&cc.tween(e[0]).to(.5,{y:0}).start(),cc.isValid(e[2])&&cc.tween(e[2]).to(.5,{y:0}).start()}},t.prototype.lie_can_move=function(e){for(var t=[],a=[],i=[],n=0;n<e.length;n++){for(var o=e[n],c=0;c<1&&-1==i.indexOf(o)&&(i.push(o),o.next_block);)o=o.next_block;-1==a.indexOf(o)&&a.push(o)}var s=[],r=[];for(n=0;n<a.length;n++){var l=a[n];for(c=0;c<1&&-1==r.indexOf(l)&&(r.push(l),t.push(l),s.push(l),l.last_block);)l=l.last_block}return s},t.prototype.on_gift=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.get_star_tip_ui)},t.prototype.on_title=function(){this.btn0(),o.cPublicMager.zidong=!o.cPublicMager.zidong,0==this.zidong&&this.zidong_game()},n([v(cc.Node)],t.prototype,"gameUI",void 0),n([v({type:cc.Sprite})],t.prototype,"bg",void 0),n([v({type:sp.Skeleton})],t.prototype,"bg_skeleton",void 0),n([v({type:cc.Node})],t.prototype,"block_parent",void 0),n([v({type:cc.Prefab})],t.prototype,"block_prefab",void 0),n([v({type:cc.Node})],t.prototype,"hp_parent",void 0),n([v({type:cc.Node})],t.prototype,"line_parent",void 0),n([v({type:cc.Prefab})],t.prototype,"line_prefab",void 0),n([v({type:cc.Node})],t.prototype,"item_parent",void 0),n([v({type:cc.Label})],t.prototype,"level_label",void 0),n([v({type:cc.Label})],t.prototype,"refresh_label",void 0),n([v({type:cc.Node})],t.prototype,"tip_btn",void 0),n([v({type:cc.Prefab})],t.prototype,"delect_prefab",void 0),n([v({type:cc.Node})],t.prototype,"lianji_node",void 0),n([v({type:cc.Label})],t.prototype,"lianji_label",void 0),n([v({type:cc.ProgressBar})],t.prototype,"lianji_progress",void 0),n([v({type:cc.Prefab})],t.prototype,"lianji_effect",void 0),n([v({type:cc.Node})],t.prototype,"lianji_word",void 0),n([v({type:cc.Prefab})],t.prototype,"new_player_prefab",void 0),n([v({type:cc.Label})],t.prototype,"progress_node",void 0),n([v({type:cc.ProgressBar})],t.prototype,"progress_bar",void 0),n([v({type:cc.Node})],t.prototype,"tip_ui",void 0),n([v({type:cc.Sprite})],t.prototype,"tip_img",void 0),n([v({type:cc.Node})],t.prototype,"tip_btn_fly",void 0),n([v({type:cc.Label})],t.prototype,"tip_word",void 0),n([v({type:cc.Node})],t.prototype,"tip_bg",void 0),n([v({type:sp.Skeleton})],t.prototype,"tip_skeleton",void 0),n([v({type:cc.Node})],t.prototype,"refresh_btn",void 0),n([v({type:cc.Prefab})],t.prototype,"star_pre",void 0),n([v({type:cc.Node})],t.prototype,"gift_box",void 0),n([v({type:cc.Node})],t.prototype,"hard_node",void 0),n([v({type:cc.Label})],t.prototype,"bubble_label",void 0),n([v({type:cc.JsonAsset})],t.prototype,"zui_niu_json",void 0),n([v({type:cc.JsonAsset})],t.prototype,"level_json",void 0),n([v({type:cc.JsonAsset})],t.prototype,"map_json",void 0),n([v({type:cc.Prefab})],t.prototype,"bing_bao",void 0),n([v({type:cc.JsonAsset})],t.prototype,"move_json",void 0),n([v({type:cc.Graphics})],t.prototype,"guidao",void 0),n([v({type:cc.Node})],t.prototype,"setting_btn",void 0),n([v({type:cc.Prefab})],t.prototype,"feidan_prefab",void 0),n([v({type:cc.Prefab})],t.prototype,"baozha",void 0),n([v({type:cc.Prefab})],t.prototype,"item_icon_prefab",void 0),n([m],t)}(r.GameSceneView);a.default=y,cc._RF.pop()},{Config:"Config",PlayerDataConfig:"PlayerDataConfig",PlayerDataMager:"PlayerDataMager",ViewSet:"ViewSet",bing_bao:"bing_bao",block_item:"block_item",combo_item:"combo_item",item_icon:"item_icon",level:"level",line:"line",star:"star"}],HttpRequest:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"9d283g4BVVDJaGm91mwvDC0","HttpRequest"),Object.defineProperty(a,"__esModule",{value:!0}),a.HttpRequest=void 0,e("PlayerDataMager"),i=a.HttpRequest||(a.HttpRequest={}),n=function(e,t,a){var i,n;i=function(){o.removeEventListener("load",i),o.removeEventListener("error",n),a&&a(null,o)},n=function(){o.removeEventListener("load",i),o.removeEventListener("error",n),a&&a(new Error(e))};var o=new Image;return"file:"!==window.location.protocol&&(o.crossOrigin="anonymous"),o.addEventListener("load",i),o.addEventListener("error",n),o.src=e,o},i.updateHttpSprite=function(e,t){if(-1!=e.indexOf("http"))try{cc.assetManager.loadRemote(e,{ext:i.headImgExt},function(e,a){var i;i=new cc.SpriteFrame(a),t&&(t.spriteFrame=i)})}catch(i){console.log("load failed!",i)}else t.spriteFrame=void 0},i.loadRemoteFile=function(e,t){cc.assetManager.loadRemote(e,function(e,a){e?t&&t():t&&t(a)})},i.savePlayerData=function(){},i.getplayerData=function(){},i.request=function(e,t,a,i,n,o){var c,s,r;void 0===o&&(o="POST"),c="/"+e,n&&(c=e),r=JSON.stringify(t),(s=new XMLHttpRequest).onreadystatechange=function(){var e;if(4==s.readyState&&200==s.status)e=null,""!=s.responseText&&(e=JSON.parse(s.responseText)),a&&a(e);else if(4==s.readyState&&200!=s.status){var t;t={url:c,readyState:s.readyState,status:s.status,data:r},e=null,i&&i(t)}},s.open(o,c,!0),"Get"!=o?(s.setRequestHeader("Content-type","application/json; charset=utf-8"),s.send(r)):s.send()},i.headImgExt=".head",i.registerHeadImgLoader=function(){cc.assetManager.downloader.register(i.headImgExt,function(e,t,a){a(null,e)}),cc.assetManager.parser.register(i.headImgExt,n),cc.assetManager.factory.register(i.headImgExt,function(e,t,a,i){var n,o;n=null,o=null;try{(n=new cc.Texture2D)._uuid=e,n._nativeUrl=e,n._nativeAsset=t}catch(e){o=e}i&&i(o,n)})},cc._RF.pop()},{PlayerDataMager:"PlayerDataMager"}],LoadingResNode:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"d173asWhh1B8aHmrvNR71Vf","LoadingResNode"),l=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=e("ClientEvent");var p,_,u=e("Config"),h=e("Res");c=e("PlayerDataMager"),r=(s=cc._decorator).ccclass,d=s.property,l(_=function(){var e;return(e=null!==p&&p.apply(this,arguments)||this).probar=void 0,e._loadedCount=0,e.un_finish_bundle=[],e.res_number=0,e},p=cc.Component),_.prototype.start=function(){},_.prototype.startLoades=function(){for(var e in u.cRes.bundlesName)this.un_finish_bundle.push(u.cRes.bundlesName[e]);this.un_finish_bundle.push("level"),u.cBunbleMager.preLoadBundle(this.startGame.bind(this))},_.prototype.startGame=function(e){var t,a;t=this,-1!=(a=this.un_finish_bundle.indexOf(e.name))&&this.un_finish_bundle.splice(a,1),this._loadedCount++,"sound"==e.name&&e.loadDir("effect",cc.AudioClip,function(e,a){t.start_game();for(var i=0;i<a.length;i++)u.cPublicMager.music["effect/"+a[i].name]=a[i]}),e.name,this._loadedCount==h.bundlesNameLength&&this.load_res()},_.prototype.load_res=function(){for(var e=this,t=0,a=0,i=function(i){if(i!=c._p_data._data.theme&&i!=c._p_data._data.collectting_theme)return"continue";a++,u.cPublicMager.load_level_bundle(i,function(){if(++t==a){var i=e.un_finish_bundle.indexOf("level");e.un_finish_bundle.splice(i,1),e.start_game(),e.probar.progress=1}})},n=0;n<u.cPublicMager.skin_name.length;n++)i(n);u.cBunbleMager.loadBundle("common",function(t){t.loadDir("texture",cc.SpriteFrame,function(t,a){e.start_game();for(var i=0;i<a.length;i++)u.cPublicMager.image[a[i].name]=a[i]})})},_.prototype.start_game=function(){var e;e=this,this.res_number++,console.log("res_number",this.res_number),3==this.res_number&&this.scheduleOnce(function(){u.cEvent.emit(n.Event_Key.StartGame,"1","2","3"),e.node.destroy()},.2)},_.prototype.update=function(){this.probar.progress+=.005},o([d(cc.ProgressBar)],_.prototype,"probar",void 0),i=o([r],_),a.default=i,cc._RF.pop()},{ClientEvent:"ClientEvent",Config:"Config",PlayerDataMager:"PlayerDataMager",Res:"Res"}],LoadingScene:[function(e,t,a){"use strict";var i,n,o;cc._RF.push(t,"1dd54kjJVpFa5QsSX4wc8QB","LoadingScene"),o=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var c,s,r=e("ClientEvent"),l=e("Config"),d=e("PlayerDataMager"),p=e("LoadingResNode"),_=cc._decorator,u=_.ccclass,h=_.property;o(s=function(){var e;return(e=null!==c&&c.apply(this,arguments)||this).again_btn=null,e.bg=null,e._joinTime=0,e._initing=!1,e.in_game_time=0,e.new_day=!1,e},c=cc.Component),s.prototype.in_game=function(e,t){var a;a=cc.winSize.height/1700,this.bg.scale=a,this.in_game_time=t,this.init_data()},s.prototype.init_data=function(){var e;e=new Date,this._joinTime=e.getTime(),l.cPublicMager.log("init_data"),cc.macro.CLEANUP_IMAGE_CACHE=!1,cc.winSize.height/cc.winSize.width<1.78&&(this.node.getComponent(cc.Canvas).fitHeight=!0),window.addEventListener("message",this.onInit.bind(this))},s.prototype.onInit=function(e){try{if(e.data&&"fofotile"==e.data.game&&"init"==e.data.action){if(this._initing)return;window.removeEventListener("message",this.loading),this._initing=!0,d._p_data.initdone();var t=e.data.data;d._p_data._data.level=t.level,d._p_data._data.item=t.items,d._p_data._data.theme=t.theme,d._p_data._data.theme_collect=t.themes,0==t.level?d._p_data._data.new_player=!0:d._p_data._data.new_player=!1,this.init_day_data(),this.startLoadRes()}}catch(a){console.log("error",a)}},s.prototype.startLoadRes=function(){var e;e=this,this.node.getChildByName("LoadingResNode").getComponent(p.default).startLoades(),l.cSound.effect_switch=1==d._p_data._data.effectSwitch,l.cSound.music_switch=1==d._p_data._data.musicSwitch,l.cEvent.on(r.Event_Key.StartGame,function(){e.startGame()})},s.prototype.start=function(){var e;e=this,l.pfApi.onShow(function(e){!l.cSound._isPause&&l.cSound.now_music&&cc.audioEngine.resumeMusic(),e.scene&&e.scene}),this.scheduleOnce(function(){if(e.node.getChildByName("LoadingResNode"))for(var t=e.node.getChildByName("LoadingResNode").getComponent(p.default).un_finish_bundle,a=0;a<t.length;a++)t[a]},10),this.in_game(null,(new Date).getTime())},s.prototype.on_again=function(){},s.prototype.startGame=function(){var e;e=this,cc.director.loadScene("Main",function(){var t;t=(new Date).getTime()-e._joinTime,console.warn("time:"+t/1e3+"s")})},s.prototype.init_day_data=function(){d._p_data._data.level<0&&(d._p_data._data.level=0),d._p_data._data.item.length>3&&(d._p_data._data.item=[d._p_data._data.item[0],d._p_data._data.item[1],d._p_data._data.item[2]]),isNaN(d._p_data._data.star)&&(d._p_data._data.star=0);for(var e=0;e<l.cPublicMager.skin_name.length;e++)if(!d._p_data._data.theme_collect[e]){var t,a,i;a=[],i=27,t=l.cPublicMager.skin_name[e],-1!=l.cPublicMager.limit_skin.indexOf(t)&&(i=34);for(var n=0;n<i;n++){var o;o=0,"Cozy Garden"==l.cPublicMager.skin_name[e]&&(o=1),a.push(o)}d._p_data._data.theme_collect.push(a)}d._p_data.saveData()},s.prototype.init_game_config=function(){if(d._p_data._data.level_version)l.cPublicMager.config.level_version[d._p_data._data.level_version]||(d._p_data._data.level_version="level_data");else if(0==d._p_data._data.level){var e,t;for(var a in e=[],t=0,l.cPublicMager.config.level_version)e.push({version:a,percent:l.cPublicMager.config.level_version[a].percent}),t+=l.cPublicMager.config.level_version[a].percent;for(var i=Math.random()*t,n=0,o=0;o<e.length;o++)if((n+=e[o].percent)>=i){d._p_data._data.level_version=e[o].version;break}}else d._p_data._data.level_version="level_data";d._p_data.saveData()},i([h({type:cc.Node})],s.prototype,"again_btn",void 0),i([h({type:cc.Node})],s.prototype,"bg",void 0),n=i([u],s),a.default=n,cc._RF.pop()},{ClientEvent:"ClientEvent",Config:"Config",LoadingResNode:"LoadingResNode",PlayerDataMager:"PlayerDataMager"}],LocalStorage:[function(e,t,a){"use strict";var i,n,o,c,s,r;cc._RF.push(t,"a7d03QbzeBAIZz0vtrMrNKS","LocalStorage"),n=__extends,Object.defineProperty(a,"__esModule",{value:!0}),i=e("SingleBase"),o=cc.sys.localStorage,n(r=function(){return null!==s&&s.apply(this,arguments)||this},s=i.default),r.prototype.setItem=function(e,t){o.setItem(e,t)},r.prototype.getItem=function(e){return o.getItem(e)||""},r.prototype.getItemNumber=function(e){var t;return(t=o.getItem(e))?Number(t):0},r.prototype.clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){o.removeItem(e)})},r.prototype.getItemMap=function(e,t){var a;return a=o.getItem(e)||"{}",a=JSON.parse(a),void 0!==t?a[t]||{}:a},r.prototype.setItemMap=function(e,t){var a,i,n,c,s,r;c=t.key,n=t.value,s=(i=(a=this.getItemMap(e))[c]||{}).value||0,r=i.times||0,++r>=2&&(r=0,s+=n),i={value:s,times:r},a[c]=i,o.setItem(e,JSON.stringify(a))},r.prototype.setItemList=function(e,t){var a,i,n,c;i=t.key,n=t.value,c=(a=this.getItemList(e))[i]||0,c+=n,a[i]=c,o.setItem(e,JSON.stringify(a))},r.prototype.getItemList=function(e,t){var a;return a=o.getItem(e)||"{}",a=JSON.parse(a),t?a[t]||0:a},r.prototype.getSkinArr=function(e){var t;if(t=o.getItem(e)||"[1,1,0,0,0,0,0,0]",(t=JSON.parse(t)).length<8)for(;t.length<8;)t.push(0);return t},r.prototype.setItemArr=function(e,t){o.setItem(e,JSON.stringify(t))},c=r,a.default=c,cc._RF.pop()},{SingleBase:"SingleBase"}],MainCamera:[function(e,t,a){"use strict";var i,n,o,c,s,r,l;cc._RF.push(t,"05bb2vxFI9JKaRotEsEE7xp","MainCamera"),n=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),a.mainCamera=void 0,s=(c=cc._decorator).ccclass,c.property,n(l=function(){return null!==r&&r.apply(this,arguments)||this},r=cc.Component),l.prototype.onLoad=function(){a.mainCamera=this,this.camera=this.node.getComponent(cc.Camera)},l.prototype.start=function(){},l.prototype.setPos=function(e){this.node.position=e},l.prototype.setZoomRatio=function(e){this.camera.zoomRatio=e},l.prototype.startGameAction=function(){cc.tween(this.camera).to(.5,{zoomRatio:1}).start(),cc.tween(this.node).to(.5,{y:0}).start()},o=i([s],l),a.default=o,cc._RF.pop()},{}],MainScene:[function(e,t,a){"use strict";cc._RF.push(t,"b9c09mVugNGIab9sLWwn0me","MainScene");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0}),a.mainScene=void 0;var o=e("Config"),c=e("PlayerDataMager"),s=e("ViewSet"),r=e("GameScene"),l=!1,d=cc._decorator,p=d.ccclass,_=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=void 0,t.bg_skeleton=void 0,t.p_normal=null,t.theme_bool=!1,t.niupi_bool=!1,t}return i(t,e),t.prototype.onLoad=function(){a.mainScene=this,o.cUI.hideAllTips(),cc.dynamicAtlasManager.reset(),o.cNodePool.clearAll(),this.initScene(),this.initPlatform()},t.prototype.onDisable=function(){},t.prototype.start=function(){this.show_view()},t.prototype.maidian_fun=function(){},t.prototype.onDestroy=function(){},t.prototype.initPlatform=function(){},t.prototype.initScene=function(){},t.prototype.loadGameScene=function(e){o.cUI.addScene(o.cRes.Prefab.game_scene).then(function(t){1!=l&&(l=!0,t.getComponent(r.default).initScene(),e&&e())})},t.prototype.loadGameRes=function(){var e=this;o.cUI.createNode(o.cRes.Prefab.loading).then(function(t){t.y=5,t.parent=o.cUI.getGameLoadingRoot(),o.cUI.loadResDir("prefab/game_items/",t).then(function(){t.destroy(),e.loadGameScene()})})},t.prototype.onBtnStartGame=function(){o.cSound.playEffect(o.cRes.Sound.btn_0),o.cPublicMager.is_zui_niu=!1,this.loadGameScene()},t.prototype.on_refresh=function(){var e=this;this.btn0(),o.pfApi.showVideoAd(function(){c._p_data._data.level=0,c._p_data.saveData(),e.show_view()},function(){})},t.prototype.show_view=function(){var e=this;cc.Tween.stopAllByTarget(this._btn_start_game),this._btn_start_game.scale=1,cc.tween(this._btn_start_game).by(1,{scale:.03}).by(1,{scale:-.03}).union().repeatForever().start(),o.cBunbleMager.get_bundle_texture("level_"+c._p_data._data.theme,"bg"+c._p_data._data.theme).then(function(t){e.bg.spriteFrame=t}),o.cBunbleMager.get_bundle_SkeletonData("level_"+c._p_data._data.theme,"bg"+c._p_data._data.theme+"/bg"+c._p_data._data.theme).then(function(t){e.bg_skeleton.skeletonData=t,e.bg_skeleton.setAnimation(0,"idle",!0)});var t=cc.winSize.height/1700;this.bg.node.scale=t,this.p_normal.string="Level "+(c._p_data._data.level+1),0==c._p_data._data.level&&(this.p_normal.string="Play")},t.prototype.on_setting=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.setting)},t.prototype.on_zhuti=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.skin_ui)},t.prototype.on_youxizhan=function(){this.btn0()},t.prototype.on_add_level_1=function(){c._p_data._data.level++,c._p_data.saveData(),o.cUI.showTips("next level"),this.show_view()},t.prototype.on_show_win=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.win_ui)},n([_({type:cc.Sprite})],t.prototype,"bg",void 0),n([_({type:sp.Skeleton})],t.prototype,"bg_skeleton",void 0),n([_({type:cc.Label})],t.prototype,"p_normal",void 0),n([p],t)}(s.MainSceneView);a.default=u,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewSet:"ViewSet"}],Main:[function(e,t,a){"use strict";var i,n,o,c,s,r;cc._RF.push(t,"242a601KjVDP4uw5nmgEi2i","Main"),c=__extends,s=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l,d,p=e("Config"),_=e("PlayerDataMager");o=(i=cc._decorator).ccclass,r=i.property,c(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).bg=null,e},l=cc.Component),d.prototype.onLoad=function(){var e;0==_._p_data._data.effectSwitch?cc.audioEngine.setEffectsVolume(0):cc.audioEngine.setEffectsVolume(1),e=cc.winSize.height/1700,this.bg.scale=e,this.startGame(),cc.winSize.height/cc.winSize.width<1.78&&(this.node.getComponent(cc.Canvas).fitHeight=!0),window.addEventListener("message",function(e){console.log("----xxxx---",e.data,e);try{if(e.data.game&&"fofotile"==e.data.game){var t=e.data.action;if("play"==t)p.cUI.addScene(p.cRes.Prefab.game_scene).then(function(){});else if("callback"==t){var a=e.data.data;_._p_data.callback(a.uuid,a.code)}}}catch(i){}}.bind(this))},d.prototype.startGame=function(){p.cUI.addScene(p.cRes.Prefab.game_scene).then(function(){})},s([r({type:cc.Node})],d.prototype,"bg",void 0),n=s([o],d),a.default=n,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager"}],PlatformApi:[function(e,t,a){"use strict";var i,n,o,c,s;cc._RF.push(t,"6d28fkwdH1KTZPmVkDuncMd","PlatformApi"),n=__extends,Object.defineProperty(a,"__esModule",{value:!0}),e("PlayerDataMager"),i=e("SingleBase"),n(s=function(){return null!==c&&c.apply(this,arguments)||this},c=i.default),s.prototype.onLoad=function(){},s.prototype.showVideoAd=function(){},s.prototype.onShow=function(){},s.prototype.vibrateShort=function(){},o=s,a.default=o,cc._RF.pop()},{PlayerDataMager:"PlayerDataMager",SingleBase:"SingleBase"}],PlayerDataConfig:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"bfd54GC1cFLrJSlz29hnyNi","PlayerDataConfig"),Object.defineProperty(a,"__esModule",{value:!0}),a.game_config=a.level_data=a.block_data=a.ad=void 0,a.ad=function(){this.hint_item=0,this.refresh_item=0,this.clear_item=0},(n=function(){var e;e=this,this.id=-1,this.pos=cc.v2(0,0),this.tag=-1,this.on_bool=!0,this.next_block=null,this.last_block=null,this.is_tengman=!1,this.is_yun=!1,this.fun_hide_select=function(){e.block_node&&e.block_node.getComponent("block_item").hide_select()},this.fun_show_select=function(){e.block_node&&e.block_node.getComponent("block_item").show_select()},this.init_view=function(t){e.block_node&&e.block_node.getComponent("block_item").init_view(t)},this.fun_action_init_icon=function(){e.block_node&&e.block_node.getComponent("block_item").init_icon_to_action()},this.fun_show_tip=function(){e.block_node&&e.block_node.getComponent("block_item").show_tip()},this.fun_show_zidong_tip=function(){e.block_node&&e.block_node.getComponent("block_item").show_zidong_tip()},this.fun_hide_tip=function(){e.block_node&&e.block_node.getComponent("block_item").hide_tip()},this.fun_show_chuchang=function(t){e.block_node&&e.block_node.getComponent("block_item").show_chuchang(t)},this.fun_show_delete=function(t,a,i){void 0===t&&(t=!1),e.block_node&&e.block_node.getComponent("block_item").show_delete(t,a,i)},this.fun_show_doudong=function(){e.block_node&&e.block_node.getComponent("block_item").show_doudong()},this.fun_show_fanmian=function(){e.block_node&&e.block_node.getComponent("block_item").show_fanmian()}}).prototype.fun_un_lock=function(){this.block_node&&this.block_node.getComponent("block_item").un_lock()},i=n,a.block_data=i,a.level_data=function(){},a.game_config=function(){this.level_version={level_version:{level_data:{percent:0}}},this.gold=200,this.maxLevel=70,this.levelGold=20,this.star=30,this.ad_star=.5},cc._RF.pop()},{}],PlayerDataMager:[function(e,t,a){"use strict";var i,n,o;cc._RF.push(t,"3cfafhlTt9CUp2f7h+17xed","PlayerDataMager"),Object.defineProperty(a,"__esModule",{value:!0}),a._p_data=void 0,e("PublicMager"),e("Utils"),e("PlayerDataConfig"),i=e("StorageManager"),o=function(){this.storage=i.Storage,this._key="game_key",this._game="fofotile",this._data={effectSwitch:1,musicSwitch:1,vibrateSwitch:1,level:0,item:[1,0,0],theme:0,theme_collect:[],challenge:0,collectting_theme:1,new_player:!0,star:0},this._callbacks={}},Object.defineProperty(o,"instance",{get:function(){return this._instance||(this._instance=new o),this._instance},enumerable:!1,configurable:!0}),o.prototype.initData=function(e){var t;(t=this.storage.get(this._key))&&this.updatePlayerData(JSON.parse(t)),e()},o.prototype.updatePlayerData=function(e){for(var t in e)this._data[t]=e[t]},o.prototype.settle=function(e,t,a){console.log("settle",e,t,a),parent.postMessage({game:this._game,action:"settle",data:{level:e,theme:t,block:a}},"*")},o.prototype.switchTheme=function(e){parent.postMessage({game:this._game,action:"setTheme",data:{theme:e}},"*")},o.prototype.addItem=function(e,t){var a=this.getUuid();this._callbacks[a]=t,parent.postMessage({game:this._game,action:"addItem",data:{uuid:a,itemId:e}},"*")},o.prototype.refreshItem=function(e){var t=this.getUuid();this._callbacks[t]=e,parent.postMessage({game:this._game,action:"resfreshItem",data:{uuid:t}},"*")},o.prototype.callback=function(e,t){this._callbacks[e]&&this._callbacks[e](t),delete this._callbacks[e]},o.prototype.getUuid=function(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t=[],a=0;a<18;a++)t.push(e[Math.floor(Math.random()*e.length)]);return t.join("")},o.prototype.useItem=function(e){parent.postMessage({game:this._game,action:"useItem",data:{itemId:e}},"*")},o.prototype.close=function(){parent.postMessage({game:this._game,action:"close",data:{}},"*")},o.prototype.initdone=function(){parent.postMessage({game:this._game,action:"initdone",data:{}},"*")},o.prototype.saveData=function(){var e;return e=this.initServerData(),this.storage.set(this._key,JSON.stringify(e)),e},o.prototype.initServerData=function(){return this._data},o._instance=null,n=o,a._p_data=n.instance,cc._RF.pop()},{PlayerDataConfig:"PlayerDataConfig",PublicMager:"PublicMager",StorageManager:"StorageManager",Utils:"Utils"}],Pool:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"7bebdMZnUVA8YsUPJHGKLFe","Pool"),r=__extends,i=__awaiter,n=__generator,Object.defineProperty(a,"__esModule",{value:!0}),s=e("SingleBase"),o=e("UI"),r(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).pools=new Map,e},l=s.default),d.prototype.createPool=function(e){var t;return t=new cc.NodePool(e),this.pools.set(t.poolHandlerComp,t),t},d.prototype.get=function(e){return i(this,void 0,Promise,function(){var t;return n(this,function(){return(t=this.pools.get(e)||this.createPool(e)).size()>0?[2,t.get()]:[2,o.default.get().createNode(e).then(function(e){return e})]})})},d.prototype.put=function(e){var t;e&&((t=this.pools.get(e.url_name))?t.put(e):e.destroy())},d.prototype.puts=function(e){var t;t=this,e.forEach(function(e){t.put(e)})},d.prototype.clear=function(e){var t;(t=this.pools.get(e))&&(t.clear(),cc.resources.release(e))},d.prototype.clearAll=function(){this.pools.forEach(function(e){e.clear()})},c=d,a.default=c,cc._RF.pop()},{SingleBase:"SingleBase",UI:"UI"}],PublicMager:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"cfe8796uPBJW67K8oFDmWdl","PublicMager"),r=__extends,Object.defineProperty(a,"__esModule",{value:!0}),e("Res"),s=e("PlayerDataConfig"),c=e("PlayerDataMager"),n=e("SingleBase"),i=e("BundleMager"),e("UI"),r(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).zidong=!1,e.skin_name=["Cozy Garden","Ocean World","Beauty Guru","Merry Christmas","Animal Kingdom","Master Chef","Home Binge","Lazy Afternoon","Family Playground","Global Journey","Eternal Gems","School Days","Sports Pro"],e.limit_skin=[],e.is_zui_niu=!1,e.is_ading=!1,e.test=!1,e.card_play_order={"id-4":[[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148]],"id-3":[[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141]],"id-2":[[104],[94],[84],[74],[64],[54],[44],[45],[55],[65],[75],[85],[95],[105],[115],[114],[113],[103],[93],[83],[73],[63],[53],[43],[33],[34],[35],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[125],[124],[123],[122],[112],[102],[92],[82],[72],[62],[52],[42],[32],[22],[23],[24],[25],[26],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[136],[135],[134],[133],[132],[131],[121],[111],[101],[91],[81],[71],[61],[51],[41],[31],[21],[11],[12],[13],[14],[15],[16],[17],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[147],[146],[145],[144],[143],[142],[141]],"id-1":[[52],[53],[54],[55],[56],[57],[72],[74],[75],[77],[92],[97]],id0:[[104],[94],[84],[74],[64],[54],[44],[45],[55],[65],[75],[85],[95],[105],[115],[114],[113],[103],[93],[83],[73],[63],[53],[43],[33],[34],[35],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[125],[124],[123],[122],[112],[102],[92],[82],[72],[62],[52],[42],[32],[22],[23],[24],[25],[26],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[136],[135],[134],[133],[132],[131],[121],[111],[101],[91],[81],[71],[61],[51],[41],[31],[21],[11],[12],[13],[14],[15],[16],[17],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[147],[146],[145],[144],[143],[142],[141]],id1:[[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141]],id3:[[141],[142],[143],[144],[145],[146],[147],[148],[131],[132],[133],[134],[135],[136],[137],[138],[121],[122],[123],[124],[125],[126],[127],[128],[111],[112],[113],[114],[115],[116],[117],[118],[101],[102],[103],[104],[105],[106],[107],[108],[91],[92],[93],[94],[95],[96],[97],[98],[81],[82],[83],[84],[85],[86],[87],[88],[71],[72],[73],[74],[75],[76],[77],[78],[61],[62],[63],[64],[65],[66],[67],[68],[51],[52],[53],[54],[55],[56],[57],[58],[41],[42],[43],[44],[45],[46],[47],[48],[31],[32],[33],[34],[35],[36],[37],[38],[21],[22],[23],[24],[25],[26],[27],[28],[11],[12],[13],[14],[15],[16],[17],[18]],id2:[[11],[21],[31],[41],[51],[61],[71],[81],[91],[101],[111],[121],[131],[141],[12],[22],[32],[42],[52],[62],[72],[82],[92],[102],[112],[122],[132],[142],[13],[23],[33],[43],[53],[63],[73],[83],[93],[103],[113],[123],[133],[143],[14],[24],[34],[44],[54],[64],[74],[84],[94],[104],[114],[124],[134],[144],[15],[25],[35],[45],[55],[65],[75],[85],[95],[105],[115],[125],[135],[145],[16],[26],[36],[46],[56],[66],[76],[86],[96],[106],[116],[126],[136],[146],[17],[27],[37],[47],[57],[67],[77],[87],[97],[107],[117],[127],[137],[147],[18],[28],[38],[48],[58],[68],[78],[88],[98],[108],[118],[128],[138],[148]],id4:[[11],[12],[13],[14],[15],[16],[17],[18],[21],[22],[23],[24],[25],[26],[27],[28],[31],[32],[33],[34],[35],[36],[37],[38],[41],[42],[43],[44],[45],[46],[47],[48],[51],[52],[53],[54],[55],[56],[57],[58],[61],[62],[63],[64],[65],[66],[67],[68],[71],[72],[73],[74],[75],[76],[77],[78],[81],[82],[83],[84],[85],[86],[87],[88],[91],[92],[93],[94],[95],[96],[97],[98],[101],[102],[103],[104],[105],[106],[107],[108],[111],[112],[113],[114],[115],[116],[117],[118],[121],[122],[123],[124],[125],[126],[127],[128],[131],[132],[133],[134],[135],[136],[137],[138],[141],[142],[143],[144],[145],[146],[147],[148]],id5:[[14,15],[24,25],[34,35],[44,45],[54,55],[64,65],[74,75],[84,85],[94,95],[104,105],[114,115],[124,125],[134,135],[144,145],[13,16],[23,26],[33,36],[43,46],[53,56],[63,66],[73,76],[83,86],[93,96],[103,106],[113,116],[123,126],[133,136],[143,146],[12,17],[22,27],[32,37],[42,47],[52,57],[62,67],[72,77],[82,87],[92,97],[102,107],[112,117],[122,127],[132,137],[142,147],[11,18],[21,28],[31,38],[41,48],[51,58],[61,68],[71,78],[81,88],[91,98],[101,108],[111,118],[121,128],[131,138],[141,148]],id6:[[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148]],id7:[[11,18],[21,28],[31,38],[41,48],[51,58],[61,68],[71,78],[81,88],[91,98],[101,108],[111,118],[121,128],[131,138],[141,148],[12,17],[22,27],[32,37],[42,47],[52,57],[62,67],[72,77],[82,87],[92,97],[102,107],[112,117],[122,127],[132,137],[142,147],[13,16],[23,26],[33,36],[43,46],[53,56],[63,66],[73,76],[83,86],[93,96],[103,106],[113,116],[123,126],[133,136],[143,146],[14,15],[24,25],[34,35],[44,45],[54,55],[64,65],[74,75],[84,85],[94,95],[104,105],[114,115],[124,125],[134,135],[144,145]],id8:[[11,141],[12,142],[13,143],[14,144],[15,145],[16,146],[17,147],[18,148],[21,131],[22,132],[23,133],[24,134],[25,135],[26,136],[27,137],[28,138],[31,121],[32,122],[33,123],[34,124],[35,125],[36,126],[37,127],[38,128],[41,111],[42,112],[43,113],[44,114],[45,115],[46,116],[47,117],[48,118],[51,101],[52,102],[53,103],[54,104],[55,105],[56,106],[57,107],[58,108],[61,91],[62,92],[63,93],[64,94],[65,95],[66,96],[67,97],[68,98],[71,81],[72,82],[73,83],[74,84],[75,85],[76,86],[77,87],[78,88]]},e.zty="",e.first_unlock_zuiniu=!1,e.image={},e.atlas=null,e.music={},e.config=new s.game_config,e.level_data=null,e.map_data=null,e.in_game_time=0,e.first_zhiwan=!1,e.can_dingyue_wx=!1,e.appId="wx9310fb0610f7bd91",e.open_chaping=!1,e.open_banner=!1,e.read_server_data=!0,e.day_reward=!1,e.libao_mail=[],e.load_level=[],e.get_sdk_data=!0,e},l=n.default),d.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log(e)},d.prototype.load_level_bundle=function(e,t){var a,n;a=this,-1==this.load_level.indexOf(e)?(this.load_level.push(e),n=0,i.default.get().loadBundle("level_"+e,function(i){i.loadDir("texture",cc.SpriteFrame,function(e,i){n++;for(var o=0;o<i.length;o++)a.image[i[o].name]=i[o];2==n&&t&&t()}),i.loadDir("sound",cc.AudioClip,function(i,o){n++;for(var c=0;c<o.length;c++)a.music["level_"+e+"/"+o[c].name]=o[c];2==n&&t&&t()})})):t&&t()},d.prototype.get_skin=function(e){var t,a,i,n;void 0===e&&(e=!1);for(var o=[],s=0;s<c._p_data._data.theme_collect.length;s++){var r;if(r=!1,0==e&&(r=!0),1==r)for(var l=0;l<c._p_data._data.theme_collect[s].length;l++)0==c._p_data._data.theme_collect[s][l]&&o.push({theme:s,skin:l})}if(t=JSON.parse(JSON.stringify(o)),-1!=c._p_data._data.collectting_theme&&-1==this.limit_skin.indexOf(this.skin_name[c._p_data._data.collectting_theme]))for(s=0;s<t.length;s++)t[s].theme!=c._p_data._data.collectting_theme&&(t.splice(s,1),s--);for(t.length<1&&(t=o),i=999,s=0;s<t.length;s++)t[s].theme<i&&(i=t[s].theme);if(i<999)for(s=0;s<t.length;s++)t[s].theme!=i&&(t.splice(s,1),s--);if(t.length<1)for(s=0;s<c._p_data._data.theme_collect.length;s++){var d,p;if(p=this.limit_skin.indexOf(this.skin_name[s]),d=!1,1==e&&-1!=p||0==e&&-1==p&&(d=!0),1==d)for(l=0;l<c._p_data._data.theme_collect[s].length;l++)t.push({theme:s,skin:l})}for(n=t[Math.floor(Math.random()*t.length)],a=!0,s=0;s<this.skin_name.length;s++)if(-1==this.limit_skin.indexOf(this.skin_name[s])){for(l=0;l<c._p_data._data.theme_collect[s].length;l++)if(0==c._p_data._data.theme_collect[s][l]){a=!1;break}if(0==a)break}return 1==a&&(c._p_data._data.collectting_theme=0),n},d.prototype.get_skin_by_theme=function(e,t){void 0===t&&(t=1);for(var a=JSON.parse(JSON.stringify(c._p_data._data.theme_collect[e])),i=[],n=0;n<a.length&&(0==c._p_data._data.theme_collect[e][n]&&(c._p_data._data.theme_collect[e][n]=1,i.push({theme:e,skin:n}),t--),!(t<=0));n++);for(n=0;n<t;n++){var o;o=Math.floor(Math.random()*c._p_data._data.theme_collect[e].length),i.push({theme:e,skin:o})}return i},o=d,a.default=o,cc._RF.pop()},{BundleMager:"BundleMager",PlayerDataConfig:"PlayerDataConfig",PlayerDataMager:"PlayerDataMager",Res:"Res",SingleBase:"SingleBase",UI:"UI"}],Res:[function(e,t,a){"use strict";cc._RF.push(t,"17353NIxmhHCKAqf4qMVo28","Res"),Object.defineProperty(a,"__esModule",{value:!0}),a.bundlesName=a.bundlesNameLength=a.Texture=a.Sound=a.Atlas=a.Prefab=void 0,a.Prefab={loading:"component/loading",setting:"layer/common/setting",game_scene:"scene/game_scene",main_scene:"scene/main_scene",give_up_ui:"layer/give_up_ui",skin_ui:"layer/skin_ui",win_ui:"layer/win_ui",get_item_ui:"layer/get_item_ui",unline_tip_ui:"layer/unline_tip_ui",get_star_tip_ui:"layer/get_star_tip_ui"},a.Atlas={},a.Sound={btn_0:"effect/btn_0",fail:"effect/fail"},a.Texture={},a.bundlesNameLength=4,a.bundlesName={sound:"sound",common:"common",res:"res",prefab:"prefab"},cc._RF.pop()},{}],Setting:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u,h;cc._RF.push(t,"42214gg9GVOroqJhQ9BxLnW","Setting"),_=__extends,p=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),s=e("Config"),o=e("PlayerDataMager"),d=e("ViewBase"),r=e("GameScene"),l=(n=cc._decorator).ccclass,c=n.property,_(h=function(){var e;return(e=null!==u&&u.apply(this,arguments)||this).musicSwitchClose=void 0,e.effectSwitchClose=void 0,e.vibrateSwitchClose=void 0,e.touch_number=0,e.zanting=!1,e},u=d.default),h.prototype.onLoad=function(){this.updateView(),this.scale_tween()},h.prototype.onBtnExit=function(){s.cSound.playEffect(s.cRes.Sound.btn_0),s.cUI.removeLayer(this.node),o._p_data.saveData()},h.prototype.onBtnMusicSwitch=function(){s.cSound.playEffect(s.cRes.Sound.btn_0),s.cSound.toggleMusic(),this.updateView(),o._p_data._data.musicSwitch=s.cSound.music_switch?1:0},h.prototype.onBtnEffectSwitch=function(){s.cSound.playEffect(s.cRes.Sound.btn_0),s.cSound.toggleEffect(),this.updateView(),o._p_data._data.effectSwitch=s.cSound.effect_switch?1:0,0==o._p_data._data.effectSwitch?cc.audioEngine.setEffectsVolume(0):cc.audioEngine.setEffectsVolume(1)},h.prototype.onBtnVibrateSwitch=function(){s.cSound.playEffect(s.cRes.Sound.btn_0),o._p_data._data.vibrateSwitch=0==o._p_data._data.vibrateSwitch?1:0,this.updateView()},h.prototype.updateView=function(){this.musicSwitchClose.active=!s.cSound.music_switch,this.effectSwitchClose.active=!s.cSound.effect_switch,this.vibrateSwitchClose.active=1!=o._p_data._data.vibrateSwitch},h.prototype.copyOpenId=function(){this.onCopy(o._p_data._data.openId)},h.prototype.onCopy=function(e){console.log("-------------str:",e),this.webCopyString(e)},h.prototype.webCopyString=function(e){var t,a,i,n,o;o=e,(n=document.createElement("textarea")).value=o,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt",(t=getSelection()).rangeCount>0&&(i=t.getRangeAt(0)),document.body.appendChild(n),n.select(),n.selectionStart=0,n.selectionEnd=o.length,a=!1;try{a=document.execCommand("copy")}catch(e){}return document.body.removeChild(n),i&&(t.removeAllRanges(),t.addRange(i)),a},h.prototype.on_give_up=function(){this.btn0(),s.cUI.addLayer(s.cRes.Prefab.give_up_ui),s.cUI.removeLayer(s.cRes.Prefab.setting)},h.prototype.on_again=function(){this.btn0(),r.gameScene.init(),s.cUI.removeLayer(this.node)},h.prototype.on_duihuan=function(){this.btn0(),s.cUI.addLayer(s.cRes.Prefab.duihuan_ui),s.cUI.removeLayer(this.node)},p([c(cc.Node)],h.prototype,"musicSwitchClose",void 0),p([c(cc.Node)],h.prototype,"effectSwitchClose",void 0),p([c(cc.Node)],h.prototype,"vibrateSwitchClose",void 0),i=p([l],h),a.default=i,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],SingleBase:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"747187+MExBEoJ0xS4+BA1G","SingleBase"),Object.defineProperty(a,"__esModule",{value:!0}),(n=function(){}).get=function(){return this._instance||(this._instance=new this),this._instance},n.prototype.timer=function(){return new Promise(function(e,t){e(t)})},i=n,a.default=i,cc._RF.pop()},{}],Sound:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u,h;cc._RF.push(t,"7052dXb+IVIOr/i1QKyYDGo","Sound"),_=__extends,r=__decorate,c=__awaiter,o=__generator,Object.defineProperty(a,"__esModule",{value:!0}),n=e("SingleBase"),i=e("PublicMager"),d=e("UI"),s=(l=cc._decorator).ccclass,l.property,_(h=function(){var e;return(e=null!==u&&u.apply(this,arguments)||this).music_switch=!0,e.effect_switch=!0,e.music_volume=1,e.effect_volume=1,e.effect_list=new Map,e.effect_cd_list=new Map,e.audio_id=0,e._isPause=!1,e},u=n.default),h.prototype.toggleMusic=function(){this.music_switch=!this.music_switch,this.music_switch?cc.audioEngine.resumeMusic():cc.audioEngine.pauseMusic()},h.prototype.toggleEffect=function(){this.effect_switch=!this.effect_switch},h.prototype.isPlaying=function(e){return cc.audioEngine.getState(e)===cc.audioEngine.AudioState.PLAYING},h.prototype.playEffect=function(e,t){return void 0===t&&(t=!1),c(this,void 0,void 0,function(){var t,a;return o(this,function(n){switch(n.label){case 0:return!e||!this.effect_switch||this.effect_volume<=0?[2]:this.effect_list.has(e)&&1==this.effect_list.get(e)?[2]:(t=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)];case 1:t=n.sent(),n.label=2;case 2:return a=cc.audioEngine.playEffect(t,!1),this.audio_id=a,this.effect_cd_list.set(e,1),[2]}})})},h.prototype.startCd=function(e){var t;t=this,setTimeout(function(){t.effect_cd_list.set(e,0)},.3)},h.prototype.playLoopEffect=function(e){return c(this,void 0,void 0,function(){var t,a;return o(this,function(n){switch(n.label){case 0:return!e||!this.effect_switch||this.effect_volume<=0?[2]:this.effect_list.has(e)?[2]:(t=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)];case 1:t=n.sent(),n.label=2;case 2:return a=cc.audioEngine.playEffect(t,!0),this.effect_list.set(e,a),[2]}})})},h.prototype.stopLoopEffect=function(e){return c(this,void 0,void 0,function(){var t;return o(this,function(){return this.effect_list.has(e)&&(t=this.effect_list.get(e),this.effect_list.delete(e),cc.audioEngine.stopEffect(t)),[2]})})},h.prototype.stopAllEffect=function(){cc.audioEngine.stopAllEffects()},h.prototype.playMusic=function(e,t){return void 0===t&&(t=this.music_volume),c(this,void 0,void 0,function(){var a;return o(this,function(n){switch(n.label){case 0:return!this.music_switch||e===this.now_music||this.music_volume<=0?(e===this.now_music&&this.resumeMusic(),[2]):(cc.audioEngine.stopMusic(),this.now_music=e,(a=i.default.get().music[e])?[3,2]:[4,d.default.get().loadSound(e)]);case 1:a=n.sent(),n.label=2;case 2:return this.setMusicVolume(t),cc.audioEngine.playMusic(a,!0),[2]}})})},h.prototype.setMusicVolume=function(e){this.music_volume=e,cc.audioEngine.setMusicVolume(e)},h.prototype.setEffectVolume=function(e){this.effect_volume=e,cc.audioEngine.setEffectsVolume(e)},h.prototype.isMusicPlaying=function(){cc.audioEngine.isMusicPlaying()},h.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},h.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},h.prototype.stopMusic=function(){cc.audioEngine.stopMusic(),this.now_music=null},h.prototype.getMusiclength=function(){return Number(cc.audioEngine.getDuration(this.audio_id).toFixed(1))},p=r([s],h),a.default=p,cc._RF.pop()},{PublicMager:"PublicMager",SingleBase:"SingleBase",UI:"UI"}],StorageManager:[function(e,t,a){"use strict";cc._RF.push(t,"c610adah+5A7ZmAIXIC67YF","StorageManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.Storage=void 0,function(e){var t;t=function(e){null!=e?(e=e+"_"+a,console.log("a",e),cc.sys.localStorage.removeItem(e)):console.error("key is null")};var a=102500;e.init=function(){},e.serUser=function(e){a=e},e.set=function(e,i){if(null!=(e=e+"_"+a)){if(null==i)return console.warn("value is null"),void t(e);if("function"!=typeof i){if("object"==typeof i)try{i=JSON.stringify(i)}catch(e){return void console.error("json error str = "+i)}else"number"==typeof i&&(i+="");cc.sys.localStorage.setItem(e,i)}else console.error("the value is function")}else console.error("the key is null")},e.get=function(e,t){if(null!=e){var i;if(e=e+"_"+a,i=cc.sys.localStorage.getItem(e),null==t||"string"==typeof t)return i;if(null===i)return t;if("number"==typeof t)return Number(i)||0;if("boolean"==typeof t)return"true"==i;if("object"==typeof t)try{return JSON.parse(i)}catch(e){return console.error("json error,str="+i),t}return i}console.error("the key is null")},e.remove=t}(a.Storage||(a.Storage={})),cc._RF.pop()},{}],TipItem2:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"1d8f9XfNHpCP6m7L2BSvvCA","TipItem2"),l=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Pool"),o=(c=cc._decorator).ccclass,r=c.property,l(p=function(){var e;return(e=null!==d&&d.apply(this,arguments)||this).icon=null,e.icon_spf=[],e._time=0,e._timeFlag=0,e},d=cc.Component),p.prototype.initText=function(e){var t;t=this,this.icon.spriteFrame=this.icon_spf[e],this.node.y=20,this.node.opacity=255,cc.tween(this.node).delay(2).to(1,{y:250,opacity:0},{easing:"sineIn"}).call(function(){i.default.get().put(t.node)}).start()},n([r({type:cc.Sprite})],p.prototype,"icon",void 0),n([r({type:cc.SpriteFrame})],p.prototype,"icon_spf",void 0),s=n([o],p),a.default=s,cc._RF.pop()},{Pool:"Pool"}],TipItem:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"1c6b2nJmdVA5YoK7mE0j9d5","TipItem"),n=__extends,i=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),r=e("Pool"),c=(s=cc._decorator).ccclass,l=s.property,n(p=function(){var e;return(e=null!==d&&d.apply(this,arguments)||this).label=null,e.widget=null,e.layout=null,e._time=0,e._timeFlag=0,e},d=cc.Component),p.prototype.initText=function(e){var t;t=this,this.label.string=e,this.node.y=20,this.node.opacity=255,this.node.scale=0,cc.tween(this.node).to(.5,{scale:1},{easing:"backOut"}).delay(1).to(.2,{scale:0},{easing:"backIn"}).call(function(){r.default.get().put(t.node)}).start()},p.prototype.update=function(){this.widget.width=this.layout.width,this.layout.height>120?(this.widget.height=this.layout.height,this.layout.getComponent(cc.Layout).type=cc.Layout.Type.VERTICAL):this.widget.height=120},i([l(cc.Label)],p.prototype,"label",void 0),i([l({type:cc.Node})],p.prototype,"widget",void 0),i([l({type:cc.Node})],p.prototype,"layout",void 0),o=i([c],p),a.default=o,cc._RF.pop()},{Pool:"Pool"}],UITools:[function(e,t,a){"use strict";var i,n;cc._RF.push(t,"6c6a06GxR9LaYV1jtdZjLpr","UITools"),Object.defineProperty(a,"__esModule",{value:!0}),a.node=void 0,(n=function(){}).alignFullScreen=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.left=0,a.right=0,a.bottom=0,a.top=0,a.isAlignTop=!0,a.isAlignBottom=!0,a.isAlignLeft=!0,a.isAlignRight=!0},n.alignCenter=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.isAlignHorizontalCenter=!0,a.isAlignVerticalCenter=!0,a.horizontalCenter=0,a.verticalCenter=0},n.alignLeft=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.left=0,a.isAlignLeft=!0},n.alignRight=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.right=0,a.isAlignRight=!0},n.alignTop=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.top=0,a.isAlignTop=!0},n.alignBottom=function(e,t){var a;(a=e.findComponent(cc.Widget)).alignMode=t,a.bottom=0,a.isAlignBottom=!0},n.easingScale=function(e){var t;t=e.scale,e.scale=0,e.stopAllActions(),cc.tween(e).to(.1,{scale:t+.15}).to(.2,{scale:t}).start()},n.easingFall=function(e){var t;t=e.y,e.y=cc.winSize.height,e.x=0,e.stopAllActions(),cc.tween(e).by(.3,{position:cc.v2(0,-cc.winSize.height-20+t)},{easing:cc.Tween.expoOut}).by(.2,{position:cc.v2(0,20)}).start()},n.easingFade=function(e){e.opacity=0,e.stopAllActions(),cc.tween(e).to(.1,{opacity:150},{easing:cc.Tween.sineIn}).to(.1,{opacity:255},{easing:cc.Tween.sineOut}).start()},n.removeAllNode=function(e){for(;e[0];)e[0].destroy(),e.shift()},n.easingRise=function(e){var t;t=e.y,e.y=-cc.winSize.height,e.x=0,e.stopAllActions(),cc.tween(e).by(.3,{position:cc.v2(0,cc.winSize.height+20+t)},{easing:cc.Tween.expoOut}).by(.2,{position:cc.v2(0,-20)}).start()},n.runBreathingAction=function(e){var t;e.stopAllActions(),t=e.scale,cc.tween(e).to(.5,{scale:t+.1}).to(.5,{scale:t}).union().repeatForever().start()},n.runBounceAction=function(e){var t,a;e.stopAllActions(),a=e.scaleX,t=e.scaleY,cc.tween(e).to(.15,{scaleX:.5*a,scaleY:1.2*t},{easing:"bounceInOut"}).to(.15,{scaleX:1.3*a,scaleY:.8*t},{easing:"bounceInOut"}).to(.2,{scaleX:.9*a,scaleY:t},{easing:"smooth"}).delay(.7).union().repeatForever().start()},n.shakeScreen=function(e){e.is_tween||(e.is_tween=!0,cc.tween(e).by(.1,{y:5,x:5}).by(.1,{y:-5,x:-5}).delay(1).call(function(){e.is_tween=!1}).union().start())},n.hurtColor=function(e){cc.tween(e).to(.5,{color:cc.color(255,0,0)}).to(.5,{color:cc.color(255,255,255)}).start()},i=n,a.default=i,a.node=function(){throw new Error("Function not implemented.")},cc._RF.pop()},{}],UI:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"499f991TGBGnYyP9DmkKhza","UI"),o=__extends,i=__awaiter,n=__generator,l=__values,Object.defineProperty(a,"__esModule",{value:!0}),s=e("SingleBase"),r=e("BundleMager"),o(p=function(){var e;return(e=null!==d&&d.apply(this,arguments)||this).layer_list=[],e.is_loading=!1,e.res={},e.tip_bool=!1,e},d=s.default),p.prototype.getCanvas=function(){return cc.find("Canvas")},p.prototype.getCurrentScene=function(){return this.getGameSceneRoot().children[0]},p.prototype.getGameSceneRoot=function(){return cc.find("Canvas/game_scene")},p.prototype.getGameLayerRoot=function(){return cc.find("Canvas/game_layer")},p.prototype.getGameLoadingRoot=function(){return cc.find("Canvas/game_loading")},p.prototype.getPrevSceneUrl=function(){return this.prev_scene_url},p.prototype.hasLayerItem=function(){return this.layer_list.length>0},p.prototype.showTips=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=2),i(this,void 0,void 0,function(){var a,i,o,c;return i=this,n(this,function(n){switch(n.label){case 0:return e?1==this.tip_bool?[2]:(this.tip_bool=!0,setTimeout(function(){i.tip_bool=!1},2e3),o=(a=cc).instantiate,[4,r.default.get().get_bundle_prefab("prefab","component/tipItem")]):[2];case 1:return(c=o.apply(a,[n.sent()])).parent=cc.find("Canvas"),c.getComponent("TipItem").initText(e,t),[2]}})})},p.prototype.showTips2=function(e){this.createNode("component/tipItem2").then(function(t){t.parent=cc.find("Canvas"),t.getComponent("TipItem2").initText(e)})},p.prototype.hideAllTips=function(){},p.prototype.getPrefab=function(e){return i(this,void 0,Promise,function(){return n(this,function(){return[2,new Promise(function(t){cc.resources.load(e,cc.Prefab,function(a,i){a?console.error(e+" not exist"):t(i)})})]})})},p.prototype.getPrefabSync=function(e){var t;if(t=cc.resources.get(e,cc.Prefab))return t},p.prototype.getAtlas=function(e){return new Promise(function(t){cc.resources.load(e,cc.SpriteAtlas,function(a,i){a?console.error(e+" not exist"):t(i)})})},p.prototype.getAtlasSync=function(e){var t;if(t=cc.resources.get(e,cc.SpriteAtlas))return t;console.error(e+"load failed")},p.prototype.getTextureSync=function(e){var t;if(t=cc.resources.get(e,cc.SpriteFrame))return t;console.error(e+"load failed")},p.prototype.addTexture=function(e){cc.resources.load(e,cc.SpriteFrame)},p.prototype.getTexture=function(e){return new Promise(function(t){cc.resources.load(e,cc.SpriteFrame,function(a,i){a?console.error(e+" not exist"):t(i)})})},p.prototype.createNodeSync=function(e){var t;if(t=this.getPrefabSync(e))return cc.instantiate(t);console.error(e+"load failed")},p.prototype.createNode=function(e){return i(this,void 0,Promise,function(){return n(this,function(){return[2,new Promise(function(t){cc.resources.load(e,cc.Prefab,function(a,i){var n;a?console.error(e+" not exist"):((n=cc.instantiate(i)).name=i.name,n.url_name=e,n.show(),t(n))})})]})})},p.prototype.addLayer=function(e,t){return void 0===t&&(t=!0),i(this,void 0,Promise,function(){var a,i,o,c,s,d,p,_;return i=this,n(this,function(n){switch(n.label){case 0:try{for(p=l(this.layer_list),_=p.next();!_.done;_=p.next())if(_.value.url===e)return[2]}catch(u){o={error:u}}finally{try{_&&!_.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}return t&&this.is_loading?[2]:(this.is_loading=!0,a=(d=cc).instantiate,[4,r.default.get().get_bundle_prefab("prefab",e)]);case 1:return(c=a.apply(d,[n.sent()])).parent=this.getGameLayerRoot(),c.url_name=e,this.layer_list.push(c),setTimeout(function(){i.is_loading=!1},100),[2,c]}})})},p.prototype.add_layer_bundle=function(e,t,a){return void 0===a&&(a=!0),i(this,void 0,Promise,function(){var o,c,s,d,p,_,u,h;return _=this,n(this,function(f){switch(f.label){case 0:try{for(u=l(this.layer_list),c=u.next();!c.done;c=u.next())if((s=c.value).url===t)return[2]}catch(e){h={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(h)throw h.error}}return a&&this.is_loading?[2]:(this.is_loading=!0,r.default.get().find_bundle(e)?[3,2]:[4,r.default.get().loadBundle(e,function(){return i(_,void 0,void 0,function(){var a,i,o,c;return a=this,n(this,function(n){switch(n.label){case 0:return o=(i=cc).instantiate,[4,r.default.get().get_bundle_prefab(e,"prefab/"+t)];case 1:return(c=o.apply(i,[n.sent()])).parent=this.getGameLayerRoot(),c.url_name=t,this.layer_list.push(c),setTimeout(function(){a.is_loading=!1},100),[2,c]}})})})]);case 1:return f.sent(),[3,4];case 2:return p=(d=cc).instantiate,[4,r.default.get().get_bundle_prefab(e,"prefab/"+t)];case 3:return(s=p.apply(d,[f.sent()])).parent=this.getGameLayerRoot(),s.url_name=t,this.layer_list.push(s),setTimeout(function(){_.is_loading=!1},100),[2,s];case 4:return[2]}})})},p.prototype.removeLayer=function(e){for(var t=0;t<this.layer_list.length;t++){var a;if((a=this.layer_list[t]).url_name===e||a===e){a.destroy(),this.layer_list.splice(t,1);break}}},p.prototype.removeAllLayer=function(){this.layer_list.forEach(function(e){return e.destroy()}),this.layer_list=[]},p.prototype.loadScene=function(e){return i(this,void 0,Promise,function(){var t,a;return a=this,n(this,function(){return(t=this.getGameLoadingRoot().$("loading")).show(),t.$("percent").setLabel("0%"),[2,new Promise(function(i){var n,o,c;a.res[e]?(o=[5,18,25,29,40,45,60,80,90,100,100],n=0,c=setInterval(function(){n++,t.$("percent").setLabel(o[n]+"%"),n>10&&(clearInterval(c),t.hide(),a.addScene(e),i(!0))},50)):a.loadResDir("./atlas",t.$("percent")).then(function(){a.res[e]=!0,t.hide(),a.addScene(e),i(!0)})})]})})},p.prototype.reloadScene=function(e){this.removeScene(e),this.addScene(e)},p.prototype.removeScene=function(e){this.scene&&this.scene.url_name===e&&(this.scene.destroy(),this.scene=null)},p.prototype.addScene=function(e){return i(this,void 0,Promise,function(){var t,a,i,o;return o=this,n(this,function(n){switch(n.label){case 0:return this.scene&&this.scene.url_name===e?[2]:this.is_loading?[2]:(this.is_loading=!0,a=(t=cc).instantiate,[4,r.default.get().get_bundle_prefab("prefab",e)]);case 1:return(i=a.apply(t,[n.sent()])).parent=this.getGameSceneRoot(),this.scene&&(this.prev_scene_url=this.scene.url_name,this.scene.destroy(),this.scene=null),this.scene=i,setTimeout(function(){o.is_loading=!1},100),[2,i]}})})},p.prototype.loadResDir=function(e,t){return console.time(e),new Promise(function(a){var i;i=0,cc.resources.loadDir(e,function(e,a){var n;(n=(e/a).toFixed(2).toNumber())>i&&(i=n,t instanceof cc.ProgressBar?t.progress=n:t instanceof cc.Node&&t.setLabel((100*n).toFixed(0)+"%"))},function(t,i){t||0===i.length?console.error(e+" not exist"):a(i),console.timeEnd(e)})})},p.prototype.loadResArray=function(e,t){return console.time(e.toString()),new Promise(function(a){var i;i=0,cc.resources.load(e,function(e,a){var n;(n=(e/a).toFixed(2).toNumber())>i&&(i=n,t instanceof cc.ProgressBar?t.progress=n:t.setLabel((100*n).toFixed(0)+"%"))},function(){a(!0),console.timeEnd(e.toString())})})},p.prototype.loadRes=function(e,t){return new Promise(function(a){cc.resources.load(e,t,function(t,i){t?console.error(e+" not exist"):a(i)})})},p.prototype.loadSound=function(e){return new Promise(function(t){cc.assetManager.getBundle("sound").load(e,cc.AudioClip,function(a,i){a?console.error(e+" not exist"):t(i)})})},p.prototype.loadScene_bundle=function(e,t,a,i){var n;n=this,void 0===i&&(i=!1),t||(t=e),r.default.get().loadBundle(e,function(){r.default.get().get_bundle_prefab(e,t).then(function(e){var i,o;n.scene&&(n.prev_scene_url=n.scene.url_name),o=cc.instantiate(e),n.scene=o,n.scene.url_name=t,(i=n.getGameSceneRoot()).destroyAllChildren(),o.parent=i,a&&a(o)})},i)},p.prototype.getSkeleton=function(e){return new Promise(function(t){cc.resources.load(e,sp.SkeletonData,function(a,i){a?console.error(e+" not exist"):t(i)})})},p.prototype.play_sp_animation=function(e,t,a,i,n){void 0===a&&(a=!0),e.clearTracks(),e.setToSetupPose(),e.timeScale=1,e.setAnimation(0,t,a),a||(n&&e.setEventListener(function(){n()}),e.setTrackCompleteListener(e.getCurrent(0),function(){i&&i()}))},c=p,a.default=c,cc._RF.pop()},{BundleMager:"BundleMager",SingleBase:"SingleBase"}],Utils:[function(e,t,a){"use strict";var i,n,o;cc._RF.push(t,"f6011eAZjBE87YxjlyTuaC7","Utils"),i=__read,Object.defineProperty(a,"__esModule",{value:!0}),(o=function(){}).parseUrl=function(){var e,t,a;if(e={},null==window.location)return e;for(var i=window.location.href,n=i.indexOf("?"),o=(i=i.substr(n+1)).split("&"),c=0;c<o.length;c++)(n=o[c].indexOf("="))>0&&(t=o[c].substring(0,n),a=o[c].substr(n+1),e[t]=a);return e},o.strToBuffer=function(e){var t;t=function(e){var t,a,i,n;return a=e.toString(2),e<128?e.toString(16):e<2048?(a=("00000000000000000"+a).slice(-11),i=parseInt("110"+a.substring(0,5),2),n=parseInt("10"+a.substring(5),2),i.toString(16)+","+n.toString(16)):(a=("00000000000000000"+a).slice(-16),i=parseInt("1110"+a.substring(0,4),2),n=parseInt("10"+a.substring(4,10),2),t=parseInt("10"+a.substring(10),2),i.toString(16)+","+n.toString(16)+","+t.toString(16))};for(var a="",i=0;i<e.length;i++)a+=","+t(e.charCodeAt(i));return a+=",00",new Uint8Array(a.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)})).buffer},o.code2utf8=function(e){var t,a,i,n;return t=e.toString(2),e<128?e.toString(16):e<2048?(t=("00000000000000000"+t).slice(-11),n=parseInt("110"+t.substring(0,5),2),i=parseInt("10"+t.substring(5),2),n.toString(16)+","+i.toString(16)):(t=("00000000000000000"+t).slice(-16),n=parseInt("1110"+t.substring(0,4),2),i=parseInt("10"+t.substring(4,10),2),a=parseInt("10"+t.substring(10),2),n.toString(16)+","+i.toString(16)+","+a.toString(16))},o.numberFormat=function(e,t){var a;return(a=e.toString().length-t)<0?[].init(-a,0).join("")+e:e.toString()},o.removeFrontNum0=function(e){return e.replace(/\b(0+)/gi,"")},o.getRepeatCount=function(e,t){var a,i;for(var n in a={},e.forEach(function(e){a[e]?a[e]++:a[e]=1}),i=[],a)a[n]>=t&&i.push(+n);return i},o.regUserName=function(e,t){void 0===t&&(t=7);for(var a=/^[\u4e00-\u9fa5]$|^[\dA-Za-z]$/,i=e.split(""),n=3*t,o=0;o<i.length;o++){if(!a.test(i[o]))return!1;if((n-=3===this.getUtf8Length(i[o])?3:1.5)<0)return!1}return!0},o.getShuffle=function(e){for(var t,a=0;a<e.length;a++){var n;n=Math.floor(Math.random()*e.length),t=i([e[a],e[n]],2),e[n]=t[0],e[a]=t[1]}return e},o.getNumToArray=function(e){return e[Math.floor(Math.random()*e.length)]},o.getNumMinToMax=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},o.getRandomDir=function(){return Math.random()>.5?1:-1},o.weightsRadom=function(e){var t;t=0,e.forEach(function(e){t+=e});for(var a=Math.random()*t,i=0,n=0;n<e.length;n++)if(a<(i+=e[n]))return n},o.getProbability=function(e,t){void 0===t&&(t=2);for(var a=+Math.random().toFixed(t),i=0,n=0;n<e.length;n++)if((i+=e[n])>=a)return n},o.getDate=function(e){var t,a,i,n,o,c;return t=(c=new Date(e)).getFullYear(),o=c.getMonth()+1,n=c.getDate(),a=c.getHours(),i=c.getMinutes(),c.getSeconds(),t+"/"+this.numberFormat(o,2)+"/"+this.numberFormat(n,2)+" "+this.numberFormat(a,2)+":"+this.numberFormat(i,2)},o.getShowDate=function(e){var t,a,i,n,c;return a=new Date(e),t=o.numberFormat(a.getHours(),2),i=o.numberFormat(a.getMinutes(),2),c=o.numberFormat(a.getMonth()+1,2),n=o.numberFormat(a.getDate(),2),Date.now()-e<864e5?"Today "+t+":"+i:Date.now()-e<1728e5?"Yesterday "+t+":"+i:Date.now()-e<2592e5?"Three days "+t+":"+i:c+"-"+n+" "+t+":"+i},o.getTimeRange=function(e,t){var a;return a=new Date(t-e),o.numberFormat(a.getMinutes(),2)+":"+o.numberFormat(a.getSeconds(),2)},o.formatMinSeconds=function(e){var t,a;return t=Math.floor(e/60),a=Math.floor(e%60),o.numberFormat(t,2)+":"+o.numberFormat(a,2)},o.getNum=function(e){return+e.replace(/[^\d]/gi,"")},o.getArrToNum=function(e,t){var a,i,n,o;for(a=[],o=Math.sign(e),e=Math.abs(e);t>1;)n=e/t*2,i=(i=Math.random()*n)<1?1:i,i=Math.round(i),a.push(i*o),t--,e-=i;return a.push(Math.round(e)*o),a},o.getRandomNumToStr=function(e){var t,a,i,n,c;return n=e.indexOf("["),a=e.indexOf("]"),n<0||a<0?{n:0,str:e}:(i=(t=e.slice(n+1,a)).split("-").map(function(e){return+e}),{n:c=o.getNumMinToMax(i[0],i[1]),str:e.replace(t,c.toString())})},o.getDisTwoPos=function(e,t){var a,i;return i=e.x-t.x,a=e.y-t.y,Math.sqrt(i*i+a*a)},o.getDateSeconds=function(e){return void 0===e&&(e=1),(new Date).getTime()%e},o.judgeTwoPosInDis=function(e,t,a){return this.getDisTwoPos(e,t)<=Math.pow(a,2)},o.number_conversion=function(e,t){var a,i,n,o,c,s,r,l;if(void 0===t&&(t=!1),l=["","k","m","b","t"],c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],i=(s=Math.floor(e)+"").length,r=Math.floor((i-1)/3),s.indexOf("e+")>-1&&(r=Number(s.split("+")[1]),r=Math.floor(r/3)),o="",r<l.length)o=l[r];else if(r<c.length+l.length)o=c[r-5];else{var d,p;r-=5,p=Math.floor(r/c.length),o=d=c[r%=c.length];for(var _=0;_<p;_++)o+=d}if(n="",(a=e)>=1e3){for(;a>=1e6;)a/=1e3;n=Math.floor(a/10)/100+o}else n=t?Math.floor(100*a)/100+o:Math.round(a)+o;return n},o.getRandomArrayElements=function(e,t){for(var a,i,n=e.slice(0),o=e.length,c=o-t;o-- >c;)a=n[i=Math.floor((o+1)*Math.random())],n[i]=n[o],n[o]=a;return n.slice(c)},o.getAngle=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},o.angle_to_radian=function(e){return Math.PI/180*e},o.angle_to_vector=function(e){var t,a,i;return a=this.angle_to_radian(e),i=Math.cos(a),t=Math.sin(a),new cc.Vec2(i,t).normalize()},o.radian_to_angle=function(e){return 180/Math.PI*e},o.vector_to_angle=function(e){var t;return t=e.signAngle(new cc.Vec2(1,0)),-this.radian_to_angle(t)},o.time_stamp_to_time=function(e){var t;return{year:(t=new Date(e)).getFullYear(),month:t.getMonth()+1,date:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}},o.getUtf8Length=function(e){for(var t=0,a=0;a<e.length;a++){var i;(i=e.charCodeAt(a))<127?t++:128<=i&&i<=2047?t+=2:2048<=i&&i<=65535&&(t+=3)}return t},n=o,a.default=n,cc._RF.pop()},{}],ViewBase:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u,h,f,g;cc._RF.push(t,"392f2NnVKpMmqRDZqreFKQK","ViewBase"),i=__extends,l=__decorate,_=__awaiter,u=__generator,Object.defineProperty(a,"__esModule",{value:!0}),f=e("UITools"),h=e("Config"),(g=s||(s={}))[g.on=0]="on",g[g.off=1]="off",function(e){e[e.none=0]="none",e[e.center=1]="center",e[e.full=2]="full",e[e.left=3]="left",e[e.right=4]="right",e[e.top=5]="top",e[e.bottom=6]="bottom"}(o||(o={})),function(e){e[e.none=0]="none",e[e.easingScale=1]="easingScale",e[e.easingFade=2]="easingFade",e[e.easingFall=3]="easingFall",e[e.easingRise=4]="easingRise",e[e.random=5]="random"}(d||(d={})),p=cc._decorator,c=p.ccclass,r=p.property,n=function(e){var t;return i(t=function(){var t;return(t=null!==e&&e.apply(this,arguments)||this).blockInputEvent=s.off,t.alignMode=o.none,t.showMode=d.none,t},e),t.prototype.onEnable=function(){},t.prototype.onDisable=function(){},t.prototype.onDestroy=function(){},t.prototype.initEvents=function(){},t.prototype.onConnectSuccess=function(){},t.prototype.close=function(){},t.prototype.loadConfig=function(){this.addBlockInput(),this.addAlignMode(),this.addShowMode()},t.prototype.addBlockInput=function(){this.blockInputEvent===s.on&&this.node.findComponent(cc.BlockInputEvents)},t.prototype.addAlignMode=function(){var e;switch(e=cc.Widget.AlignMode.ON_WINDOW_RESIZE,this.alignMode){case o.none:break;case o.center:f.default.alignCenter(this.node,e);break;case o.full:f.default.alignFullScreen(this.node,e);break;case o.left:f.default.alignLeft(this.node,e);break;case o.right:f.default.alignRight(this.node,e);break;case o.top:f.default.alignTop(this.node,e);break;case o.bottom:f.default.alignBottom(this.node,e)}},t.prototype.addShowMode=function(){var e;if(e=this.node.$("bg")||this.node.$("_bg"))switch(this.showMode){case d.none:case d.random:break;case d.easingFade:f.default.easingFade(e);break;case d.easingFall:f.default.easingFall(e);break;case d.easingRise:f.default.easingRise(e);break;case d.easingScale:f.default.easingScale(e)}},t.prototype.timer=function(e){return _(this,void 0,Promise,function(){var t;return t=this,u(this,function(){return[2,new Promise(function(a){t.scheduleOnce(function(){a(!0)},e)})]})})},t.prototype.btn0=function(){h.cSound.playEffect(h.cRes.Sound.btn_0)},t.prototype.scale_tween=function(e,t){e||(e=this.node.getChildByName("node")),e&&(e.scale=0,cc.tween(e).to(.5,{scale:1},{easing:"backOut"}).call(function(){t&&t()}).start())},l([r({type:cc.Enum(s)})],t.prototype,"blockInputEvent",void 0),l([r({type:cc.Enum(o)})],t.prototype,"alignMode",void 0),l([r({type:cc.Enum(d)})],t.prototype,"showMode",void 0),l([c],t)}(cc.Component),a.default=n,cc._RF.pop()},{Config:"Config",UITools:"UITools"}],ViewSet:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_;cc._RF.push(t,"46875iEMQtJx67TH80EDx9I","ViewSet"),i=__extends,Object.defineProperty(a,"__esModule",{value:!0}),a.MainSceneView=a.GameSceneView=a.PauseView=a.NoticeView=a.TipsItemView=a.LoadingView=void 0,s=e("ViewBase"),p=s.default,i(_=function(){return null!==p&&p.apply(this,arguments)||this},p),_.prototype.__preload=function(){this.loadConfig()},c=_,a.LoadingView=c,l=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._content=this.node.$("tips_bg/_content"),this._bgNode=this.node.$("_bgNode")},t}(s.default),a.TipsItemView=l,r=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._bg=this.node.$("_bg"),this._btn_close=this.node.$("_bg/_btn_close"),this._btn_close.click(this.onBtnClose.bind(this))},t}(s.default),a.NoticeView=r,o=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._btn_continue=this.node.$("bg/_btn_continue"),this._btn_continue.click(this.onBtnContinue.bind(this)),this._btn_exit=this.node.$("bg/_btn_exit"),this._btn_exit.click(this.onBtnExit.bind(this))},t}(s.default),a.PauseView=o,d=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig()},t}(s.default),a.GameSceneView=d,n=function(e){var t;return i(t=function(){return null!==e&&e.apply(this,arguments)||this},e),t.prototype.__preload=function(){this.loadConfig(),this._btn_start_game=this.node.$("_btn_start_game")},t}(s.default),a.MainSceneView=n,cc._RF.pop()},{ViewBase:"ViewBase"}],bao_zhu:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_;cc._RF.push(t,"06214nFTwNLmpKsKwiRMN4R","bao_zhu"),d=__extends,s=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),r=e("Config"),o=e("GameScene"),l=(n=cc._decorator).ccclass,i=n.property,d(_=function(){var e;return(e=null!==p&&p.apply(this,arguments)||this).spine=null,e._fa_she_ing=!1,e.gaibian=!1,e.target=null,e._oldPos=cc.v2(),e},p=cc.Component),_.prototype.start=function(){},_.prototype.init=function(){this.node.getChildByName("tui_dong").active=!1,this._fa_she_ing=!1,this.node.scale=1,this.node.position=cc.v2(0,0),r.cUI.play_sp_animation(this.spine,"idle",!0)},_.prototype.fa_she=function(e,t,a){var i,n,o;n=this,this.target=a,this.node.getChildByName("tui_dong").active=!0,this._fa_she_ing=!0,this.node.scale=.3,r.cUI.play_sp_animation(this.spine,"yan_hua",!0),(i=(i=this.node.position.add(e)).mul(.5)).x<e.x?i.x-=400:i.x+=400,i.y<e.y?i.y-=200:i.y+=200,o=.5*Math.random(),cc.tween(this.node).bezierTo(.7+o,this.node.position,i,e).call(function(){n.node.getChildByName("tui_dong").active=!1,n.node.angle=0,r.cNodePool.put(n.node),t&&t()}).start()},_.prototype.update=function(){var e;if(this._fa_she_ing&&(e=180*Math.atan2(this.node.y-this._oldPos.y,this.node.x-this._oldPos.x)/Math.PI,this.node.angle=e-90,this._oldPos=this.node.position,0==this.gaibian&&1==this.target.on_bool)){this.gaibian=!0;for(var t=o.gameScene.lie_can_move([this.target]),a=0;a<t.length;a++)t[a].on_bool=!1}},s([i(sp.Skeleton)],_.prototype,"spine",void 0),c=s([l],_),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene"}],bing_bao:[function(e,t,a){"use strict";var i,n,o,c,s,r,l;cc._RF.push(t,"e96bbf9bYhGQIKFMxHw51lQ","bing_bao"),o=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=(i=cc._decorator).ccclass,i.property,o(l=function(){return null!==r&&r.apply(this,arguments)||this},r=cc.Component),l.prototype.init=function(e){var t,a,i,n;switch(a=this,(i=this.node.getComponent(sp.Skeleton)).clearTracks(),i.setToSetupPose(),t="A_",e){case-6:case-5:case-4:t+=3;break;case-8:t+=4}i.setSkin(t),n=i.setAnimation(0,"bao",!1),i.setTrackCompleteListener(n,function(){a.node.destroy()})},s=c([n],l),a.default=s,cc._RF.pop()},{}],block_item_copy:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_;cc._RF.push(t,"382c86RMSRCMZG5DFvg2Sx1","block_item_copy"),n=__extends,r=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Config"),c=e("PlayerDataMager"),d=(l=cc._decorator).ccclass,o=l.property,n(_=function(){var e;return(e=null!==p&&p.apply(this,arguments)||this).block=null,e.icon=null,e.zhezhao=null,e.theme=-1,e.type=-1,e},p=cc.Component),_.prototype.init=function(e,t){this.theme=e,this.type=t,this.init_view()},_.prototype.init_view=function(){this.show_icon(),0==c._p_data._data.theme_collect[this.theme][this.type]?this.zhezhao.active=!0:this.zhezhao.active=!1},_.prototype.show_icon=function(){var e,t,a,n;n=this,a=i.cPublicMager.image[this.theme+"-"+(this.type+1)],this.icon.spriteFrame=a,e=(t=this.theme).toString(),t<10&&(e="0"+t),this.block.getComponent(cc.Sprite).spriteFrame=i.cPublicMager.image[e],this.zhezhao.getComponent(cc.Sprite).spriteFrame=i.cPublicMager.image[e],a||(cc.assetManager.getBundle("level_"+this.theme)||i.cPublicMager.load_level_bundle(this.theme),this.scheduleOnce(function(){n.show_icon()},.5))},r([o({type:cc.Node})],_.prototype,"block",void 0),r([o({type:cc.Sprite})],_.prototype,"icon",void 0),r([o({type:cc.Node})],_.prototype,"zhezhao",void 0),s=r([d],_),a.default=s,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager"}],block_item:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u,h;cc._RF.push(t,"4f9110GJlZJdqrAUZZyswxF","block_item"),l=__extends,s=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),d=e("Config"),_=e("PlayerDataMager"),i=e("GameScene"),n=e("bing_bao"),r=(o=cc._decorator).ccclass,c=o.property,l(h=function(){var e;return(e=null!==u&&u.apply(this,arguments)||this).id=null,e.id2=null,e.block=null,e.img_id=null,e.select_node=null,e.tip_node=null,e.icon=null,e.icon_spine=null,e.cover_node=null,e.cover_sp=null,e.lock=null,e.bing_bao=null,e.data=null,e.callback=null,e.yun=null,e.moving=!1,e.move_id=-1,e},u=cc.Component),h.prototype.init=function(e,t){this.id&&(this.id.string=e.tag.toString()),this.id2&&(this.id2.string=e.tag.toString()),this.data=e,this.callback=t,this.init_view(),this.new_yun()},h.prototype.new_yun=function(){var e,t,a,n;1==this.data.is_yun&&(this.yun=new cc.Node("yun"),this.yun.parent=i.gameScene.line_parent,n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=this.yun.parent.convertToNodeSpaceAR(n),this.yun.x=t.x,this.yun.y=t.y+4,this.yun.scale=.4,e=this.yun.addComponent(cc.Sprite),a="block_-11-"+(Math.floor(3*Math.random())+1),e.spriteFrame=d.cPublicMager.image[a],this.yun.scale=0)},h.prototype.delect_yun=function(){var e;this.yun&&(e=this.yun.getPosition(),d.cBunbleMager.get_bundle_SkeletonData("common","cloud/yun").then(function(t){var a,n,o;(n=new cc.Node("san")).parent=i.gameScene.line_parent,n.setPosition(e),n.scale=.5,(a=n.addComponent(sp.Skeleton)).skeletonData=t,a.premultipliedAlpha=!1,o=a.addAnimation(0,"bao",!1),a.setTrackCompleteListener(o,function(){n.destroy()})}),this.yun.destroy(),this.yun=null),this.data.is_yun=!1},h.prototype.init_view=function(){var e,t,a,n,o,c,s,r,l;if(c=this,n=(r=_._p_data._data.theme).toString(),r<10&&(n="0"+r),e=d.cPublicMager.image[n],this.block.active=!0,this.icon_spine.active=!1,t="s"+n+"-2",a=d.cPublicMager.image[t],this.select_node.getComponent(cc.Sprite).spriteFrame=a,o="s"+n+"-1",s=d.cPublicMager.image[o],this.tip_node.getComponent(cc.Sprite).spriteFrame=s,1==this.data.is_tengman?this.lock.active=!0:this.lock.active=!1,this.data.id>=0)this.block.scale=1,this.block.active=!0,this.block.getComponent(cc.Sprite).spriteFrame=e,l=d.cPublicMager.image[_._p_data._data.theme+"-"+(this.data.id+1)],this.icon.spriteFrame=l,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1,l||this.scheduleOnce(function(){c.init_view()},.1);else if(-2==this.data.id)this.block.active=!0,e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.cover_node.active=!1;else if(-3==this.data.id){var p;this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!1,this.cover_node.active=!0,this.cover_sp.node.active=!1,p=d.cPublicMager.image[n+"_1"],this.cover_node.getComponent(cc.Sprite).spriteFrame=p}else if(-1==this.data.id)this.block.active=!1,this.icon.node.active=!0,this.cover_node.active=!1;else if(-5==this.data.id||-4==this.data.id||-6==this.data.id)e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1;else if(-7==this.data.id)e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!1,this.cover_node.active=!1;else if(-9==this.data.id)this.block.getComponent(cc.Sprite).spriteFrame=e,this.block.active=!0,this.icon.node.active=!0,this.cover_node.active=!1,this.icon_spine.active=!0,d.cBunbleMager.get_bundle_SkeletonData("common","boom/bao_zhu").then(function(e){var t;(t=c.icon_spine.getComponent(sp.Skeleton)).skeletonData=e,t.addAnimation(0,"idle",!0)});else if(-10==this.data.id){var u,h,f;e=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=e,f=this.node.convertToWorldSpaceAR(cc.v2(0,0)),h=i.gameScene.line_parent.convertToNodeSpaceAR(f),(u=new cc.Node).parent=i.gameScene.line_parent,u.setPosition(h)}},h.prototype.move_fun=function(e,t){var a;if(a=this,1!=this.moving){var n,o,c,s,r,l,p,u,h;if(this.moving=!0,c=(o=_._p_data._data.theme).toString(),o<10&&(c="0"+o),r=d.cPublicMager.image[c],this.data.id>=0?this.block.getComponent(cc.Sprite).spriteFrame=r:-9!=this.data.id&&(r=d.cPublicMager.image["block_"+this.data.id],this.block.getComponent(cc.Sprite).spriteFrame=r),1==this.data.is_tengman?this.lock.active=!0:this.lock.active=!1,this.data.id>=0)this.icon.spriteFrame=d.cPublicMager.image[_._p_data._data.theme+"-"+(e.id+1)];else if(-9==this.data.id){var f;f=d.cPublicMager.image["block_"+this.data.id],this.icon.spriteFrame=f}else-7==this.data.id&&(this.icon.spriteFrame=null);e.target.init_view(),s=e.target.block_node.convertToWorldSpaceAR(cc.v2(0,0)),l=this.node.convertToNodeSpaceAR(s),this.block.active=!0,this.block.scale=1,this.block.angle=0,this.block.setPosition(l),this.cover_node.scale=1,this.cover_node.angle=0,this.cover_node.setPosition(l),-3==e.id&&(h=(u=_._p_data._data.theme).toString(),u<10&&(h="0"+u),this.block.active=!1,this.cover_node.active=!0,this.cover_sp.node.active=!1,p=d.cPublicMager.image[h+"_1"],this.cover_node.getComponent(cc.Sprite).spriteFrame=p),this.unschedule(this.no_move_yincang),n=.2,e.num>2&&(n=.1*e.num),n>.5&&(n=.5),cc.Tween.stopAllByTarget(this.block),cc.tween(this.block).to(n,{x:0,y:0}).call(function(){a.move_id=-1,1==e.bool&&d.cSound.playEffect(i.gameScene.move_end_effect),a.moving=!1,t(e),a.init_view()}).start(),cc.Tween.stopAllByTarget(this.cover_node),cc.tween(this.cover_node).to(.2,{x:0,y:0}).start()}},h.prototype.no_move_yincang=function(){this.block.scale=0},h.prototype.on=function(){this.callback&&this.callback(this.data)},h.prototype.switchSkin=function(){var e=_._p_data._data.theme,t=e.toString();e<10&&(t="0"+e);var a=d.cPublicMager.image[t];this.block.getComponent(cc.Sprite).spriteFrame=a,j=d.cPublicMager.image[_._p_data._data.theme+"-"+(this.data.id+1)],this.icon.spriteFrame=j},h.prototype.show_select=function(){var e;this.select_node.active=!0,e=this.icon.node,cc.Tween.stopAllByTarget(e),e.scale=.3,cc.tween(e).by(.1,{scale:.05}).by(.1,{scale:-.05}).start()},h.prototype.hide_select=function(){this.select_node.active=!1},h.prototype.show_tip=function(){this.tip_node.active=!0,cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.scale=.3,this.icon.node.angle=0,cc.tween(this.icon.node).to(.5,{scale:.33}).to(.5,{scale:.3}).union().repeatForever().start()},h.prototype.hide_tip=function(){this.tip_node.active=!1,cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.scale=.33,this.icon.node.angle=0},h.prototype.show_zidong_tip=function(){cc.Tween.stopAllByTarget(this.icon.node),this.icon.node.angle=0,cc.tween(this.icon.node).to(0,{scale:.35}).to(.05,{angle:-10}).to(.1,{angle:10}).to(.1,{angle:-10}).to(.1,{angle:10}).to(.05,{angle:0}).to(0,{scale:.3}).delay(1.5).union().repeatForever().start()},h.prototype.init_icon_to_action=function(){var e,t;e=this,t=this.icon.node,cc.tween(t).to(.2,{scale:0},{easing:"backIn"}).call(function(){e.init_view()}).delay(.2).to(.2,{scale:.3},{easing:"backOut"}).start()},h.prototype.show_chuchang=function(e){var t;void 0===e&&(e=.1),this.node.scale=1,(t=this.icon.node).scale=0,cc.tween(t).to(e,{scale:.3},{easing:"backOut"}).start(),this.yun&&cc.tween(this.yun).to(e,{scale:.4},{easing:"backOut"}).start()},h.prototype.show_delete=function(e,t,a){var i;i=this,void 0===e&&(e=!1),void 0===t&&(t=.2),void 0===a&&(a=.2),1!=this.moving&&this.scheduleOnce(function(){1!=i.moving&&cc.tween(i.block).to(a,{scale:0}).call(function(){var t,a,n;n=(t=_._p_data._data.theme).toString(),t<10&&(n="0"+t),a=d.cPublicMager.image[n],i.data.id>=0?i.block.getComponent(cc.Sprite).spriteFrame=a:-7==i.data.id&&(a=d.cPublicMager.image["block_"+i.data.id],i.block.getComponent(cc.Sprite).spriteFrame=a),-2==i.data.id&&(i.block.scale=1,i.block.active=!0,i.select_node.active=!1,i.icon.node.active=!1),1==e&&(i.init_view(),i.block.scale=1)}).start()},t)},h.prototype.show_doudong=function(){1!=this.moving&&(cc.Tween.stopAllByTarget(this.block),this.block.angle=0,this.block.scale=1,cc.tween(this.block).to(.02,{angle:20}).to(.02,{angle:-15}).to(.08,{angle:10}).to(.1,{angle:-5}).to(.1,{angle:0}).start())},h.prototype.show_fanmian=function(){for(var e=this,t=2,a=function(a){i.scheduleOnce(function(){if(3==a)if(-1!=e.move_id){var i=d.cPublicMager.image[_._p_data._data.theme+"-"+(e.move_id+1)];e.icon.spriteFrame=i,e.cover_sp.spriteFrame=i,e.cover_node.active=!1,e.block.active=!0}else e.init_view();else{var n=_._p_data._data.theme,o=n.toString();n<10&&(o="0"+n);var c=d.cPublicMager.image[o+"_"+t];e.cover_node.getComponent(cc.Sprite).spriteFrame=c,t++,2==a&&(e.cover_sp.node.active=!0),i=d.cPublicMager.image[_._p_data._data.theme+"-"+(e.data.id+1)],-1!=e.move_id&&(i=d.cPublicMager.image[_._p_data._data.theme+"-"+(e.move_id+1)]),e.cover_sp.spriteFrame=i}},.07*a)},i=this,n=0;n<4;n++)a(n)},h.prototype.un_lock=function(){var e;e=this,this.data.is_tengman=!1,this.scheduleOnce(function(){var t,a,o;t=e.block.convertToWorldSpaceAR(cc.v2(0,0)),a=i.gameScene.node.convertToNodeSpaceAR(t),(o=cc.instantiate(e.bing_bao)).parent=i.gameScene.node,o.setPosition(a),o.getComponent(n.default).init(-8)},.35),this.scheduleOnce(function(){e.lock.active=!1},.35)},s([c({type:cc.Label})],h.prototype,"id",void 0),s([c({type:cc.Label})],h.prototype,"id2",void 0),s([c({type:cc.Node})],h.prototype,"block",void 0),s([c({type:cc.Label})],h.prototype,"img_id",void 0),s([c({type:cc.Node})],h.prototype,"select_node",void 0),s([c({type:cc.Node})],h.prototype,"tip_node",void 0),s([c({type:cc.Sprite})],h.prototype,"icon",void 0),s([c({type:cc.Node})],h.prototype,"icon_spine",void 0),s([c({type:cc.Node})],h.prototype,"cover_node",void 0),s([c({type:cc.Sprite})],h.prototype,"cover_sp",void 0),s([c({type:cc.Node})],h.prototype,"lock",void 0),s([c({type:cc.Prefab})],h.prototype,"bing_bao",void 0),p=s([r],h),a.default=p,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",bing_bao:"bing_bao"}],combo_item:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"50c11hhwb1CkKbJnE23Bh95","combo_item"),i=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass,s=r.property,i(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).lianji_spf=[],e},l=cc.Component),d.prototype.init=function(e){var t,a;console.log("combo",e),t=this,(a=(e-3)%this.lianji_spf.length)>=this.lianji_spf.length&&(a=this.lianji_spf.length-1),this.node.getComponent(cc.Sprite).spriteFrame=this.lianji_spf[a],Math.random(),this.node.angle=-15,cc.tween(this.node).by(.5,{y:30,opacity:-255}).call(function(){t.node.destroy()}).start()},o([s({type:cc.SpriteFrame})],d.prototype,"lianji_spf",void 0),c=o([n],d),a.default=c,cc._RF.pop()},{}],delect_effect:[function(e,t,a){"use strict";var i,n,o,c,s,r,l;cc._RF.push(t,"8c8adxlqv9FOJzjHbku7unD","delect_effect"),s=__extends,o=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass,c.property,s(l=function(){return null!==r&&r.apply(this,arguments)||this},r=cc.Component),l.prototype.start=function(){var e,t,a;t=this,(e=this.node.getComponent(sp.Skeleton))&&(e.clearTracks(),e.setToSetupPose(),a=e.setAnimation(0,"bao",!1),e.setTrackCompleteListener(a,function(){t.node.destroy()}))},i=o([n],l),a.default=i,cc._RF.pop()},{}],get_item_ui:[function(e,t,a){"use strict";var i,n,o,c,s,r;cc._RF.push(t,"216abC/45pMG6eHvbzsOZv8","get_item_ui"),i=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l,d,p=e("Config"),_=e("PlayerDataMager"),u=e("ViewBase"),h=e("GameScene");o=(s=cc._decorator).ccclass,r=s.property,i(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).item_name=null,e.icon=null,e.desc=null,e.item_icon=[],e.huxi=null,e.ad_tu=null,e.ad_share_icon=[],e.type=-1,e.ad=!0,e.fun_=null,e},l=u.default),d.prototype.init=function(e){switch(this.scale_tween(),this.type=e,this.type){case 0:this.item_name.string="Hint",this.desc.string="Get 3 Hints";break;case 1:this.item_name.string="Refresh",this.desc.string="Shuffle All Tiles";break;case 2:this.item_name.string="Clear",this.desc.string="Clear 1 Set of Blocks"}this.icon.spriteFrame=this.item_icon[this.type],cc.tween(this.huxi).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start(),this.fun_=this.fun.bind(this)},d.prototype.on_get=function(){var e,t;this.btn0(),this.type,e=(t=this).type,_._p_data.addItem(e,function(a){0==a?cc.isValid(t)?t.fun_():cc.isValid(h.gameScene)&&(_._p_data._data.item[e]++,0==e&&(_._p_data._data.item[0]+=2),_._p_data.saveData(),h.gameScene.ad_num++,h.gameScene.show_item(-1,e)):p.cUI.showTips("Ad loading failed. Please try again later.")})},d.prototype.fun=function(){_._p_data._data.item[this.type]++,0==this.type&&(_._p_data._data.item[0]+=2),_._p_data.saveData(),cc.isValid(h.gameScene)&&(h.gameScene.ad_num++,h.gameScene.show_item(this.icon.node.parent.y,this.type)),cc.isValid(this.node)&&p.cUI.removeLayer(this.node)},d.prototype.on_back=function(){this.btn0(),p.cUI.removeLayer(this.node)},d.prototype.onDisable=function(){},c([r({type:cc.Label})],d.prototype,"item_name",void 0),c([r({type:cc.Sprite})],d.prototype,"icon",void 0),c([r({type:cc.Label})],d.prototype,"desc",void 0),c([r({type:cc.SpriteFrame})],d.prototype,"item_icon",void 0),c([r({type:cc.Node})],d.prototype,"huxi",void 0),c([r({type:cc.Sprite})],d.prototype,"ad_tu",void 0),c([r({type:cc.SpriteFrame})],d.prototype,"ad_share_icon",void 0),n=c([o],d),a.default=n,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],get_star_tip_ui:[function(e,t,a){"use strict";var i,n,o,c,s;cc._RF.push(t,"8ab14GrXjJCFb9RnxQJDAxC","get_star_tip_ui"),o=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var r,l,d=e("Config"),p=e("ViewBase"),_=e("PlayerDataMager"),u=e("GameScene");c=cc._decorator.ccclass,i=cc._decorator.property,o(l=function(){var e;return(e=null!==r&&r.apply(this,arguments)||this).btn=null,e.get_star_label=null,e.pro_label=null,e},r=p.default),l.prototype.start=function(){var e,t;this.scale_tween(),cc.tween(this.btn).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start();var a=_._p_data._data.level>d.cPublicMager.config.maxLevel?d.cPublicMager.config.maxLevel:_._p_data._data.level,i=d.cPublicMager.config.gold+(a-1)*d.cPublicMager.config.levelGold;this.get_star_label.string="x"+i.toString(),e=((t=u.gameScene.return_jindu()).number/t.max*100).toFixed(),this.pro_label.string=e+"%"},l.prototype.on_game=function(){this.btn0(),d.cUI.removeAllLayer()},l.prototype.on_back=function(){this.btn0(),d.cUI.removeLayer(this.node)},n([i({type:cc.Node})],l.prototype,"btn",void 0),n([i({type:cc.Label})],l.prototype,"get_star_label",void 0),n([i({type:cc.Label})],l.prototype,"pro_label",void 0),s=n([c],l),a.default=s,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],give_up_ui:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u;cc._RF.push(t,"5091duRi3VHOqso1JtlzFx1","give_up_ui"),s=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),i=e("Config"),e("PlayerDataMager"),d=e("ViewBase"),p=e("GameScene"),l=(r=cc._decorator).ccclass,o=r.property,s(u=function(){var e;return(e=null!==_&&_.apply(this,arguments)||this).progress_node=null,e},_=d.default),u.prototype.start=function(){var e,t;this.scale_tween(),t=((e=p.gameScene.return_jindu()).number/e.max*100).toFixed(),this.progress_node.string=t+"%"},u.prototype.on_give_up=function(){this.btn0(),i.cUI.addScene(i.cRes.Prefab.main_scene)},u.prototype.on_back=function(){this.btn0(),i.cUI.removeLayer(this.node)},n([o({type:cc.Label})],u.prototype,"progress_node",void 0),c=n([l],u),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],item_icon:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"5647eDAPpVEfYJL8HK4q4eP","item_icon"),i=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),r=(n=cc._decorator).ccclass,o=n.property,i(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).tu=[],e},l=cc.Component),d.prototype.init=function(e){this.node.getComponent(cc.Sprite).spriteFrame=this.tu[e]},c([o({type:cc.SpriteFrame})],d.prototype,"tu",void 0),s=c([r],d),a.default=s,cc._RF.pop()},{}],level:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"bd61aFNNJBOcqb1aUXi8IOq","level"),i=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),r=e("GameScene"),s=(o=cc._decorator).ccclass,o.property,i(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).effect_label_bool=!1,e},l=cc.Component),d.prototype.init=function(){},d.prototype.delect_block=function(){},d.prototype.show_fly_item=function(e,t){r.gameScene.show_fly_item(e,t)},c=n([s],d),a.default=c,cc._RF.pop()},{GameScene:"GameScene"}],line:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d;cc._RF.push(t,"249ddm8rCVEvbLROOhHj85G","line"),s=__extends,n=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),c=(r=cc._decorator).ccclass,o=r.property,s(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).graphics=[],e.yuan=[],e.arr=[],e.time=.5,e.opacity={num:255},e},l=cc.Component),d.prototype.init=function(e){this.arr=e,cc.tween(this.opacity).to(this.time,{num:0},{easing:"quadIn"}).start()},d.prototype.update=function(e){for(var t=0;t<this.graphics.length;t++){this.graphics[t].clear();for(var a=0;a<this.arr.length&&0!=cc.isValid(this.arr[a].block_node);a++){var i,n;i=this.arr[a].block_node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.parent.convertToNodeSpaceAR(i),0==a?this.graphics[t].moveTo(n.x,n.y):this.graphics[t].lineTo(n.x,n.y),this.graphics[t].strokeColor.a=this.opacity.num}this.graphics[t].stroke()}this.time-=e,this.time<0&&this.node.destroy()},n([o({type:cc.Graphics})],d.prototype,"graphics",void 0),n([o({type:cc.Graphics})],d.prototype,"yuan",void 0),i=n([c],d),a.default=i,cc._RF.pop()},{}],skin_item:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p,_,u,h;cc._RF.push(t,"02eee24lA9KWarxauss7CYH","skin_item"),r=__extends,s=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),l=e("Config"),n=e("PlayerDataMager"),c=e("ViewBase"),i=e("block_item_copy"),p=(_=cc._decorator).ccclass,o=_.property,r(h=function(){var e;return(e=null!==u&&u.apply(this,arguments)||this).bg=null,e.bg_spf=[],e.skin_name=null,e.shouji_number=null,e.shouji_label=null,e.shouji_labelOuutline=null,e.lock=null,e.loudou=null,e.block_parent=null,e.block_prefab=null,e.theme=-1,e.callback=null,e.lock_bool=!1,e},u=c.default),h.prototype.init=function(e,t){void 0!==e&&(this.theme=e,this.callback=t),this.show_view(),this.new_block()},h.prototype.show_view=function(){for(var e=!0,t=!1,a=0,i=0;i<n._p_data._data.theme_collect[this.theme].length;i++)0==n._p_data._data.theme_collect[this.theme][i]?(e=!1,this.lock_bool=!0):a++;1==e?n._p_data._data.theme==this.theme&&(t=!0):n._p_data._data.collectting_theme==this.theme&&(t=!0),this.lock.active=!1,this.loudou.active=!1,this.shouji_number.node.parent.active=!1,this.skin_name.string=l.cPublicMager.skin_name[this.theme],1==e?(1==t?(this.bg.spriteFrame=this.bg_spf[1],this.shouji_label.string="In Use",this.shouji_labelOuutline.color=cc.color().fromHEX("822b0d")):(this.bg.spriteFrame=this.bg_spf[0],this.shouji_label.string="Select",this.shouji_labelOuutline.color=cc.color().fromHEX("303331")),this.shouji_number.node.parent.active=!1):(1==t?(this.bg.spriteFrame=this.bg_spf[2],this.shouji_label.string="Collecting",this.shouji_labelOuutline.color=cc.color().fromHEX("0f5c26"),this.loudou.active=!0):(this.bg.spriteFrame=this.bg_spf[3],this.shouji_label.string="Locked",this.shouji_labelOuutline.color=cc.color().fromHEX("2b2b2b"),this.lock.active=!0),this.shouji_number.node.parent.active=!0),this.shouji_number.string=a+"/"+n._p_data._data.theme_collect[this.theme].length,this.load_bundle_data()},h.prototype.load_bundle_data=function(){var e,t;if(e=this,t=cc.assetManager.getBundle("level_"+this.theme))for(var a=t.getDirWithPath("texture"),i=0;i<a.length;i++)for(var n=a[i].path,o=0;o<n.length;o++)n[o];else this.scheduleOnce(function(){e.load_bundle_data()},.5)},h.prototype.new_block=function(){var e;e=this,setTimeout(function(){for(var t=0;t<n._p_data._data.theme_collect[e.theme].length;t++){var a;(a=cc.instantiate(e.block_prefab)).parent=e.block_parent,a.scale=.85,-1!=l.cPublicMager.limit_skin.indexOf(l.cPublicMager.skin_name[e.theme])&&(a.scale=.767),a.zIndex=t,a.getComponent(i.default).init(e.theme,t)}},10)},h.prototype.on=function(){var e;this.btn0(),e=!0,console.log("cur theme",this.theme);for(var t=0;t<n._p_data._data.theme_collect[this.theme].length;t++)if(0==n._p_data._data.theme_collect[this.theme][t]){e=!1;break}console.log("theme is unlock",e),e&&(n._p_data._data.theme=this.theme,n._p_data.saveData(),this.callback&&this.callback())},s([o({type:cc.Sprite})],h.prototype,"bg",void 0),s([o({type:cc.SpriteFrame})],h.prototype,"bg_spf",void 0),s([o({type:cc.Label})],h.prototype,"skin_name",void 0),s([o({type:cc.Label})],h.prototype,"shouji_number",void 0),s([o({type:cc.Label})],h.prototype,"shouji_label",void 0),s([o({type:cc.LabelOutline})],h.prototype,"shouji_labelOuutline",void 0),s([o({type:cc.Node})],h.prototype,"lock",void 0),s([o({type:cc.Node})],h.prototype,"loudou",void 0),s([o({type:cc.Node})],h.prototype,"block_parent",void 0),s([o({type:cc.Prefab})],h.prototype,"block_prefab",void 0),d=s([p],h),a.default=d,cc._RF.pop()},{Config:"Config",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",block_item_copy:"block_item_copy"}],skin_ui:[function(e,t,a){"use strict";var i,n,o,c,s,r;cc._RF.push(t,"7cde77lX6ZKV5bxC6DLMHD+","skin_ui"),s=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l,d,p=e("Config"),_=e("PlayerDataMager"),u=e("ViewBase"),h=e("GameScene"),f=e("skin_item");r=(n=cc._decorator).ccclass,o=n.property,s(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).node1_view=null,e.prefab1=null,e.prefab2=null,e.page_label=null,e.lr_btn=[],e.now_type=0,e.back_fun=null,e.page1=1,e.max_page1=1,e.page1_skin=[],e},l=u.default),d.prototype.start=function(){this.scale_tween(),this.new_item(),this.select_ui(0),this.load_xianding()},d.prototype.load_xianding=function(){for(var e=0,t=0;t<_._p_data._data.theme_collect.length;t++)-1!=p.cPublicMager.limit_skin.indexOf(p.cPublicMager.skin_name[t])&&e<3&&(e++,p.cPublicMager.load_level_bundle(t))},d.prototype.new_item=function(){for(var e=0,t=0;t<p.cPublicMager.skin_name.length;t++)-1==p.cPublicMager.limit_skin.indexOf(p.cPublicMager.skin_name[t])&&(e++,this.page1_skin.push(p.cPublicMager.skin_name[t]));for(this.max_page1=Math.ceil(e/3),t=0;t<this.max_page1;t++)this.node1_view.addPage(cc.instantiate(this.prefab1))},d.prototype.select_ui=function(e){var t;t=0,0==e?(this.node1_view.node.zIndex=1,this.node1_view.node.getChildByName("background").color=cc.color(255,255,255),t=this.page1):(this.node1_view.node.zIndex=0,this.node1_view.node.getChildByName("background").color=cc.color().fromHEX("cbcbcb")),this.now_type=e,this.show_view(t)},d.prototype.onDisable=function(){this.now_type},d.prototype.show_view=function(e){if(0!=cc.isValid(this.node)){var t,a,i,n;if(a=null,n=[],i=0,0==this.now_type&&(a=this.node1_view,n=this.page1_skin,i=this.max_page1),a.setCurrentPageIndex(e-1),(t=a.getPages()[e-1])&&t.children.length<1)for(var o=0;o<3;o++)(c=n[3*(e-1)+o])&&-1!=(s=p.cPublicMager.skin_name.indexOf(c))&&this.new_item2(s,t);for(o=0;o<3;o++){var c,s;(c=n[3*(e-1)+o+3])&&-1!=(s=p.cPublicMager.skin_name.indexOf(c))&&(cc.assetManager.getBundle("level_"+s)||p.cPublicMager.load_level_bundle(s))}for(this.page_label.string=e+"/"+i,o=0;o<this.lr_btn.length;o++)this.lr_btn[o].active=!0;1==e&&(this.lr_btn[0].active=!1),e==i&&(this.lr_btn[1].active=!1)}},d.prototype.new_item2=function(e,t){var a,i;a=this,(i=cc.instantiate(this.prefab2)).parent=t,i.zIndex=e,i.getComponent(f.default).init(e,function(){a.switchSkin()})},d.prototype.switchSkin=function(){for(var e=0;e<this.node1_view.getPages().length;e++)for(var t=this.node1_view.getPages()[e].children,a=0;a<t.length;a++)t[a].getComponent(f.default).show_view();cc.isValid(h.gameScene)&&h.gameScene.switchSkin(),_._p_data.switchTheme(_._p_data._data.theme)},d.prototype.on_select=function(e,t){var a;this.btn0(),a=Number(t),this.select_ui(a)},d.prototype.on_back=function(){this.btn0(),this.back_fun&&this.back_fun(),p.cUI.removeLayer(this.node)},d.prototype.init_skin=function(e){var t;t=0,0==this.now_type&&(this.page1=e.getCurrentPageIndex()+1,t=this.page1),this.show_view(t)},d.prototype.on_left=function(){this.btn0(),0==this.now_type&&(this.page1--,this.show_view(this.page1))},d.prototype.on_right=function(){this.btn0(),0==this.now_type&&(this.page1++,this.show_view(this.page1))},c([o({type:cc.PageView,tooltip:"page1"})],d.prototype,"node1_view",void 0),c([o({type:cc.Prefab,tooltip:"prefab1"})],d.prototype,"prefab1",void 0),c([o({type:cc.Prefab,tooltip:"prefab2"})],d.prototype,"prefab2",void 0),c([o({type:cc.Label,tooltip:"page"})],d.prototype,"page_label",void 0),c([o({type:cc.Node,tooltip:"arrow"})],d.prototype,"lr_btn",void 0),i=c([r],d),a.default=i,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",skin_item:"skin_item"}],star:[function(e,t,a){"use strict";var i,n,o,c,s,r,l,d,p;cc._RF.push(t,"e564avfEIVNB7h605kVYBwo","star"),o=__extends,l=__decorate,Object.defineProperty(a,"__esModule",{value:!0}),n=e("Config"),r=e("GameScene"),s=(i=cc._decorator).ccclass,i.property,o(p=function(){var e;return(e=null!==d&&d.apply(this,arguments)||this).world_pos=null,e},d=cc.Component),p.prototype.init=function(e){var t,a,i,o,c,s;a=this,c=this.node.parent.convertToNodeSpaceAR(e),this.node.setPosition(c),this.node.scale=0,t=r.gameScene.gift_box,r.gameScene.xiao_window&&(t=r.gameScene.level_label.node),i=t.convertToWorldSpaceAR(cc.v2(0,0)),s=this.node.parent.convertToNodeSpaceAR(i),o=c.sub(s).len()/2e3,cc.tween(this.node).to(.2,{scale:1.2}).to(.1,{scale:1}).delay(.3).to(o,{x:s.x,y:s.y}).call(function(){n.cSound.playEffect("effect/progress"),t==r.gameScene.gift_box?(cc.tween(t).to(.04,{scale:.58}).to(.04,{scale:.5}).start(),r.gameScene.show_jindu(),a.node.destroy()):a.node.destroy()}).start()},p.prototype.init2=function(e,t){var a,i;a=this,i=this.node.parent.convertToNodeSpaceAR(e),cc.tween(this.node).to(.2,{x:i.x,y:i.y}).call(function(){t(),a.node.destroy()}).start()},p.prototype.init3=function(e,t){var a;a=this,this.world_pos=e,this.node.scale=0,cc.tween(this.node).to(.2,{scale:1}).delay(.5).call(function(){var e,t,i;i=a.node.parent.convertToNodeSpaceAR(a.world_pos),e=0,t=0,Math.random()<.5?(e=i.x,t=a.node.y):(e=a.node.x,t=i.y),cc.tween(a.node).bezierTo(.5,a.node.getPosition(),cc.v2(e,t),i).start(),cc.tween(a.node).by(.5,{angle:360}).start()}).delay(.51).call(function(){t&&t(),a.node.destroy()}).start()},c=l([s],p),a.default=c,cc._RF.pop()},{Config:"Config",GameScene:"GameScene"}],ts:[function(e,t){"use strict";cc._RF.push(t,"d5559/u4IZAkZhq+SDk5QVb","ts"),cc._RF.pop()},{}],unline_tip_ui:[function(e,t,a){"use strict";var i,n,o,c,s,r;cc._RF.push(t,"9b1c2hBe0NMKbGW7KT8oqWL","unline_tip_ui"),n=__extends,c=__decorate,Object.defineProperty(a,"__esModule",{value:!0});var l,d,p=e("Config"),_=e("PlayerDataMager"),u=e("ViewBase"),h=e("GameScene");o=(i=cc._decorator).ccclass,s=i.property,n(d=function(){var e;return(e=null!==l&&l.apply(this,arguments)||this).progress_node=null,e.huxi=null,e.ad_icon=null,e.ad_share_icon=[],e.ad=!0,e.fun_=null,e},l=u.default),d.prototype.start=function(){var e,t;this.scale_tween(),t=((e=h.gameScene.return_jindu()).number/e.max*100).toFixed(),this.progress_node&&(this.progress_node.string=t+"%"),_._p_data._data.item[1]>0?this.ad_icon.active=!1:this.ad_icon.active=!0,cc.tween(this.huxi).by(1,{scale:.1}).by(1,{scale:-.1}).union().repeatForever().start(),this.fun_=this.fun.bind(this)},d.prototype.on_get=function(){var e;if(this.btn0(),_._p_data._data.item[1]>0)return _._p_data.useItem(1),_._p_data._data.item[1]--,_._p_data.saveData(),h.gameScene.show_item_fun(),h.gameScene.refresh(),void p.cUI.removeLayer(this.node);e=this,_._p_data.refreshItem(function(t){0==t?(playerDataMager._p_data.refreshItem(sign),cc.isValid(e)?e.fun_():cc.isValid(h.gameScene)&&(h.gameScene.ad_num++,h.gameScene.refresh())):p.cUI.showTips("Ad loading failed. Please try again later.")})},d.prototype.fun=function(){cc.isValid(h.gameScene)&&(h.gameScene.ad_num++,h.gameScene.refresh()),this&&cc.isValid(this.node)&&p.cUI.removeLayer(this.node)},d.prototype.on_back=function(){this.btn0(),p.cUI.removeLayer(this.node),cc.Tween.stopAllByTarget(h.gameScene.refresh_btn),h.gameScene.refresh_btn.scale=1,h.gameScene.hide_unline_btn(),cc.tween(h.gameScene.refresh_btn).to(.5,{scale:1.1}).to(.5,{scale:1}).union().repeatForever().start()},d.prototype.onDisable=function(){},c([s({type:cc.Label})],d.prototype,"progress_node",void 0),c([s({type:cc.Node})],d.prototype,"huxi",void 0),c([s({type:cc.Node})],d.prototype,"ad_icon",void 0),c([s({type:cc.SpriteFrame})],d.prototype,"ad_share_icon",void 0),r=c([o],d),a.default=r,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase"}],win_ui:[function(e,t,a){"use strict";cc._RF.push(t,"86a15G6aFRIpa1huR4O9q7f","win_ui");var i=__extends,n=__decorate;Object.defineProperty(a,"__esModule",{value:!0});var o=e("Config"),c=e("PlayerDataMager"),s=e("ViewBase"),r=e("block_item_copy"),l=e("GameScene"),d=e("skin_ui"),p=cc._decorator.ccclass,_=cc._decorator.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mid=null,t.win_title2=null,t.guang=null,t.tu=null,t.btn1=null,t.block_parent=null,t.block_perfab=null,t.progress=null,t.progress_text=null,t.progress_niu=null,t.isGet=null,t.btn=null,t.use_btn=null,t.theme_unlock=null,t.use_btn_spf=null,t.stage1=null,t.stage2=null,t.cur=null,t.btn2=null,t.menu_btn=null,t.theme_name=null,t.zi_2=[],t.huo=null,t.time=null,t.new=null,t.title2=null,t.rank=null,t.caidai=null,t.star_label=null,t.star_percent=null,t.guan=null,t.bg_=null,t.kuang=null,t.kuang_bg=null,t.stage_title=null,t.now_theme=0,t}return i(t,e),t.prototype.start=function(){if(o.cSound.stopMusic(),o.cSound.playEffect("effect/cheer"),o.cSound.playEffect("effect/win"),this.star_label.node.parent.scale=0,cc.isValid(l.gameScene)&&l.gameScene.level_data.star){var e=c._p_data._data.level>o.cPublicMager.config.maxLevel?o.cPublicMager.config.maxLevel:c._p_data._data.level,t=o.cPublicMager.config.gold+(e-1)*o.cPublicMager.config.levelGold;this.star_label.string=t.toString(),this.star_percent.string=l.gameScene.level_data.star.toString(),l.gameScene.level_data.star>1?this.star_percent.node.active=!0:this.star_percent.node.active=!1,c._p_data.saveData()}else this.star_label.node.parent.active=!1;var a=!1,i=0;for(i=0;i<c._p_data._data.theme_collect.length;i++){if(-1==o.cPublicMager.limit_skin.indexOf(o.cPublicMager.skin_name[i]))for(var n=0;n<c._p_data._data.theme_collect[i].length;n++)if(0==c._p_data._data.theme_collect[i][n]){a=!0;break}if(a)break}console.log("hasSkin",a),a?this.stage_1_action():(c._p_data.settle(c._p_data._data.level,0,0),this.stage_2_action())},t.prototype.stage_1_action=function(){var e=this;this.stage1.active=!0,this.stage2.active=!1,this.mid.scale=0,this.btn.scale=0,this.title2.string="Well done!",cc.tween(this.guang).by(3,{angle:360}).repeatForever().start();var t=o.cPublicMager.get_skin();c._p_data._data.theme_collect[t.theme][t.skin]=1,this.tu.getComponent(r.default).init(t.theme,t.skin),c._p_data._data.collectting_theme=t.theme,c._p_data.saveData(),c._p_data.settle(c._p_data._data.level,t.theme,t.skin);for(var a=0,i=0;i<c._p_data._data.theme_collect[t.theme].length;i++)1==c._p_data._data.theme_collect[t.theme][i]&&a++;this.zi_2[0].getComponent(cc.Label).string=a+"/"+c._p_data._data.theme_collect[t.theme].length,this.show_time(),this.win_title2.string=o.cPublicMager.skin_name[t.theme],c._p_data._data.collectting_theme<0?this.show_donghua(t):o.cBunbleMager.find_bundle("level_"+c._p_data._data.collectting_theme)?this.show_donghua(t):o.cPublicMager.load_level_bundle(c._p_data._data.collectting_theme,function(){e.show_donghua(t)})},t.prototype.show_donghua=function(e){var t=this;this.now_theme=e.theme;for(var a=null,i=0,n=0,s=0;s<c._p_data._data.theme_collect[e.theme].length;s++){var l=cc.instantiate(this.block_perfab);l.parent=this.block_parent,l.getComponent(r.default).init(e.theme,s),e.skin==s&&((a=l).opacity=0),i++,1==c._p_data._data.theme_collect[e.theme][s]&&n++}for(this.bg_.spriteFrame=o.cPublicMager.image["m_bg"+this.now_theme],s=0;s<this.zi_2.length;s++)this.zi_2[s].scale=0;this.win_title2.node.parent.scale=0,this.time.node.parent.scale=0,cc.tween(this.win_title2.node.parent).call(function(){cc.tween(t.time.node.parent).to(.5,{scale:1},{easing:"backOut"}).start()}).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(this.mid).to(.5,{scale:1},{easing:"backOut"}).start(),this.progress.node.opacity=0,this.kuang.opacity=0,this.kuang_bg.opacity=0,this.btn1.opacity=0,cc.tween(this.kuang).delay(1.5).call(function(){cc.tween(t.guang).to(.5,{scale:0}).start(),cc.tween(t.btn1).to(.5,{opacity:255}).start(),cc.tween(t.win_title2.node).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.zi_2[0]).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.kuang_bg).to(.5,{opacity:255}).start(),cc.tween(t.progress.node).to(.5,{opacity:255},{easing:"backOut"}).start();var e=(n-1)/i;t.progress.progress=e,0==t.progress.progress&&(t.progress.progress=.01),t.progress_text.string=(100*e).toFixed()+"%"}).to(.5,{opacity:255}).delay(.5).call(function(){var c=a.convertToWorldSpaceAR(cc.v2(0,0)),s=t.mid.parent.convertToNodeSpaceAR(c);t.isGet.active=!1,t.new.active=!1,cc.tween(t.tu).to(.5,{scale:.83}).start(),t.scheduleOnce(function(){o.cSound.playEffect("effect/skin_fly")},.2),cc.tween(t.tu).to(.5,{x:s.x,y:s.y},{easing:"backIn"}).call(function(){a.opacity=255,t.tu.opacity=0,t.scheduleOnce(function(){o.cSound.playEffect("effect/win_jump"),cc.tween(t.progress_niu).by(.15,{y:20}).by(.15,{y:-20}).delay(.1).start()},.1)}).delay(.5).call(function(){o.cSound.playEffect("effect/win_walk");var a=n/i;cc.tween(t.progress).to(.5,{progress:a}).delay(.2).call(function(){cc.tween(t.zi_2[1]).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.btn).to(.5,{scale:1},{easing:"backOut"}).start(),i==n&&(t.theme_unlock.string=o.cPublicMager.skin_name[e.theme]+" Unlock",t.theme_unlock.node.parent.x=-400,cc.tween(t.theme_unlock.node.parent).to(.5,{x:0},{easing:"backOut"}).start(),cc.tween(t.use_btn).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(t.progress_niu).delay(.2).by(.15,{y:20}).by(.15,{y:-20}).union().repeatForever().start(),t.caidai.active=!0,o.cSound.playEffect("effect/fireworks"))}).start(),t.progress_text.string=(100*a).toFixed()+"%"}).start()}).start()},t.prototype.show_time=function(){var e=1111;if(cc.isValid(l.gameScene)&&(e=l.gameScene.jishi_time),e>3600)this.time.string=">1hour";else{var t=e%60,a=Math.floor(e/60),i=t.toString();t<10&&(i="0"+i);var n=a.toString();a<10&&(n="0"+n),this.time.string="Level Timer "+n+":"+i}},t.prototype.get_skin_block=function(){var e=[],t=c._p_data._data.collectting_theme;if(-1!=o.cPublicMager.limit_skin.indexOf(o.cPublicMager.skin_name[t])&&(c._p_data._data.collectting_theme=0,t=c._p_data._data.collectting_theme),-1!=t)for(var a=0;a<c._p_data._data.theme_collect[t].length;a++)0==c._p_data._data.theme_collect[t][a]&&e.push(t+"-"+(a+1));else for(a=0;a<c._p_data._data.theme_collect.length;a++)for(var i=0;i<c._p_data._data.theme_collect[a].length;i++)e.push(a+"-"+(i+1));if(e.length<1){var n=!1;for(a=0;a<c._p_data._data.theme_collect.length;a++){for(i=0;i<c._p_data._data.theme_collect[a].length;i++)-1==o.cPublicMager.limit_skin.indexOf(o.cPublicMager.skin_name[a])&&0==c._p_data._data.theme_collect[a][i]&&(e.push(a+"-"+(i+1)),n=!0,c._p_data._data.collectting_theme=a);if(1==n)break}}if(e.length<1){for(a=0;a<c._p_data._data.theme_collect.length;a++)for(i=0;i<c._p_data._data.theme_collect[a].length;i++)-1==o.cPublicMager.limit_skin.indexOf(o.cPublicMager.skin_name[a])&&e.push(a+"-"+(i+1));c._p_data._data.collectting_theme=-1}if(1==o.cPublicMager.is_zui_niu){var s=[];for(a=0;a<o.cPublicMager.limit_skin.length;a++){var l=o.cPublicMager.skin_name.indexOf(o.cPublicMager.limit_skin[a]);if(-1!=l)for(i=0;i<c._p_data._data.theme_collect[l].length;i++)if(0==c._p_data._data.theme_collect[l][i]){s.push(l);break}}var d=0;s.length>0&&(d=s[Math.floor(Math.random()*s.length)]);var p=o.cPublicMager.skin_name.indexOf(o.cPublicMager.limit_skin[d]);for(a=0;a<c._p_data._data.theme_collect[p].length;a++)0==c._p_data._data.theme_collect[p][a]&&e.push(p+"-"+(a+1));if(e.length<1)for(a=0;a<c._p_data._data.theme_collect[p].length;a++)e.push(p+"-"+(a+1))}var _=e[Math.floor(Math.random()*e.length)].split("-"),u=Number(_[0]),h=Number(_[1]);c._p_data._data.theme_collect[u][h-1]=1;var f=!0;for(a=0;a<c._p_data._data.theme_collect[u].length;a++)0==c._p_data._data.theme_collect[u][a]&&(f=!1);if(1==f)for(c._p_data._data.collectting_theme=-1,a=0;a<c._p_data._data.theme_collect.length;a++){for(i=0;i<c._p_data._data.theme_collect[a].length;i++){var g=o.cPublicMager.limit_skin.indexOf(o.cPublicMager.skin_name[a]);if(0==c._p_data._data.theme_collect[a][i]&&-1==g){c._p_data._data.collectting_theme=a;break}}if(-1!=c._p_data._data.collectting_theme)break}c._p_data.saveData(),this.tu.getComponent(r.default).init(u,h-1);var m=0;for(a=0;a<c._p_data._data.theme_collect[u].length;a++)1==c._p_data._data.theme_collect[u][a]&&m++;return this.theme_name.string=m+"/"+c._p_data._data.theme_collect[u].length,{theme:u,id:h-1}},t.prototype.on_sure=function(){this.btn0(),this.stage_2_action()},t.prototype.getRank=function(e){return{one:Math.floor(2e5+2e5*(1-Math.pow(e,this.rankFactor(2,1e3)))),two:Math.floor(2e5+2e5*(1-Math.pow(e+1,this.rankFactor(2,1e3))))}},t.prototype.rankFactor=function(e,t){return Math.log(e)/Math.log(t)},t.prototype.stage_2_action=function(){var e=this;this.stage1.active=!1,this.stage2.active=!0,this.show_time();var t=this.getRank(c._p_data._data.level),a=t.one,i=t.two;this.cur.string="Rank"+a,this.rank.string="+"+(a-i).toString(),this.stage_title.scale=0,cc.tween(this.stage_title).to(.5,{scale:1},{easing:"backOut"}).start(),this.scheduleOnce(function(){e.cur.node.parent.active=!0,e.cur.node.parent.scale=0,cc.tween(e.cur.node.parent).to(.25,{scale:1},{easing:"backOut"}).start(),cc.tween(e.guan).to(.25,{scale:1},{easing:"backOut"}).start(),e.scheduleOnce(function(){e.scheduleOnce(function(){o.cSound.playEffect("effect/spring")},.3),e.scheduleOnce(function(){cc.tween(e.cur.node.parent).by(.2,{scale:.5},{easing:"quadOut"}).call(function(){e.cur.string="Rank"+i,e.rank.node.active=!0}).by(.2,{scale:-.5},{easing:"quadIn"}).start(),cc.tween(e.guan).by(.2,{scale:.5},{easing:"quadOut"}).by(.2,{scale:-.5},{easing:"quadIn"}).by(.05,{angle:5}).by(.1,{angle:-5}).by(.05,{angle:5}).start(),cc.tween(e.cur.node.parent).by(.05,{angle:5}).by(.1,{angle:-5}).by(.05,{angle:5}).delay(.5).call(function(){e.scale_tween(e.btn2),e.scale_tween(e.menu_btn),e.scale_tween(e.star_label.node.parent)}).start()},.5)},.5)},.5)},t.prototype.on_next=function(){this.btn0(),o.cUI.removeLayer(this.node),l.gameScene.init()},t.prototype.on_change_theme=function(){this.btn0(),o.cUI.addLayer(o.cRes.Prefab.skin_ui).then(function(e){e.getComponent(d.default).back_fun=function(){}})},t.prototype.on_use=function(){this.btn0(),c._p_data._data.theme=this.now_theme,this.use_btn.getComponent(cc.Sprite).spriteFrame=this.use_btn_spf,this.use_btn.getChildByName("text").getComponent(cc.Label).string="In Use"},t.prototype.onDisable=function(){},t.prototype.on_back=function(){this.btn0(),o.cUI.removeLayer(this.node),o.cUI.addScene(o.cRes.Prefab.main_scene)},t.prototype.on_share=function(){this.btn0()},n([_({type:cc.Node})],t.prototype,"mid",void 0),n([_({type:cc.Label})],t.prototype,"win_title2",void 0),n([_({type:cc.Node})],t.prototype,"guang",void 0),n([_({type:cc.Node})],t.prototype,"tu",void 0),n([_({type:cc.Node})],t.prototype,"btn1",void 0),n([_({type:cc.Node})],t.prototype,"block_parent",void 0),n([_({type:cc.Prefab})],t.prototype,"block_perfab",void 0),n([_({type:cc.ProgressBar})],t.prototype,"progress",void 0),n([_({type:cc.Label})],t.prototype,"progress_text",void 0),n([_({type:cc.Node})],t.prototype,"progress_niu",void 0),n([_({type:cc.Node})],t.prototype,"isGet",void 0),n([_({type:cc.Node})],t.prototype,"btn",void 0),n([_({type:cc.Node})],t.prototype,"use_btn",void 0),n([_({type:cc.Label})],t.prototype,"theme_unlock",void 0),n([_({type:cc.SpriteFrame})],t.prototype,"use_btn_spf",void 0),n([_({type:cc.Node})],t.prototype,"stage1",void 0),n([_({type:cc.Node})],t.prototype,"stage2",void 0),n([_({type:cc.Label})],t.prototype,"cur",void 0),n([_({type:cc.Node})],t.prototype,"btn2",void 0),n([_({type:cc.Node})],t.prototype,"menu_btn",void 0),n([_({type:cc.Label})],t.prototype,"theme_name",void 0),n([_({type:cc.Node})],t.prototype,"zi_2",void 0),n([_({type:cc.Node})],t.prototype,"huo",void 0),n([_({type:cc.Label})],t.prototype,"time",void 0),n([_({type:cc.Node})],t.prototype,"new",void 0),n([_({type:cc.Label})],t.prototype,"title2",void 0),n([_({type:cc.Label})],t.prototype,"rank",void 0),n([_({type:cc.Node})],t.prototype,"caidai",void 0),n([_({type:cc.Label})],t.prototype,"star_label",void 0),n([_({type:cc.Label})],t.prototype,"star_percent",void 0),n([_({type:cc.Node})],t.prototype,"guan",void 0),n([_({type:cc.Sprite})],t.prototype,"bg_",void 0),n([_({type:cc.Node})],t.prototype,"kuang",void 0),n([_({type:cc.Node})],t.prototype,"kuang_bg",void 0),n([_({type:cc.Node})],t.prototype,"stage_title",void 0),n([p],t)}(s.default);a.default=u,cc._RF.pop()},{Config:"Config",GameScene:"GameScene",PlayerDataMager:"PlayerDataMager",ViewBase:"ViewBase",block_item_copy:"block_item_copy",skin_ui:"skin_ui"}]},{},["ClientEvent","Config","PlatformApi","PublicMager","Res","BundleMager","HttpRequest","LocalStorage","Pool","SingleBase","Sound","StorageManager","UI","UITools","Utils","ViewBase","ViewSet","PlayerDataConfig","PlayerDataMager","bao_zhu","bing_bao","block_item","block_item_copy","combo_item","delect_effect","level","line","star","Setting","TipItem","TipItem2","get_item_ui","get_star_tip_ui","give_up_ui","item_icon","skin_item","skin_ui","unline_tip_ui","win_ui","GameScene","LoadingResNode","LoadingScene","Main","MainCamera","MainScene","ts"]);